{"version":3,"sources":["webpack:///./packages/annotation-bridge/src/helpers.js","webpack:///./packages/annotation-redux/src/utility.js","webpack:///./packages/annotation-redux/src/query/selectorQuery.js","webpack:///./packages/annotation-redux/src/actions/elucidate.js","webpack:///./packages/annotation-redux/src/query/elucidateQuery.js","webpack:///./packages/annotation-redux/src/actions/manifest.js","webpack:///./packages/annotation-plugin-core/src/core.utils.js","webpack:///./packages/annotation-redux/src/query/manifestQuery.js","webpack:///./packages/annotation-components/src/components/inputs/TextBox.scss?cbd1","webpack:///./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.js","webpack:///./packages/annotation-components/src/components/inputs/ComboButton.js","webpack:///./packages/annotation-plugin-resource-editor/src/resourceEditor.js","webpack:///./packages/annotation-redux/src/actions/logging.js","webpack:///./packages/annotation-redux/src/lib/annotation/Annotation.js","webpack:///./packages/annotation-redux/src/lib/annotation/AnnotationSelector.js","webpack:///./packages/annotation-redux/src/lib/annotation/AnnotationBodyList.js","webpack:///./packages/annotation-redux/src/lib/annotation/AnnotationBody.js","webpack:///./packages/annotation-redux/src/actions/help.js","webpack:///./packages/annotation-plugin-core/src/core.provider.js","webpack:///./packages/annotation-plugin-core/src/core.js","webpack:///./packages/annotation-redux/src/index.js","webpack:///./packages/annotation-components/src/components/ui/HelpTooltip.js","webpack:///./packages/annotation-plugin-viewer/src/viewer.provider.js","webpack:///./packages/annotation-plugin-viewer/src/viewer.js","webpack:///./packages/annotation-redux/src/query/resourceQuery.js","webpack:///./packages/annotation-components/src/components/viewers/Viewer.js","webpack:///./packages/annotation-components/src/components/viewers/ScaledImageViewer.js","webpack:///./packages/annotation-components/src/components/viewers/StaticImageViewer.js","webpack:///./packages/annotation-components/src/components/selectors/Selector.js","webpack:///./packages/annotation-components/src/components/selectors/_selectorPropTypes.js","webpack:///./packages/annotation-components/src/components/inputs/Form.js","webpack:///./packages/annotation-components/src/components/inputs/Autocomplete.js","webpack:///./packages/annotation-plugin-resource-editor/src/index.js","webpack:///./packages/annotation-redux/src/actions/drafts.js","webpack:///./packages/annotation-plugin-resource-editor/src/resourceEditor.provider.js","webpack:///./packages/annotation-plugin-transcriber/src/transcriber.provider.js","webpack:///./packages/annotation-plugin-transcriber/src/transcriber.js","webpack:///./packages/annotation-plugin-drafts/src/drafts.provider.js","webpack:///./packages/annotation-plugin-drafts/src/drafts.js","webpack:///./packages/annotation-plugin-tagging/src/tagging-annotations.component.js","webpack:///./packages/annotation-plugin-tagging/src/tagging-annotations.provider.js","webpack:///./packages/annotation-plugin-tagging/src/tagging.js","webpack:///./packages/annotation-plugin-tagging/src/tagging.provider.js","webpack:///./packages/annotation-application/src/index.js","webpack:///./packages/annotation-bridge/src/index.js","webpack:///./packages/annotation-plugin-core/src/index.js","webpack:///./packages/annotation-redux/src/query/draftQuery.js","webpack:///./packages/annotation-application/src/css/style.scss?9f46","webpack:///./packages/annotation-application/src/css/style.scss","webpack:///./packages/annotation-application/src/css/base.scss?30d9","webpack:///./packages/annotation-application/src/css/base.scss","webpack:///./packages/annotation-application/src/css/grid.scss?a259","webpack:///./packages/annotation-application/src/css/grid.scss","webpack:///./packages/annotation-application/src/css/image-grid.scss?7588","webpack:///./packages/annotation-application/src/css/image-grid.scss","webpack:///./packages/annotation-application/src/css/collection-list.scss?cff0","webpack:///./packages/annotation-application/src/css/collection-list.scss","webpack:///./packages/annotation-application/src/css/collection-item.scss?62c2","webpack:///./packages/annotation-application/src/css/collection-item.scss","webpack:///./packages/annotation-application/src/css/topic-list.scss?d49b","webpack:///./packages/annotation-application/src/css/topic-list.scss","webpack:///./packages/annotation-application/src/css/prev-next.scss?91d4","webpack:///./packages/annotation-application/src/css/prev-next.scss","webpack:///./packages/annotation-application/src/css/pagination.scss?7571","webpack:///./packages/annotation-application/src/css/pagination.scss","webpack:///./packages/annotation-plugin-core/src/core.plugin.js","webpack:///./packages/annotation-redux/src/actions/index.js","webpack:///./packages/annotation-redux/src/lib/elucidate/AnnotationSelector.js","webpack:///./packages/annotation-redux/src/query/index.js","webpack:///./packages/annotation-redux/src/reducers/index.js","webpack:///./packages/annotation-redux/src/reducers/loggingReducer.js","webpack:///./packages/annotation-redux/src/reducers/draftReducer.js","webpack:///./packages/annotation-redux/src/reducers/annotationReducer.js","webpack:///./packages/annotation-redux/src/reducers/selectorReducer.js","webpack:///./packages/annotation-redux/src/reducers/elucidateReducer.js","webpack:///./packages/annotation-redux/src/reducers/manifestReducer.js","webpack:///./packages/annotation-redux/src/reducers/resourceReducer.js","webpack:///./packages/annotation-redux/src/reducers/helpReducer.js","webpack:///./packages/annotation-redux/src/connector.js","webpack:///./packages/annotation-redux/src/createStore.js","webpack:///./packages/annotation-redux/src/middleware.js","webpack:///./packages/annotation-plugin-viewer/src/index.js","webpack:///./packages/annotation-plugin-viewer/src/viewer.plugin.js","webpack:///./packages/annotation-bridge/src/annotationBody.js","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/utility.js","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/viewer.js","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/viewer.scss?4725","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/viewer.scss","webpack:///./packages/annotation-components/src/components/viewers/StaticImageView.scss?da17","webpack:///./packages/annotation-components/src/components/viewers/StaticImageView.scss","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/withCanvas.js","webpack:///./packages/annotation-components/src/components/selectors/BoxSelector.js","webpack:///./packages/annotation-components/src/components/selectors/BoxSelector.scss?15d7","webpack:///./packages/annotation-components/src/components/selectors/BoxSelector.scss","webpack:///./packages/annotation-components/src/components/selectors/PinSelector.js","webpack:///./packages/annotation-components/src/components/selectors/PinSelector.scss?526f","webpack:///./packages/annotation-components/src/components/selectors/PinSelector.scss","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/withDraggable.js","webpack:///./packages/annotation-components/src/patches/react-draggable.js","webpack:///./packages/annotation-components/src/components/viewers/openseadragon/withFixedScale.js","webpack:///./packages/annotation-components/src/components/selectors/WholeCanvasSelector.js","webpack:///./packages/annotation-components/src/components/selectors/WholeCanvasSelector.scss?573a","webpack:///./packages/annotation-components/src/components/selectors/WholeCanvasSelector.scss","webpack:///./packages/annotation-components/src/components/inputs/Form.scss?f061","webpack:///./packages/annotation-components/src/components/inputs/Form.scss","webpack:///./packages/annotation-components/src/components/inputs/FormGroup.js","webpack:///./packages/annotation-components/src/components/inputs/FormField.js","webpack:///./packages/annotation-components/src/components/ui/HelpTooltip.scss?5950","webpack:///./packages/annotation-components/src/components/ui/HelpTooltip.scss","webpack:///./packages/annotation-components/src/components/inputs/Autocomplete.scss?24e0","webpack:///./packages/annotation-components/src/components/inputs/Autocomplete.scss","webpack:///./packages/annotation-components/src/components/inputs/DatePicker.js","webpack:///./packages/annotation-components/src/components/inputs/TextBox.scss","webpack:///./packages/annotation-components/src/components/inputs/DropDown.js","webpack:///./packages/annotation-components/src/components/inputs/DropDown.scss?e4d0","webpack:///./packages/annotation-components/src/components/inputs/DropDown.scss","webpack:///./packages/annotation-components/src/components/inputs/GoogleMapSearch.js","webpack:///./packages/annotation-redux/src/actions/viewer.js","webpack:///./packages/annotation-bridge/src/vocab.js","webpack:///./packages/annotation-redux/src/actions/annotations.js","webpack:///./packages/annotation-redux/src/actions/selectors.js","webpack:///./packages/annotation-components/src/components/inputs/GoogleMapSearch.scss?c535","webpack:///./packages/annotation-components/src/components/inputs/GoogleMapSearch.scss","webpack:///./packages/annotation-components/src/components/inputs/TextArea.js","webpack:///./packages/annotation-components/src/components/inputs/TextBox.js","webpack:///./packages/annotation-components/src/components/inputs/Fallback.js","webpack:///./packages/annotation-redux/src/actions/resources.js","webpack:///./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.scss?73c1","webpack:///./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.scss","webpack:///./packages/annotation-components/src/components/inputs/Fallback.scss?3c18","webpack:///./packages/annotation-components/src/components/inputs/Fallback.scss","webpack:///./packages/annotation-components/src/components/inputs/Hidden.js","webpack:///./packages/annotation-components/src/components/inputs/Hidden.scss?77ec","webpack:///./packages/annotation-components/src/components/inputs/Hidden.scss","webpack:///./packages/annotation-components/src/components/inputs/NullableCaptureModel.js","webpack:///./packages/annotation-components/src/components/domain/validation.js","webpack:///./packages/annotation-redux/src/lib/elucidate/index.js","webpack:///./packages/annotation-components/src/components/composites/Canvas.js","webpack:///./packages/annotation-components/src/components/ui/Toggle.js","webpack:///./packages/annotation-components/src/components/ui/Toggle.scss?8f56","webpack:///./packages/annotation-components/src/components/ui/Toggle.scss","webpack:///./packages/annotation-components/src/components/composites/Canvas.scss?a5dc","webpack:///./packages/annotation-components/src/components/composites/Canvas.scss","webpack:///./packages/annotation-components/src/components/viewers/Region.js","webpack:///./packages/annotation-components/src/components/viewers/Region.scss?f655","webpack:///./packages/annotation-components/src/components/viewers/Region.scss","webpack:///./packages/annotation-components/src/components/composites/ConfirmationForm.js","webpack:///./packages/annotation-components/src/components/inputs/ComboButton.scss?21fb","webpack:///./packages/annotation-components/src/components/inputs/ComboButton.scss","webpack:///./packages/annotation-components/src/components/composites/Router.js","webpack:///./packages/annotation-components/src/components/ui/ActionTimeAgo.js","webpack:///./packages/annotation-plugin-resource-editor/src/resourceEditor.plugin.js","webpack:///./packages/annotation-bridge/src/annotations.js","webpack:///./packages/annotation-bridge/src/model/Choice.js","webpack:///./packages/annotation-bridge/src/model/CaptureModel.js","webpack:///./packages/annotation-bridge/src/model/Field.js","webpack:///./packages/annotation-redux/src/lib/annotation/mapping.js","webpack:///./packages/annotation-plugin-resource-editor/src/views/renderForm.js","webpack:///./packages/annotation-plugin-resource-editor/src/views/FullForm.scss?17dd","webpack:///./packages/annotation-plugin-resource-editor/src/views/FullForm.scss","webpack:///./packages/annotation-plugin-resource-editor/src/resourceEditor.utility.js","webpack:///./packages/annotation-plugin-resource-editor/src/views/confirmationPage.js","webpack:///./packages/annotation-components/src/index.js","webpack:///./packages/annotation-plugin-resource-editor/src/views/button.scss?d9e3","webpack:///./packages/annotation-plugin-resource-editor/src/views/button.scss","webpack:///./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.js","webpack:///./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.scss?9d19","webpack:///./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.scss","webpack:///./packages/annotation-plugin-transcriber/src/index.js","webpack:///./packages/annotation-plugin-transcriber/src/transcriber.plugin.js","webpack:///./packages/annotation-plugin-drafts/src/index.js","webpack:///./packages/annotation-plugin-drafts/src/drafts.plugin.js","webpack:///./packages/annotation-plugin-drafts/src/drafts.scss?13df","webpack:///./packages/annotation-plugin-drafts/src/drafts.scss","webpack:///./packages/annotation-plugin-tagging/src/index.js","webpack:///./packages/annotation-plugin-tagging/src/tagging.utils.js","webpack:///./packages/annotation-plugin-tagging/src/tagging-annotations.plugin.js","webpack:///./packages/annotation-plugin-tagging/src/tagging.plugin.js","webpack:///./packages/annotation-application/src/js/region-annotations.js"],"names":["castBool","str","undefined","toLowerCase","parseSelectorTarget","toParse","scale","W3C_SELECTOR","match","exec","unit","expanded","x","parseFloat","y","width","height","toString","split","caseIdWithContext","value","context","contexts","Object","keys","map","key","id","found","find","v","substr","length","replace","castId","defaultValue","returnValue","get","prop","getMotivationInstance","motive","indexOf","motivationFromForm","motivatedBy","label","instance","labelId","res","prototype","call","String","iteratorGenerator","generator","props","next","warning","component","message","process","env","NODE_ENV","console","warn","SHOW_LOGS","SHOW_WARNINGS","log","args","info","selectorCompat","item","left","defineProperty","top","getCurrentSelector","state","selector","currentSelector","isSelecting","type","currentSelectorIsSecondary","secondary","ELUCIDATE_SET_SERVER","ELUCIDATE_SET_RESOURCE","ELUCIDATE_CREATE_COLLECTION","ELUCIDATE_SET_COLLECTION","ELUCIDATE_SEND_ANNOTATION","ELUCIDATE_ADD_ANNOTATION","initialiseElucidate","elucidateServer","resource","resourceLabel","dispatch","setServer","setResource","createCollection","server","payload","resourceId","getServer","createElucidateCollection","md5","then","collection","setCollection","addElucidateAnnotation","annotation","elucidateSendAnnotation","toJSON","createAnnotation","getCollectionId","postAnnotation","updateAnnotation","annoationId","putAnnotation","sendAnnotation","body","target","motivation","sendAnnotationToServer","elucidate","getAnnotationById","annotations","isSendingAnnotations","pendingAnnotations","getCanvasFromManifest","manifest","canvasId","sequences","canvases","canvas","richAnnotationList","annotationList","AnnotationSelector","parse","elucidateAnnotations","elucidateAnnotationsExist","MANIFEST_ADD","MANIFEST_SELECT","MANIFEST_REMOVE","MANIFEST_REQUEST","MANIFEST_CANVAS_SELECT","requestManifest","url","select","fetch","response","json","addManifest","selectCanvas","selectManifest","removeManifest","getAttributes","$el","attributes","i","prettyName","nodeName","nodeValue","deferred","resolve","promise","Promise","r","unknownPropertyWarning","unknownProps","connectedBehaviour","store","Component","render","attr","substring","g","toUpperCase","renderWhen","shouldRender","root","subscription","subscribe","getState","asyncForEach","iterable","fn","nextIterate","done","catch","e","currentManifest","manifestById","current","getImageServiceFromCanvas","images","service","thumbnail","currentImageService","currentCanvas","list","allManifests","manifestKeys","style","BEM","block","EmbeddedResourceEditor","isLoaded","isLoading","renderCurrentValue","renderResource","renderResourceEditor","captureModel","postSave","onBack","captureModelId","componentDidMount","importCaptureModel","setState","resourceTemplate","metaData","displayFieldSelector","element","title","selectorValue","preventDefault","description","$style","ComboButton","isOpen","isHovered","close","open","children","disabled","options","React","Children","child","modifiers","single","Option","ResourceEditor","annotationCreationUpdateFirstCreateRest","annotationId","first","shift","singleAnnotation","createAnnotationToBeMovedToAnnotationRedux","targetResource","currentResource","asyncPublishDraft","currentDraft","createAnnotationFromCaptureModelAndDraft","fingerprint","identity","Array","isArray","all","result","createAnnotationWithoutTechDebt","goBack","discard","moveBack","tree","discardCurrentDraft","deselectDraft","commitToCurrentDraft","mutateLocalStorage","currentList","template","saveLocally","draft","importDraft","source","originalDraft","changeFingerPrintLifecyle","generateDraftId","changedDraft","changeFingerprintSource","saveAsInProgress","onSaveAsIncomplete","discardDraft","publishDraft","getDraftsByFingerprintIdentity","oldDraft","createInProgressAnnotation","scope","resolveSelector","hasMultipleSelectorsWithPercentages","hasSelectors","selectors","k","reduce","action","withViewer","err","viewer","getImageSize","convertPercentToPixel","draftFieldSelectors","currentResourceTemplate","resourceForm","isConfirmingDraft","treeRoute","enablePublishing","immutableSelector","updateDraft","unpreviewDraft","confirmDraft","previewDraft","createDraft","isSelectingSecondary","editCurrentDraftSelector","editCurrentDraftSecondarySelector","editCurrentDraftFieldSelector","moveForward","reset","hideTitle","draftDefaults","choice","values","matches","confirmationPage","onConfirm","resourceNavigation","showBackButton","isAtRoot","resourceTemplates","rt","resources","getDraftFromCaptureModel","getResourceById","fields","renderForm","onSave","onSaveAsInProgress","editSelector","editFieldSelector","currentTree","elementEvents","onFocus","focused","onBlur","Choose","immediate","ConnectedResourceEditor","connector","ownProps","LOGGING_LOG","Annotation","constructor","fromJsonLD","jsonLd","AnnotationBodyList","fromArray","multipleSelectors","format","language","processingLanguage","textDirection","DIRECTION_AUTO","DIRECTION_LTR","DIRECTION_RTL","Error","parseTarget","fromTarget","annotationSelector","text","_","__","parseInt","isNaN","Math","floor","getOfType","TextualBody","Image","Video","Sound","Text","SpecificResource","Dataset","JSON","j","AnnotationBody","anno","purpose","fromBody","HELP_INFO_ADD","HELP_INFO_REMOVE","HELP_CONTEXT_ADD","HELP_CONTEXT_REMOVE","addInfo","content","removeInfo","setContext","removeContext","CoreProvider","Core","onlineStatus","ONLINE","setOnline","ONLINE_NOTIFICATION","setTimeout","setOffline","OFFLINE","warnUser","event","drafts","changes","filter","lifecycle","savedDraftList","subject","window","addEventListener","navigator","onLine","forEach","changeFingerPrintCreator","isSavedDraft","c","getAllAnnotationsFromCollection","pop","changeFingerprintIdentity","creator","name","renderOffline","renderOnline","display","version","HelpTooltip","ViewerProvider","Viewer","setViewer","MAX_HEIGHT","innerHeight","image","selectedViewer","updateDimensions","editableRegions","dimensions","toggleable","currentDraftSelectors","updateSelector","showControls","VIEWER_WIDTH","regions","immutableRegionsFromAnnotations","resourceTemplateList","region","selectedCanvas","ref","isSecondary","textAlign","src","maxHeight","margin","withState","applyDefaultsToDraft","input","form","getForm","s","f","draftDefaultKeys","filledInputs","conformsTo","getCurrentResource","currentPaths","trees","node","curState","path","error","hasLandedOnForm","currentItem","getCurrentResourceTemplate","getCurrentDraft","meta","getCurrentPath","obj","currentPath","o","compose","branch","renderComponent","withManifest","withCanvas","renderNothing","ScaledImageViewer","getSelectedRegion","selected","createRelativePoint","createViewportPoint","getRef","getRegions","scaled","StaticImageViewer","resolveRegion","editing","onClick","Selector","PropTypes","string","isRequired","func","onCancel","initialPosition","shape","number","Form","renderGroups","groups","groupKeys","FormGroup","DEFAULT_GROUP","field","omekaMetaData","group","push","defaultGroup","AUTOCOMPLETE_DEBOUNCE_DELAY","KEYCODE_ESCAPE","Autocomplete","suggestionListHidden","suggestions","fetchNewSuggestions","debounce","suggestionProvider","handleInputReference","handleCompletionSelection","selection","updateValue","uri","focus","handleKeyUp","evt","keyCode","update","preview","suggestionList","suggestion","currentTarget","DRAFT_CREATE","DRAFT_UPDATE_SELECTOR","DRAFT_REMOVE_SELECTOR","DRAFT_UPDATE_FIELD_SELECTOR","DRAFT_REMOVE_FIELD_SELECTOR","DRAFT_UPDATE_INPUT","DRAFT_SELECT","DRAFT_DESELECT","DRAFT_PUBLISHING","DRAFT_PUBLISHED","DRAFT_PREVIEW","DRAFT_UNPREVIEW","DRAFT_CONFIRM","DRAFT_DISCARD","DRAFT_IMPORT","DRAFT_LIFECYCLE_NEW","DRAFT_LIFECYCLE_CHANGED","DRAFT_LIFECYCLE_READ","uuid","emptyInput","createDirectDraft","selectDraft","chooseDraftSelector","draftId","currentTemplate","chooseSelector","getValidLifecycle","desiredLifecycle","defaultLifecycle","createFingerprint","created","Date","toISOString","cancelSelector","removeSelectorFromDraft","removeSelectorFromCurrentDraft","markDraftAs","whenEqual","changeTo","getDraftById","addSelectorToDraftField","fieldId","data","addSelectorToDraftFieldFromViewer","Canvas","topLeft","bottomRight","removeSelectorFromDraftField","convertSelectorFromCanvas","addSelectorToDraftFromViewer","addSelectorToDraft","addAnnotation","ResourceEditorProvider","TranscriberProvider","Transcriber","createDraftFromCaptureModel","transcriptionVocab","transcriptionLabel","transcription","modifier","DraftsProvider","getImageFromTarget","size","imageService","prefix","Drafts","getUserName","selectScopedDraft","currentDrafts","filterBy","emptyState","hideIfEmpty","showThumbnail","thumbnailSize","draftList","filterByMultiple","filteredDraftLIst","hasThumbnail","forward","TaggingAnnotations","entityTypes","regionAnnotations","concat","wholeCanvasAnnotations","isTaggedAs","sort","a","b","tagDetails","localeCompare","output","slice","prev","prevUri","nextUri","TaggingAnnotationsProvider","Tagging","isAdding","handleAdd","hasDraft","TaggingProvider","whyDidYouUpdate","require","createClass","set","nextCreateClass","behaviours","resolveSharedStore","CorePlugin","TaggingPlugin","whenToRender","utils","document","querySelectorAll","register","attribute","getAttribute","behaviour","mapDraftToDataSet","model","getLabelFromResourceTemplate","labelParts","labelField","dataSetToAnnotation","dataset","stringify","dataSetToSingleAnnotation","Title","Description","getIndividualW3CAnnotationBodies","capModel","keyedSelectors","getW3CAnnotationBody","defaultMotivation","getDraftTemplateFromCaptureModel","getDraftSelectorsFromCaptureModel","constructUnknownTemplate","Choice","is","CaptureModel","importResourceTemplate","importResource","importResourceTree","getTree","flatten","getCurrentDraftId","getCurrentDrafts","getAllDraftsWithSelectors","getDraftsWithSelectors","currentDraftEditableRegions","editableRegionsFromDraftList","mapDraftSelectorToRegion","currentDraftKeys","onClickRegion","currentSelectorExists","keysAsString","immutable","locale","moment","location","href","localstorage","createStore","logging","help","defaultState","messages","loggingReducer","$push","isConfirmed","draftModel","isPublishing","isPreviewing","unstable","draftReducer","$set","$merge","$apply","copy","listUpdate","annotationReducer","available","selectorReducer","defaults","loading","elucidateReducer","assign","n","pending","manifestReducer","captureModelDefaults","resourceReducer","bindCurrentResource","actions","WrappedComponent","connect","currentDraftList","currentDraftId","isSelectingPrimary","draftIsCurrentlySelecting","draftHasSelector","bindActionCreators","commitToCurrentDraftField","chooseSecondarySelector","setAvailableSelectors","withRef","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","createCustomStore","reducers","extraMiddleware","combineReducers","applyMiddleware","logger","__DEV__","ViewerStore","viewerReady","viewerAware","showUntilQueue","showUntil","names","ViewerPlugin","querySelector","tagClassForUri","regex","textualBody","specificResource","getFirstBody","isValidTileSource","tileSource","protocol","profile","getCanonicalImage","resolveRealTileSourceFromCanvas","resolveRealTileSource","createElement","isSelected","container","setAttribute","classList","add","appendChild","BaseComponent","mapProps","regionIds","componentWillMount","zoomIn","viewport","zoomBy","zoomOut","setRef","el","asyncAddTile","success","addTiledImage","viewerElementToImageCoordinates","OpenSeadragon","Point","imageToViewerElementCoordinates","setFallback","onImageLoaded","ajaxWithCredentials","showNavigator","showRotationControl","defaultZoomLevel","maxZoomPixelRatio","navigatorPosition","animationTime","immediateRender","preserveViewport","blendTime","minPixelRatio","visibilityRatio","constrainDuringPan","showSequenceControl","showNavigationControl","showZoomControl","showHomeControl","showFullPageControl","sequenceMode","prefixUrl","goHome","fallback","Infinity","actualHeight","position","styles","pointerEvents","overflow","transform","transformOrigin","bindEvents","addHandler","resize","firstImage","world","getItemAt","imgWidth","imgHeight","imgAspectRatio","boundsRect","getBounds","viewportOrigin","viewportWidth","viewportHeight","viewportZoom","getZoom","zoom","viewportToImageZoom","rotation","getRotation","clientWidth","clientHeight","getPosition","canvasScale","transformOut","transformIn","defaultX","defaultY","onChange","onUpdate","onCommit","right","bottom","cloneElement","BoxSelector","updateHeightWidth","rnd","resizable","save","getInitialPosition","color","$pin","PinSelector","withDraggable","withFixedScale","onDrag","deltaX","deltaY","onStop","drag","zIndex","webpackUniversalModuleDefinition","factory","module","exports","define","amd","__WEBPACK_EXTERNAL_MODULE_2__","__WEBPACK_EXTERNAL_MODULE_3__","modules","installedModules","__webpack_require__","moduleId","loaded","m","p","default","DraggableCore","_extends","arguments","hasOwnProperty","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","Symbol","iterator","_s","TypeError","_createClass","defineProperties","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","_react2","_interopRequireDefault","_reactDom","_reactDom2","_classnames","_classnames2","_domFns","_positionFns","_shims","_DraggableCore","_DraggableCore2","_log","_log2","__esModule","_defineProperty","_classCallCheck","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","Draggable","_React$Component","_this","getPrototypeOf","onDragStart","coreData","shouldStart","onStart","createDraggableData","dragging","dragged","uiData","newState","bounds","_x","_y","slackX","slackY","_getBoundPosition","getBoundPosition","_getBoundPosition2","shouldUpdate","onDragStop","shouldStop","controlled","Boolean","_this$props$position","_x2","_y2","defaultPosition","isElementSVG","SVGElement","findDOMNode","componentWillReceiveProps","nextProps","componentWillUnmount","_classNames","svgTransform","draggable","transformOpts","canDragX","canDragY","createSVGTransform","createCSSTransform","_props","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","className","only","displayName","propTypes","axis","oneOf","oneOfType","dontSetMe","defaultProps","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","hasOwn","classNames","classes","arg","argType","apply","join","matchesSelector","matchesSelectorAndParentsTo","addEvent","removeEvent","outerHeight","outerWidth","innerWidth","offsetXYFromParent","getTouch","getTouchIdentifier","addUserSelectStyles","removeUserSelectStyles","styleHacks","_getPrefix","_getPrefix2","matchesSelectorFunc","findInArray","method","isFunction","baseNode","parentNode","handler","attachEvent","detachEvent","removeEventListener","computedStyle","ownerDocument","defaultView","getComputedStyle","int","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","paddingTop","paddingBottom","paddingLeft","paddingRight","offsetParent","isBody","offsetParentRect","getBoundingClientRect","clientX","scrollLeft","clientY","scrollTop","_ref","browserPrefixToKey","_ref3","identifier","targetTouches","t","changedTouches","userSelectPrefix","getPrefix","userSelect","browserPrefixToStyle","userSelectStyle","userSelectReplaceRegExp","RegExp","childStyle","touchAction","isNum","array","callback","num","propName","componentName","prefixes","documentElement","kebabToTitleCase","out","shouldCapitalize","snapToGrid","getControlPosition","createCoreData","cloneBounds","ownerWindow","boundNode","nodeStyle","boundNodeStyle","offsetLeft","marginLeft","offsetTop","marginTop","min","max","grid","pendingX","pendingY","round","touchIdentifier","draggableCore","touchObj","isStart","lastX","lastY","eventsFor","touch","start","move","stop","mouse","dragEventFor","_temp","_ret","_len","_key","NaN","handleDragStart","onMouseDown","allowAnyClick","button","domNode","Node","handle","cancel","coreEvent","enableUserSelectHack","handleDrag","handleDragStop","_snapToGrid","_snapToGrid2","MouseEvent","createEvent","initMouseEvent","_ReactDOM$findDOMNode","onMouseUp","onTouchStart","onTouchEnd","_ReactDOM$findDOMNode2","bool","browser","nodeType","arrayOf","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","nextTick","Item","argv","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","cwd","chdir","dir","umask","_console","WholeCanvasSelector","skipConfirm","toggle","groupKey","groupClass","groupKeyClass","FormField","validate","updateField","allProps","validation","VALIDATION_MAP","bind","inputType","annotationMetaData","autocomplete","encodeURIComponent","completions","isOption","option","opts","DatePicker","isStarted","onAddDate","handleChange","time","isValid","printf","val","DropDown","selectSuggestion","updateSuggestions","renderBox","GoogleMapDraggablePin","withGoogleMap","onMapLoad","dragEnd","GoogleMapSearch","currentLocation","handleSuggestSelect","lat","lng","valueAsString","background","latLng","VIEWER_MUTATION","VIEWER_ACCESS","ID","CONTEXT","TYPE","VALUE","DESCRIPTION","TITLE","CONFORMS_TO","FORM_FIELDS","HAS_PART","RDFS_LABEL","OMEKA_LABEL","COMBINE","FIELD_GROUP","LABEL_PARTS","UI_GROUP","EXTERNALISE","HUMAN_READABLE","MOTIVATED_BY","SERIALIZE","MULTIPLE","UI_CHOICE","SELECTOR","SELECTOR_VALUE","BODY_TYPE","PURPOSE","INPUT_TYPE","INPUT_OPTIONS","INPUT_DEFAULT_VALUE","BOX_SELECTOR","WHOLE_CANVAS_SELECTOR","ANNOTATIONS_ADD","SELECTOR_SET_AVAILABLE","SELECTOR_CHOOSE","SELECTOR_UPDATE","SELECTOR_COMMIT_TO_DRAFT","SELECTOR_COMMIT_TO_DRAFT_FIELD","SELECTOR_CANCEL","maxX","maxY","fromViewer","isViewer","TextArea","TextBox","shouldComponentUpdate","newProps","events","Fallback","previousValue","creatingNew","fallbackValue","handleNotFound","portal","openPortal","handleBack","prom","setPortal","IMPORT_RESOURCE_TREE","IMPORT_RESOURCE_CHOICE","IMPORT_RESOURCE_FIELD","IMPORT_UNKNOWN_RESOURCE","IMPORT_CAPTURE_MODEL","RESOURCE_NAV_FORWARD","RESOURCE_NAV_BACK","RESOURCE_NAV_RESET","importResourceWithPercentage","importChoice","importField","parentId","fixedResource","Hidden","NullableCaptureModel","isChecked","isSaved","onReceiveEmbeddedItem","getCaptureModel","checkbox","currentPage","items","fetchPageCollection","JSON_LD_HEADERS","Accept","makeRequest","headers","credentials","redirect","status","statusText","post","getAnnotation","collectionResource","firstPage","Slug","$canvas","mapRegion","index","regionType","regionWidth","onEditRegion","displayWidth","onUpdateSelector","onSaveSelector","resolveViewer","showAnnotations","renderCurrentSelector","relativeTo","CANVAS_RELATIVE","isInitial","nextState","getScale","showAnnotationToggle","regionRender","reverse","currentSelectorPropsViewport","currentSelectorPropsCanvas","toggleAnnotations","VIEWPORT_RELATIVE","Toggle","isActive","nativeEvent","Region","renderRegionBox","canChange","getElementById","isChanging","pixelScale","onEdit","posX","posY","baseStyle","ConfirmationForm","renderPublishButton","enableLocalStorageSaving","bem","nextLabel","editLabel","saveLabel","saveAsInProgressLabel","draftIsEmpty","nextButtonProps","last","Router","routes","renderNotFound","route","fontWeight","ActionTimeAgo","verb","showComma","fromNow","ResourceEditorPlugin","serializationStrategy","enablePublishingBoolean","mapTarget","boxSelector","resourceTemplateReverseTypeLookup","mapAnnotationBody","bodyFields","fieldMap","createDraftListFromAnnotations","createDraftFromAnnotation","immutableRegionsFromDraftList","currentDraftKey","detectTypeOfAnnotation","getAnnotationBody","mapTargetToSelector","published","$","firstChild","firstChildIsField","isValidTarget","combine","externalise","humanReadable","serialize","multiple","fromData","choices","asArray","Field","dereferenceFields","getReference","parent","getAutocompleteEndpoint","inheritedContext","bodyType","FIELD_TYPES_THAT_ARE_ENTITIES","FIELD_TYPES_THAT_ARE_HUMAN_READABLE","createCombinedAnnotationBody","mapFieldsToDataSet","getModelFields","ids","fieldIds","createExternalResourceAnnotationBody","draftInput","createHumanReadableAnnotationBody","createSerializedAnnotationBody","dataSet","createMultipleAnnotations","fieldKeys","captureModelField","omekaMeta","getGenerator","getLabelFromDraft","getSuitableLabelFromBody","bodies","getMotivation","customDraftSelector","draftSelector","serializedBody","isWholeCanvas","getTargetFromRegion","$confirmationPage","$button","$resourceNavigation","handleItemClick","TranscriberPlugin","innerText","DraftsPlugin","ReactDOM","annotationToTag","bodyDetails","details","fragment","types","some","entityType","TaggingAnnotationsPlugin","RegionAnnotations"],"mappings":"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","file":"index.bundle.js","sourcesContent":["import { ID, OMEKA_LABEL } from './vocab';\n\n// HELPER\nexport function castBool(str) {\n  if (str === undefined) {\n    return false;\n  }\n  if (str === true) return true;\n  if (str === false) return false;\n  if (typeof str !== 'string') {\n    return false;\n  }\n  return str.toLowerCase() === 'true';\n}\n\nexport function parseSelectorTarget(toParse, scale = 1) {\n  if (!toParse) {\n    return toParse;\n  }\n  const W3C_SELECTOR = /[#&?](xywh=)?(pixel:|percent:)?([0-9]+(\\.[0-9]+)?),([0-9]+(\\.[0-9]+)?),([0-9]+(\\.[0-9]+)?),([0-9]+(\\.[0-9]+)?)/;\n  const match = W3C_SELECTOR.exec(toParse);\n\n  if (match) {\n    return {\n      unit: (match[2] === 'percent:' ? 'percent' : 'pixel'),\n      scale,\n      expanded: true,\n      x: parseFloat(match[3]) * scale,\n      y: parseFloat(match[5]) * scale,\n      width: parseFloat(match[7]) * scale,\n      height: parseFloat(match[9]) * scale,\n      toString() {\n        // @todo maybe something else?\n        return toParse.split('#')[0];\n      },\n    };\n  }\n  return toParse;\n}\n\nexport function caseIdWithContext(value, context) {\n  const contexts = Object.keys(context).map(key => {\n    return { key, id: (context[key] && context[key][ID]) ? context[key][ID] : null };\n  });\n\n  const found = contexts.find(v => {\n    if (!v.id) {\n      return false;\n    }\n    return value.substr(0, v.id.length) === v.id;\n  })\n  if (!found) {\n    return value.replace('#', ':');\n  }\n  return `${found.key}:${value.substr(found.id.length+1)}`;\n}\n\nexport function castId(value, defaultValue, context) {\n  const returnValue = ((value[ID] ? value[ID] : value) || defaultValue) || '';\n  return context ? caseIdWithContext(returnValue, context) : returnValue;\n}\n\nexport function get(value, context) {\n  return (prop, defaultValue) => value ? value[prop] : defaultValue;\n}\n\nexport function getMotivationInstance(str) {\n  const motive = str.toLowerCase();\n  // Remove the open annotation prefix.\n  if (motive.indexOf('oa:') === 0) {\n    return getMotivationInstance(motive.substr(3));\n  }\n  if (motive.indexOf('o:') === 0) {\n    return getMotivationInstance(motive.substr(2));\n  }\n  if ([\n      'assessing',\n      'bookmarking',\n      'classifying',\n      'commenting',\n      'describing',\n      'editing',\n      'highlighting',\n      'identifying',\n      'linking',\n      'moderating',\n      'questioning',\n      'replying',\n      'tagging',\n    ].indexOf(motive) !== -1) {\n    return motive;\n  }\n\n  // This is the default to fallback to.\n  return 'tagging';\n}\n\nexport function motivationFromForm(motivatedBy) {\n  if (!motivatedBy) {\n    return null;\n  }\n  if (!motivatedBy.id) {\n    return null;\n  }\n  return {\n    id: motivatedBy.id,\n    label: motivatedBy.label ? motivatedBy.label : motivatedBy.id,\n    instance: getMotivationInstance(motivatedBy.id),\n  };\n}\n\nexport function labelId(res, defaultValue) {\n  if (!res) {\n    return defaultValue ? defaultValue : {\n      id: null,\n      label: 'unknown',\n    };\n  }\n  if (Object.prototype.toString.call(res) === '[object Array]') {\n    return res.map(labelId);\n  } else if (typeof res === 'string' || res instanceof String) {\n    return {\n      id: res,\n      label: res\n    };\n  }\n\n  return {\n    id: res[ID],\n    label: res[OMEKA_LABEL],\n  };\n}\n\nexport function iteratorGenerator(generator) {\n  const instance = generator();\n  return (...props) => {\n    return instance.next(props).value;\n  };\n}\n\nexport function warning(component, id, message) {\n  process.env.NODE_ENV !== 'production' &&\n  process.env.NODE_ENV !== 'test' &&\n  console.warn(\n    `WARNING: ${component}\n==================================================\nPlease check model at:\n${id}\n\n${message}\n`);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/helpers.js","const SHOW_LOGS = false;\nconst SHOW_WARNINGS = false;\n\nfunction log(...args) {\n  if (SHOW_LOGS) {\n    console.info(...args);\n  }\n}\nfunction warn(...args) {\n  if (SHOW_WARNINGS) {\n    warn(...args);\n  }\n}\n\nexport function selectorCompat(item) {\n  if (!item) {\n    return item;\n  }\n\n  if (item.x && !item.left) {\n    log('Selector compatibility: Adding left property.');\n    Object.defineProperty(item, 'left', {\n      get: function () {\n        warn('Selector compatibility: Using deprecated `left` property.');\n        return this.x;\n      },\n    });\n  }\n  if (item.y && !item.top) {\n    log('Selector compatibility: Adding top property.');\n    Object.defineProperty(item, 'top', {\n      get: function () {\n        warn('Selector compatibility: Using deprecated `top` property.');\n        return this.y;\n      },\n    });\n  }\n\n  if (item.left && !item.x) {\n    warn('Selector compatibility: Missing `x` property, but found `left`, shimming.');\n    item.x = item.left;\n  }\n\n  if (item.top && !item.y) {\n    warn('Selector compatibility: Missing `y` property, but found `top`, shimming.');\n    item.y = item.top;\n  }\n\n  return item;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/utility.js","export function getCurrentSelector(state) {\n  return state.selector.currentSelector;\n}\n\nexport function isSelecting(state) {\n  return (\n    state.selector &&\n    state.selector.currentSelector &&\n    state.selector.currentSelector.type\n  );\n}\n\nexport function currentSelectorIsSecondary(state) {\n  return (\n    isSelecting(state) &&\n    state.selector.currentSelector.secondary &&\n    state.selector.currentSelector.secondary === true\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/selectorQuery.js","import md5 from 'blueimp-md5';\nimport { getCollectionId, getServer } from '../query/elucidateQuery';\nimport { createElucidateCollection, sendAnnotationToServer, postAnnotation, putAnnotation } from '../lib/elucidate';\nimport Annotation from '../lib/annotation/Annotation';\nexport const ELUCIDATE_SET_SERVER = 'ELUCIDATE_SET_SERVER';\nexport const ELUCIDATE_SET_RESOURCE = 'ELUCIDATE_SET_RESOURCE';\nexport const ELUCIDATE_CREATE_COLLECTION = 'ELUCIDATE_CREATE_COLLECTION';\nexport const ELUCIDATE_SET_COLLECTION = 'ELUCIDATE_SET_COLLECTION';\nexport const ELUCIDATE_SEND_ANNOTATION = 'ELUCIDATE_SEND_ANNOTATION';\nexport const ELUCIDATE_ADD_ANNOTATION = 'ELUCIDATE_ADD_ANNOTATION';\n\nexport function initialiseElucidate(elucidateServer, resource, resourceLabel) {\n  return (dispatch, state) => {\n    if (!elucidateServer) {\n      return null;\n    }\n    dispatch(setServer(elucidateServer));\n    dispatch(setResource(resource));\n    dispatch(createCollection(resourceLabel, resource));\n  }\n}\n\nexport function setServer(server) {\n  return { type: ELUCIDATE_SET_SERVER, payload: { server } };\n}\n\nexport function setResource(resource) {\n  return { type: ELUCIDATE_SET_RESOURCE, payload: { resource } };\n}\n\nexport function createCollection(label, resourceId) {\n  return (dispatch, state) => {\n    dispatch({ type: ELUCIDATE_CREATE_COLLECTION, payload: { label, resourceId } });\n    const elucidateServer = getServer(state());\n    return createElucidateCollection(elucidateServer, label, md5(resourceId)).then(\n      collection => {\n        dispatch(\n          setCollection(resourceId, collection),\n        );\n        return collection;\n      },\n    );\n  }\n}\n\nexport function setCollection(resourceId, collection) {\n  return {\n    type: ELUCIDATE_SET_COLLECTION,\n    payload: { resourceId, collection },\n  };\n}\n\nexport function addElucidateAnnotation(annotation) {\n  return { type: ELUCIDATE_ADD_ANNOTATION, payload: { id: annotation.id, annotation } };\n}\n\nexport function elucidateSendAnnotation(annotation: Annotation) {\n  return {\n    type: ELUCIDATE_SEND_ANNOTATION,\n    payload: { annotation: annotation.toJSON() }\n  };\n}\n\nexport function createAnnotation(annotation: Annotation) {\n  return (dispatch, state) => {\n    dispatch(elucidateSendAnnotation(annotation));\n    const collection = getCollectionId(state());\n    return postAnnotation(collection, annotation).then(\n      annotation =>\n        dispatch(\n          addElucidateAnnotation(annotation)\n        )\n    );\n  }\n}\n\nexport function updateAnnotation(id, annotation: Annotation) {\n  return (dispatch, state) => {\n    const collection = getCollectionId(state());\n    dispatch(elucidateSendAnnotation(annotation));\n    const annoationId = (collection.substr(collection.length - 1) === '/' ? collection : collection + '/') + id;\n    annotation.id = annoationId;\n    return putAnnotation(annoationId, annotation).then(\n      annotation =>\n        dispatch(\n          addElucidateAnnotation(annotation)\n        )\n    );\n  }\n}\n\n/**\n * @deprecated\n */\nexport function sendAnnotation(body, target, motivation, label) {\n  return (dispatch, state) => {\n    dispatch({ type: ELUCIDATE_SEND_ANNOTATION, payload: { annotation: { body, target, motivation, label } } });\n    const collection = getCollectionId(state());\n    return sendAnnotationToServer(collection, body, target, motivation, label).then(\n      annotation =>\n        dispatch(\n          addElucidateAnnotation(annotation),\n        ),\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/elucidate.js","import { AnnotationSelector } from '../lib/elucidate/index';\nexport function getServer(state) {\n  return state.elucidate.server;\n}\n\nexport function getAnnotationById(state, id) {\n  return state.elucidate.annotations[id];\n}\n\nexport function isSendingAnnotations(state) {\n  return state.elucidate.pendingAnnotations > 0;\n}\n\nexport function getCanvasFromManifest(manifest, canvasId) {\n  if (!(\n      manifest ||\n      manifest.sequences ||\n      manifest.sequences[0] ||\n      manifest.sequences[0].canvases\n    )) {\n    return null;\n  }\n  const canvases = manifest.sequences[0].canvases;\n  for (let canvas of canvases) {\n    if (canvas['@id'] === canvasId) {\n      return canvas;\n    }\n  }\n  return null;\n}\n\nexport function getCollectionId(state) {\n  return state.elucidate.collection.id;\n}\n\n// @todo swap into annotationList eventually.\nexport function richAnnotationList(state) {\n  return annotationList(state).map(annotation => ({\n    ...annotation,\n    selector: AnnotationSelector.parse(annotation.target),\n  }))\n}\n\nexport function annotationList(state) {\n  const elucidateAnnotations = Object.keys(state.elucidate.annotations).map(key => state.elucidate.annotations[key]);\n  const elucidateAnnotationsExist = !!elucidateAnnotations.length;\n  if (!elucidateAnnotationsExist) {\n    return [];\n  }\n  return elucidateAnnotations;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/elucidateQuery.js","export const MANIFEST_ADD = 'MANIFEST_ADD';\nexport const MANIFEST_SELECT = 'MANIFEST_SELECT';\nexport const MANIFEST_REMOVE = 'MANIFEST_REMOVE';\nexport const MANIFEST_REQUEST = 'MANIFEST_REQUEST';\nexport const MANIFEST_CANVAS_SELECT = 'MANIFEST_CANVAS_SELECT';\n\nexport function requestManifest(url, select = true) {\n  return dispatch => {\n    dispatch({ type: MANIFEST_REQUEST, payload: { url } });\n    return fetch(url)\n      .then(response => response.json())\n      .then((body) => {\n        dispatch(addManifest(url, body));\n        if (select) {\n          dispatch(selectCanvas(url));\n        }\n        return body;\n      });\n  }\n}\n\nexport function selectCanvas(url) {\n  return { type: MANIFEST_CANVAS_SELECT, payload: { url } };\n}\n\nexport function selectManifest(url) {\n  return { type: MANIFEST_SELECT, payload: { url } };\n}\n\nexport function addManifest(url, manifest) {\n  return { type: MANIFEST_ADD, payload: { url, manifest } };\n}\n\nexport function removeManifest(url) {\n  return { type: MANIFEST_REMOVE, payload: { url } };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/manifest.js","import React from 'react';\nimport {render} from 'react-dom';\nimport {Provider} from 'react-redux';\n\nexport function getAttributes($el) {\n  const attributes = {};\n  const length = $el.attributes.length;\n  if (length > 0) {\n    for (let i = 0; i < length; i++) {\n      attributes[prettyName($el.attributes[i].nodeName)] = $el.attributes[i].nodeValue;\n    }\n  }\n  return attributes;\n}\n\nexport function deferred() {\n  let resolve = null;\n  const promise = new Promise(r => {\n    resolve = r;\n  });\n  return {resolve, promise};\n}\n\nexport function unknownPropertyWarning(unknownProps) {\n  delete unknownProps['class'];\n  delete unknownProps['behaviour'];\n  delete unknownProps['style'];\n  if (Object.keys(unknownProps).length) {\n    console.warn('Found unknown properties passed to component', unknownProps);\n  }\n}\n\nexport function connectedBehaviour($el, store, Component) {\n  return render((\n    <Provider store={store}>\n      <Component />\n    </Provider>\n  ), $el);\n}\n\nexport function prettyName(attr) {\n  if (attr.indexOf('data-') === 0) {\n    return attr\n    .substring(5)\n    .replace(/-([a-z])/g, g => g[1].toUpperCase());\n  }\n  return attr;\n}\n\nexport function renderWhen(store, shouldRender, component, root) {\n  return new Promise(resolve => {\n    let subscription = store.subscribe(() => {\n      if (shouldRender(store.getState())) {\n        resolve(render(component, root));\n        subscription();\n      }\n    });\n  });\n}\n\nexport function asyncForEach(iterable, fn) {\n  iterable.next().then(nextIterate => {\n    if (nextIterate.done) {\n      return;\n    }\n    fn(nextIterate.value);\n    return asyncForEach(iterable, fn);\n  }).catch(e => {\n    console.warn('asyncForEach: ', e, iterable);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-core/src/core.utils.js","export function currentManifest(state) {\n  return manifestById(state, state.manifest.current);\n}\n\nexport function getImageServiceFromCanvas(canvas) {\n  if (\n    canvas.images &&\n    canvas.images[0] &&\n    canvas.images[0].resource &&\n    canvas.images[0].resource.service &&\n    canvas.images[0].resource.service['@id']\n  ) {\n    return `${canvas.images[0].resource.service['@id']}/info.json`;\n  }\n\n  if (\n    canvas.thumbnail &&\n    canvas.thumbnail.service &&\n    canvas.thumbnail.service['@id']\n  ) {\n    return `${canvas.thumbnail.service['@id']}/info.json`;\n  }\n  if (\n    canvas.thumbnail &&\n    canvas.thumbnail['@id']\n  ) {\n    return canvas.thumbnail['@id'];\n  }\n\n  return null;\n}\n\nexport function currentImageService(state) {\n  const canvas = currentCanvas(state);\n  if (!canvas) {\n    return null;\n  }\n\n  return getImageServiceFromCanvas(canvas);\n}\n\nexport function currentCanvas(state) {\n  const manifest = currentManifest(state);\n  const canvasId = state.manifest.currentCanvas;\n  if (!(\n      manifest &&\n      canvasId &&\n      manifest.sequences &&\n      manifest.sequences[0] &&\n      manifest.sequences[0].canvases\n    )) {\n    return null;\n  }\n  const canvases = manifest.sequences[0].canvases;\n  for (let canvas of canvases) {\n    if (canvas['@id'] === canvasId) {\n      return canvas;\n    }\n  }\n}\n\nexport function manifestById(state, id) {\n  if (!id) {\n    return null;\n  }\n  if (!state.manifest.list[id]) {\n    return null;\n  }\n  return state.manifest.list[id];\n}\n\nexport function allManifests(state) {\n  const manifestKeys = Object.keys(state.manifest.list);\n  if (!manifestKeys || !manifestKeys.length) {\n    return [];\n  }\n  return manifestKeys.map(key => state.manifest.list[key]);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/manifestQuery.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./TextBox.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./TextBox.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./TextBox.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/TextBox.scss\n// module id = 144\n// module chunks = 0","import React, { Component } from 'react';\nimport BEM from 'digirati-bem-js';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport './EmbeddedResourceEditor.scss';\n\nconst style = BEM.block('embedded-resource-editor');\n\nexport default class EmbeddedResourceEditor extends Component {\n\n  state = { isLoaded: false, isLoading: false };\n\n  renderCurrentValue = (value, props, style) => {\n    const { renderResource } = this.props;\n    if (renderResource) {\n      return renderResource(value, props, style);\n    }\n    return (\n      <div>{value.label ? value.label : value}</div>\n    );\n  };\n\n  componentDidMount() {\n    const { captureModel, importCaptureModel } = this.props;\n    const { isLoading, isLoaded } = this.state;\n    if (isLoading) return null;\n    if (isLoaded) return null;\n    this.setState({ isLoading: true });\n    importCaptureModel(captureModel).then(resourceTemplate => {\n      this.setState({ isLoaded: true, isLoading: false, captureModelId: resourceTemplate['@id'] });\n    });\n  }\n\n  renderResourceEditor = ({ captureModel, postSave, props, style, onBack }) => {\n    const { renderResourceEditor } = this.props;\n    const { isLoading, isLoaded, captureModelId } = this.state;\n    if (isLoading) return 'loading...';\n    if (isLoaded) {\n      return renderResourceEditor(captureModelId, postSave, props, style, onBack);\n    }\n  };\n\n  render() {\n    const { captureModel, value, metaData, id, displayFieldSelector, postSave, onBack } = this.props;\n    return (\n      <div className={style}>\n        {metaData ? (\n          <div>\n            <label className={style.element('label')} htmlFor={id}>\n              {metaData.title} {' '}\n              {(metaData.selector && metaData.selectorValue) ?\n                (<a onClick={(e) => {\n                  e.preventDefault();\n                  displayFieldSelector(id);\n                }} href=\"#\">edit</a>)\n                : null}\n              {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n            </label>\n          </div>\n        ) : null}\n        {value ?\n          this.renderCurrentValue(value, this.props, style) :\n          this.renderResourceEditor({\n            captureModel,\n            postSave,\n            props: this.props,\n            style,\n            onBack,\n          })\n        }\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.js","import React, {Component} from 'react';\nimport BEM from 'digirati-bem-js';\nimport './ComboButton.scss';\n\nconst $style = BEM.block('combo-button');\nexport default class ComboButton extends Component {\n\n  state = {isOpen: false, isHovered: false };\n\n  close = () => {\n    this.setState({isOpen: false});\n  }\n\n  open = () => {\n    this.setState({ isOpen: true });\n  }\n\n  render() {\n    const {children, disabled = false, ...props} = this.props;\n    const options = React.Children.map(children, (child, i) => i < 1 ? null : child);\n    const label = React.Children.map(children, (child, i) => i < 1 ? child : null);\n    return (\n      <div className={$style.modifiers({ disabled })} onMouseLeave={this.close}>\n        <div onMouseEnter={this.close} className={$style.element('button')}>\n          <span className={$style.element('cta').modifiers({ single: options.length === 0 })} {...props}>\n            {label}\n          </span>\n          { options.length ? (\n            <span className={$style.element('toggle').modifiers({ 'open': this.state.isOpen })} onClick={this.open}>&rsaquo;</span>\n          ) : null }\n        </div>\n        { options.length && this.state.isOpen ? (\n          <ul className={$style.element('list')}>\n            {options}\n          </ul>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nComboButton.Option = ({ children, ...props }) => (\n  <li className={$style.element('list-item')} {...props}>\n    {children}\n  </li>\n);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/ComboButton.js","import React, { Component } from 'react';\nimport { connector } from 'digirati-annotation-redux';\nimport { Router } from 'digirati-annotation-components';\nimport {\n  getDraftFromCaptureModel,\n} from 'digirati-annotation-bridge';\nimport { getResourceById, isAtRoot } from 'digirati-annotation-redux/es/query/resourceQuery';\nimport {\n  changeFingerprintSource,\n  changeFingerPrintLifecyle,\n  DRAFT_LIFECYCLE_NEW,\n  DRAFT_LIFECYCLE_CHANGED,\n  generateDraftId,\n} from 'digirati-annotation-redux/es/actions/drafts';\nimport {\n  convertPercentToPixel,\n  createAnnotationFromCaptureModelAndDraft,\n  createInProgressAnnotation,\n} from 'digirati-annotation-redux/es/lib/annotation/mapping';\nimport renderForm from './views/renderForm';\nimport { immediate, mutateLocalStorage } from './resourceEditor.utility';\nimport confirmationPage from './views/confirmationPage';\nimport resourceNavigation from './views/resourceNavigation';\n\nclass ResourceEditor extends Component {\n\n  annotationCreationUpdateFirstCreateRest = (annotationId, annotations) => {\n    const { createAnnotation, updateAnnotation } = this.props;\n    const first = annotations.shift();\n    return [\n      updateAnnotation(annotationId, first),\n      ...annotations.map(singleAnnotation => createAnnotation(singleAnnotation))\n    ];\n  };\n\n  // This can in theory be moved to annotation-redux, once tech debt addressed.\n  createAnnotationToBeMovedToAnnotationRedux = (targetResource) => {\n    const { currentResource, asyncPublishDraft, updateAnnotation, currentDraft, createAnnotation } = this.props;\n\n    // Create our annotation.\n    const annotation = createAnnotationFromCaptureModelAndDraft(targetResource, currentResource, currentDraft);\n\n    const annotationId = currentDraft.fingerprint.identity ? currentDraft.fingerprint.identity : null;\n    // Make a single promise we can wait on for sending one or many annotations.\n    const promise = annotationId ? (\n      // Update annotation.\n      Array.isArray(annotation) ?\n        Promise.all(this.annotationCreationUpdateFirstCreateRest(annotationId, annotation)) :\n        updateAnnotation(annotationId, annotation)) : (\n\n      // Create annotation.\n      Array.isArray(annotation) ?\n        Promise.all(annotation.map(singleAnnotation => createAnnotation(singleAnnotation))) :\n        createAnnotation(annotation)\n    );\n\n    // Publish the draft after the annotations.\n    const result = asyncPublishDraft(currentDraft.id, promise);\n\n    return { result, annotation };\n  };\n\n  // This will replace createAnnotation\n  createAnnotationWithoutTechDebt = () => {\n    const { target, manifest, canvas, postSave } = this.props;\n    const { result, annotation } = this.createAnnotationToBeMovedToAnnotationRedux(target === 'manifest' ? manifest : canvas);\n    if (postSave) {\n      postSave(\n        result, annotation,\n      );\n    }\n  };\n\n  goBack = (discard = false) => {\n    const { moveBack, tree, discardCurrentDraft, currentDraft, deselectDraft, onBack, commitToCurrentDraft, state } = this.props;\n    moveBack(tree);\n    // Discard the draft.\n    if (discard) {\n      mutateLocalStorage(currentList => {\n        if (currentDraft && currentList[currentDraft.template] && currentList[currentDraft.template][currentDraft.id]) {\n          currentList[currentDraft.template][currentDraft.id] = null;\n          delete currentList[currentDraft.template][currentDraft.id];\n        }\n        return currentList;\n      });\n      discardCurrentDraft();\n    } else {\n      // @todo this commits it even if its not been used. Its not correct.\n      // @todo What it should do is cancel the draft and come back to it in place, not currently supported.\n      commitToCurrentDraft();\n      deselectDraft();\n    }\n    if (onBack) {\n      onBack(state);\n    }\n  };\n\n  saveLocally = draft => {\n    const { importDraft } = this.props;\n    if (draft.fingerprint.source === 'elucidate' && draft.fingerprint.identity) {\n      const originalDraft = changeFingerPrintLifecyle(\n        draft,\n        DRAFT_LIFECYCLE_NEW,\n      );\n      importDraft(draft.id, originalDraft);\n      draft.id = generateDraftId();\n    }\n    const changedDraft = changeFingerPrintLifecyle(\n      changeFingerprintSource(draft, 'localStorage'),\n      DRAFT_LIFECYCLE_NEW,\n    );\n    importDraft(draft.id, changedDraft);\n    mutateLocalStorage((currentList) => {\n      currentList[draft.template] = currentList[draft.template] ? currentList[draft.template] : {};\n      currentList[draft.template][draft.id] = changedDraft;\n      return currentList;\n    });\n  };\n\n  saveAsInProgress = draft => {\n    // Save to local storage for now.\n    this.saveLocally(draft);\n    // And take user back without discarding draft.\n    this.goBack(false);\n  };\n\n  onSaveAsIncomplete = draft => {\n    const { createAnnotation, updateAnnotation, target, discardDraft, manifest, publishDraft, importDraft, canvas, getDraftsByFingerprintIdentity } = this.props;\n    // Change draft source to be elucidate.\n    const changedDraft = changeFingerPrintLifecyle(\n      changeFingerprintSource(draft, 'elucidate'),\n      DRAFT_LIFECYCLE_NEW,\n    );\n    // Update locally.\n    importDraft(draft.id, changedDraft);\n\n    if (draft.fingerprint.identity) {\n      const oldDraft = getDraftsByFingerprintIdentity(draft.id, draft.fingerprint.identity);\n      if (oldDraft) {\n        discardDraft(oldDraft.id);\n      }\n      // This is trying to be re-saved, we need to do a put.\n      updateAnnotation(\n        draft.fingerprint.identity,\n        createInProgressAnnotation('In progress annotation', target === 'manifest' ? manifest : canvas, changedDraft, draft.fingerprint.scope, draft.fingerprint.identity),\n      );\n    } else {\n      // Create annotation in elucidate.\n      createAnnotation(\n        createInProgressAnnotation('In progress annotation', target === 'manifest' ? manifest : canvas, changedDraft, draft.fingerprint.scope),\n      );\n    }\n    // Delete from local storage\n    mutateLocalStorage((currentList) => {\n      if (currentList[draft.template] && currentList[draft.template][draft.id]) {\n        currentList[draft.template][draft.id] = null;\n        delete currentList[draft.template][draft.id];\n      }\n      return currentList;\n    });\n    // Mark draft as published.\n    publishDraft(draft.id);\n    // Take user back without discarding draft.\n    this.goBack(false);\n  };\n\n  createAnnotation = () => {\n    const { currentResource, target, manifest, canvas, asyncPublishDraft, currentDraft, updateAnnotation, createAnnotation, postSave } = this.props;\n    const targetResource = target === 'manifest' ? manifest : canvas;\n    this.resolveSelector(target, targetResource, currentDraft).then(draft => {\n      // Create our annotation.\n      const annotation = createAnnotationFromCaptureModelAndDraft(targetResource, currentResource, draft);\n\n      const annotationId = (currentDraft.fingerprint.source === 'elucidate' && currentDraft.fingerprint.identity) ? currentDraft.fingerprint.identity : null;\n      // Make a single promise we can wait on for sending one or many annotations.\n      const promise = annotationId ? (\n        // Update annotation.\n        Array.isArray(annotation) ?\n          Promise.all(this.annotationCreationUpdateFirstCreateRest(annotationId, annotation)) :\n          updateAnnotation(annotationId, annotation)) : (\n\n        // Create annotation.\n        Array.isArray(annotation) ?\n          Promise.all(annotation.map(singleAnnotation => createAnnotation(singleAnnotation))) :\n          createAnnotation(annotation)\n      );\n\n      // Publish the draft after the annotations.\n      const result = asyncPublishDraft(currentDraft.id, promise);\n\n      // Run our post save.\n      if (postSave) {\n        postSave(result, annotation);\n      }\n\n      // Take user back without discarding draft.\n      this.goBack();\n    });\n  };\n\n  hasMultipleSelectorsWithPercentages(currentDraft) {\n    let hasSelectors = false;\n    try {\n      hasSelectors = Object.keys(\n        currentDraft.selectors,\n      ).map(k => currentDraft.selectors[k])\n      .reduce((state, action) => !!(state || (action.type && action.unit === 'percent')), false);\n    } catch (e) {\n      return false;\n    }\n    return hasSelectors;\n  }\n\n  resolveSelector(target, targetResource, draft) {\n    const selector = draft.selector;\n\n    if (target === 'manifest' || !selector) {\n      return Promise.resolve({ ...draft, selector: targetResource });\n    }\n\n    // ########################################################################\n    //       !     Everything below this is technical debt.       !           #\n    // ########################################################################\n    // In order to remove this we need to be sure that\n    // in a draft all selectors, both on the draft and the\n    // draft fields are always pixel values, and not percentages.\n    // work has been done, but the previous code was not removed, so\n    // I've added this in to replace it, and tried to make sure that\n    // it doesn't execute if its doesn't need to. I've also added console\n    // warnings for us to check during execution.\n    // The problem with this code is the dependency on the current state of the\n    // viewer. We need to get the pixel sizes from the viewer in order to resolve\n    // percent values.\n    // For these reasons it did not make it into the annotation-redux package,\n    // and should be verified that it is not being used, and removed, including\n    // the whole resolve selector method itself.\n    // See also: createAnnotationWithoutTechDebt()\n    if (selector.unit === 'percent') {\n      console.warn('ResourceEditor', 'Percentage selectors should not reach drafts, please report.');\n      const { withViewer } = this.props;\n      return new Promise(function (resolve, err) {\n        withViewer(viewer => {\n          const { height, width } = viewer.getImageSize();\n          resolve(\n            this.resolveSelector({\n              ...draft,\n              selector: convertPercentToPixel(selector, height, width),\n            }),\n          );\n        });\n      });\n    }\n\n    if (this.hasMultipleSelectorsWithPercentages(draft)) {\n      console.warn('ResourceEditor', 'Percentage selectors should not reach draft fields, please report.');\n      const { withViewer } = this.props;\n      return new Promise(function (done, err) {\n        withViewer(viewer => {\n          const { height, width } = viewer.getImageSize();\n          const draftFieldSelectors = Object.keys(draft.selectors).reduce((selectors, key) => {\n            selectors[key] = convertPercentToPixel(draft.selectors[key], height, width);\n          }, {});\n          done({ ...draft, selectors: draftFieldSelectors });\n        });\n      });\n    }\n    // ########################################################################\n    //           !          End of technical debt.           !                #\n    // ########################################################################\n\n    return Promise.resolve(draft);\n  }\n\n  render() {\n    const {\n      // Variables\n      currentSelector,\n      currentResourceTemplate,\n      currentDraft,\n      resourceForm,\n      tree,\n      isConfirmingDraft,\n      isSelecting,\n      renderResourceEditor,\n      importCaptureModel,\n      treeRoute,\n      enablePublishing = true,\n\n      // Embedded specifics.\n      immutableSelector,\n      postSave,\n\n      // Actions\n      updateDraft,\n      unpreviewDraft,\n      confirmDraft,\n      previewDraft,\n      discardCurrentDraft,\n      createDraft,\n      isSelectingSecondary,\n      editCurrentDraftSelector,\n      editCurrentDraftSecondarySelector,\n      editCurrentDraftFieldSelector,\n      state,\n      currentResource,\n\n      moveForward,\n      moveBack,\n      onBack,\n      reset,\n\n      target,\n      manifest,\n      canvas,\n\n      // UI Options\n      hideTitle = false,\n      draftDefaults = {},\n    } = this.props;\n\n    if (!currentResource) {\n      console.warn(`\n  ======================================================================\n    WARNING: Something has gone wrong on this page.\n  ======================================================================\n     1. Check the capture model has the correct crowds:uiChoice value.\n     2. Check the capture model has crowds:uiGroup (madoc:form)\n     3. \\\\_()_/\n\n   ======================================================================\n      `);\n      return <div/>;\n    }\n\n    if (currentResource.choice && Object.values(currentResource.choice).length === 0) {\n      console.warn('ResourceEditor', 'This should probably never happen, please report.');\n      return <div/>; // Nothing for us to render!\n    }\n    if (currentResource.choice && Object.values(currentResource.choice).length === 0) {\n      console.warn(`\n  ======================================================================\n    WARNING: Something may have gone wrong on this page\n  ======================================================================\n     We found a choice with only one option.\n     This may be incorrect and causing issues.\n     `);\n    }\n\n    // ################################################\n    //               New proposed API                 #\n    // ################################################\n    /*\n    return (\n      <Router {...props}>\n        <Branch match={(props) => (\n          currentDraft &&\n          currentDraft.template !== currentResource.id\n        )}>\n          <div>Matched this route.</div>\n        </Branch>\n      </Router>\n    )\n\n     */\n    return (\n      <div>\n        <Router routes={[\n          {\n            matches: () => isConfirmingDraft,\n            render: () => confirmationPage({ onConfirm: () => reset(tree) && confirmDraft() }),\n          },\n          {\n            matches: () => (\n              currentDraft &&\n              currentDraft.template !== currentResource.id\n            ),\n            render: () => <div>Please finish the current annotation you are creating.</div>,\n          },\n          {\n            matches: () => currentResource.choice,\n            render: () => resourceNavigation({\n              currentResource,\n              showBackButton: isAtRoot(tree, state) === false,\n              resourceTemplates: currentResource.choice,\n              moveForward: (id) => moveForward(tree, id),\n              moveBack: (id) => moveBack(tree),\n              createDraft: rt => {\n                const { resources, motivation, selectors } = getDraftFromCaptureModel(\n                  getResourceById(state, rt.id),\n                );\n                createDraft(resources, rt.id, motivation || 'tagging', selectors, draftDefaults, null, [...treeRoute, rt.id]);\n              },\n            }),\n          },\n          {\n            matches: () => currentResourceTemplate && resourceForm.fields,\n            render: () => renderForm({\n              currentResourceTemplate,\n              resourceForm,\n              currentDraft,\n              renderResourceEditor,\n              immutableSelector,\n              importCaptureModel,\n              previewDraft,\n              updateDraft,\n              onSave: this.createAnnotation,\n              unpreviewDraft,\n              onSaveAsInProgress: postSave ? null : this.saveAsInProgress,\n              onSaveAsIncomplete: postSave ? null : this.onSaveAsIncomplete,\n              editSelector: editCurrentDraftSelector,\n              isSelecting,\n              target,\n              manifest,\n              canvas,\n              currentSelector,\n              isSelectingSecondary,\n              enablePublishing,\n              goBack: this.goBack,\n              editFieldSelector: editCurrentDraftSecondarySelector,\n              currentTree: currentResource.id,\n              elementEvents: {\n                onFocus: id => editCurrentDraftFieldSelector(id, {\n                  focused: true,\n                }),\n                onBlur: id => editCurrentDraftFieldSelector(id, {\n                  focused: false,\n                }),\n              },\n              hideTitle,\n            }),\n          },\n          {\n            matches: () => currentResource,\n            render: () => {\n              const Choose = immediate('loading...', () => {\n                const { resources, motivation, selectors } = getDraftFromCaptureModel(\n                  getResourceById(state, currentResource.id),\n                );\n                createDraft(resources, currentResource.id, motivation || 'tagging', selectors, draftDefaults, immutableSelector, treeRoute);\n              });\n              return <Choose/>;\n            },\n          },\n          {\n            matches: () => true,\n            render: () => (\n              <div>\n                <strong>Loading, or debugging...</strong>\n              </div>\n            ),\n          },\n        ]}/>\n      </div>\n    );\n  }\n\n}\n\nexport const ConnectedResourceEditor = connector(ResourceEditor);\n\nexport default class extends Component {\n  render() {\n    return (\n      <ConnectedResourceEditor renderResourceEditor={\n        (captureModel, postSave, ownProps, style, onBack) => (\n          <ConnectedResourceEditor\n            tree={captureModel}\n            postSave={postSave}\n            onBack={onBack}\n            immutableSelector={ownProps.currentDraft.selector}\n            style={style}\n            {...ownProps}/>\n        )\n      } {...this.props}/>\n    );\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/resourceEditor.js","export const LOGGING_LOG = 'LOGGING_LOG';\n\nexport function log(message) {\n  return { type: LOGGING_LOG, payload: { message } };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/logging.js","import AnnotationSelector from './AnnotationSelector';\nimport AnnotationBodyList from './AnnotationBodyList';\n\nexport type Motivation = {\n  id: string,\n  label: string\n}\n\nexport default class Annotation {\n\n\n  // Serialized fields\n  id: string;\n  type = 'Annotation';\n  label: string;\n  body: AnnotationBodyList;\n  target: AnnotationSelector|AnnotationSelector[];\n  motivation: Motivation;\n  generator: string;\n\n\n  constructor(\n    id: string,\n    label: string,\n    body: AnnotationBodyList,\n    target: AnnotationSelector,\n    motivation: Motivation,\n    generator: string\n  ) {\n    this['@context'] = 'http://www.w3.org/ns/anno.jsonld';\n    this.id = id;\n    this.label = label;\n    this.body = body;\n    this.target = target;\n    this.motivation = motivation;\n    this.generator = generator;\n  }\n\n  toJSON() {\n    return {\n      ...this,\n      id: this.id === null ? undefined : this.id,\n      generator: this.generator === null ? undefined : this.generator,\n    }\n  }\n\n  static fromJsonLD(jsonLd) {\n    return new Annotation(\n      jsonLd.id,\n      jsonLd.label,\n      AnnotationBodyList.fromJsonLD(jsonLd.body),\n      AnnotationSelector.fromJsonLD(jsonLd.target),\n      jsonLd.motivation,\n    );\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/annotation/Annotation.js","export default class AnnotationSelector {\n\n  static DIRECTION_LTR = 'ltr';\n  static DIRECTION_RTL = 'rtl';\n  static DIRECTION_AUTO = 'auto';\n  static W3C_SELECTOR = /[#&\\?]xywh\\=(pixel\\:|percent\\:)?(\\d+),(\\d+),(\\d+),(\\d+)/;\n\n  static fromJsonLD(jsonLd) {\n    return AnnotationSelector.parse(jsonLd);\n  }\n\n  static fromArray(multipleSelectors) {\n    return multipleSelectors.map(\n      annotation => AnnotationSelector.parse(annotation),\n    );\n  }\n\n  constructor(id, scale, format, language, processingLanguage, textDirection, selector) {\n    if (\n      textDirection && (\n        textDirection !== AnnotationSelector.DIRECTION_AUTO &&\n        textDirection !== AnnotationSelector.DIRECTION_LTR &&\n        textDirection !== AnnotationSelector.DIRECTION_RTL\n      )\n    ) {\n      throw new Error('textDirection must be ONE of [ltr, rtl, auto]');\n    }\n\n    this.id = id;\n    this.source = (id || '').split('#')[0];\n    this.format = format;\n    this.language = language;\n    this.processingLanguage = processingLanguage;\n    this.textDirection = textDirection;\n    this.selector = AnnotationSelector.parseTarget(id, scale, selector);\n  }\n\n  static fromTarget(target, selector) {\n    const annotationSelector = new AnnotationSelector();\n    annotationSelector.source = target;\n    annotationSelector.selector = selector;\n    return annotationSelector;\n  }\n\n  static parse(text, scale = 1) {\n    if (!text) {\n      return null;\n    }\n\n    // https://www.w3.org/TR/annotation-model/#bodies-and-targets\n    if (text.id) {\n      return new AnnotationSelector(\n        text.id,\n        scale,\n        text.format,\n        text.language,\n        text.processingLanguage,\n        text.textDirection,\n      )\n    }\n\n    // https://www.w3.org/TR/annotation-model/#selectors\n    if (text.source) {\n      return new AnnotationSelector(\n        text.source,\n        scale,\n        text.format,\n        text.language,\n        text.processingLanguage,\n        text.textDirection,\n        text.selector,\n      );\n    }\n\n    // @todo check for is text or is object and construct accordingly.\n    return new AnnotationSelector(text, scale);\n  }\n\n  static parseTarget(source, scale = 1, selector = null) {\n    let toParse = source;\n    if (selector && selector.type === 'FragmentSelector') {\n      toParse = `${source}#${selector.value}`;\n    }\n\n    const match = AnnotationSelector.W3C_SELECTOR.exec(toParse);\n    if (match) {\n      const [_, __, x, y, width, height] = match.map(v => parseInt(v, 10) * scale);\n      return {\n        unit: (match[1] === 'percent:' ? 'percent' : 'pixel'),\n        scale,\n        expanded: true,\n        x,\n        y,\n        width,\n        height,\n        toString() {\n          return source.split('#')[0];\n        }\n      };\n    }\n    return source;\n  }\n\n  toJSON() {\n    if (\n      !this.selector ||\n      this.selector.x === null || isNaN(Math.floor(this.selector.x)) ||\n      this.selector.y === null || isNaN(Math.floor(this.selector.y))\n    ) {\n      return this.source;\n    }\n\n    if (\n      this.selector.width === null || isNaN(this.selector.width) ||\n      this.selector.height === null || isNaN(this.selector.height)\n    ) {\n      return `${this.source}#xywh=${Math.floor(this.selector.x)},${Math.floor(this.selector.y)},0,0`;\n    }\n\n    return `${this.source}#xywh=${Math.floor(this.selector.x)},${Math.floor(this.selector.y)},${Math.floor(this.selector.width)},${Math.floor(this.selector.height)}`;\n  }\n\n  toString() {\n    return this.id;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/annotation/AnnotationSelector.js","import AnnotationBody from './AnnotationBody';\n\nexport default class AnnotationBodyList {\n\n  constructor(list: Array<AnnotationBody>) {\n    if (list instanceof AnnotationBody) {\n      this.list = [list];\n    } else {\n      this.list = list || [];\n    }\n  }\n\n  getOfType = (type): AnnotationBody => {\n    return (this.list.find(function (item) {\n      return item.type.indexOf(type) !== -1;\n    }).value || null);\n  };\n\n  // Computed fields.\n  get TextualBody(): AnnotationBody {\n    return this.getOfType('TextualBody');\n  }\n\n  get Image(): AnnotationBody {\n    return this.getOfType('Image');\n  }\n\n  get Video(): AnnotationBody {\n    return this.getOfType('Video');\n  }\n\n  get Sound(): AnnotationBody {\n    return this.getOfType('Sound');\n  }\n\n  get Text(): AnnotationBody {\n    return this.getOfType('Text');\n  }\n\n  get SpecificResource(): AnnotationBody {\n    return this.getOfType('SpecificResource');\n  }\n\n  get Dataset(): AnnotationBody {\n    return JSON.parse(this.getOfType('Dataset'));\n  }\n\n  toJSON() {\n    if (this.list.length === 1) {\n      return this.list[0].toJSON();\n    }\n    return this.list.map(j => j.toJSON());\n  }\n\n  static fromJsonLD(body) {\n    if (\n      Object.prototype.toString.call(body) === '[object Object]' && body.value\n    ) {\n      return new AnnotationBodyList([\n        AnnotationBody.fromJsonLD(body)\n      ]);\n    }\n\n    if (Object.prototype.toString.call(body) !== '[object Array]') {\n      return null;\n    }\n\n    return new AnnotationBodyList(body.map(anno => AnnotationBody.fromJsonLD(anno)));\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/annotation/AnnotationBodyList.js","/**\n * This is a port of: https://github.com/digirati-co-uk/omeka-elucidate-module/blob/master/src/Domain/AnnotationBody.php\n */\n\nexport type BodyType = 'Dataset' | 'Image' | 'Video' | 'Sound' | 'Text' | 'SpecificResource';\nexport type TextDirections = 'ltr' | 'rtl' | 'auto';\n\nexport default class AnnotationBody {\n\n  id: string;\n  format: string; // @todo add enum\n  language: string;\n  processingLanguage: string;\n  textDirection: ?TextDirections;\n  type: Array<BodyType>;\n\n  constructor(\n    id,\n    value,\n    format,\n    type,\n    purpose,\n    source,\n    language,\n    processingLanguage,\n    textDirection,\n  ) {\n    this.id = id;\n    this.value = value;\n    this.type = Array.isArray(type) ? type : [type];\n    this.purpose = purpose;\n    this.format = format;\n    this.source = source;\n    this.language = language;\n    this.processingLanguage = processingLanguage;\n    this.textDirection = textDirection;\n  }\n\n  static fromJsonLD(jsonLd) {\n    return AnnotationBody.fromBody(jsonLd);\n  }\n\n  toJSON() {\n    return {\n      ...this,\n      id: this.id === null ? undefined : this.id,\n      value: this.value === null ? undefined : this.value,\n      purpose: this.purpose === null ? undefined : this.purpose,\n      type: this.type.length === 1 ? this.type[0] : this.type,\n    };\n  }\n\n  static fromBody(body) {\n    if (!body) {\n      return new AnnotationBody();\n    }\n    return new AnnotationBody(\n      body.id,\n      body.value,\n      body.format,\n      body.type,\n      body.purpose,\n      body.source,\n      body.language,\n      body.processingLanguage,\n      body.textDirection,\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/annotation/AnnotationBody.js","export const HELP_INFO_ADD = 'INFO_ADD';\nexport const HELP_INFO_REMOVE = 'INFO_REMOVE';\nexport const HELP_CONTEXT_ADD = 'HELP_CONTEXT_ADD';\nexport const HELP_CONTEXT_REMOVE = 'HELP_CONTEXT_REMOVE';\n\nexport function addInfo(key, content, type = 'info') {\n  return { type: HELP_INFO_ADD, payload: { key, content, type } };\n}\n\nexport function removeInfo(key, type = 'info') {\n  return { type: HELP_INFO_REMOVE, payload: { key, type } };\n}\n\nexport function setContext(content) {\n  return { type: HELP_CONTEXT_ADD, payload: { content } };\n}\n\nexport function removeContext() {\n  return { type: HELP_CONTEXT_REMOVE }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/help.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport Core from './core';\n\nclass CoreProvider extends PureComponent {\n\n  render() {\n    const {store, ...props} = this.props;\n    return (\n      <Provider store={store}>\n        <Core {...props}/>\n      </Provider>\n    );\n  }\n}\n\nexport default CoreProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-core/src/core.provider.js","import React, { Component } from 'react';\nimport { connector } from 'digirati-annotation-redux';\nimport { changeFingerprintSource, changeFingerprintIdentity, changeFingerPrintCreator } from 'digirati-annotation-redux/es/actions/drafts';\nimport { getAllAnnotationsFromCollection } from 'digirati-annotation-redux/es/lib/elucidate/index';\nimport { asyncForEach } from './core.utils';\nimport 'whatwg-fetch';\n\nclass Core extends Component {\n\n  static ONLINE = 0;\n  static ONLINE_NOTIFICATION = 1;\n  static OFFLINE = 2;\n\n  state = {\n    onlineStatus: Core.ONLINE\n  };\n\n  setOnline = () => {\n    this.setState({ onlineStatus: Core.ONLINE_NOTIFICATION });\n    setTimeout(() => {\n      this.setState({ onlineStatus: Core.ONLINE });\n    }, 2000)\n  };\n\n  setOffline = () => {\n    this.setState({ onlineStatus: Core.OFFLINE });\n  };\n\n  warnUser = (event) => {\n    const {drafts} = this.props;\n    const changes = drafts ? Object.values(drafts).filter(draft => draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED') : [];\n    if (changes.length) {\n      const message = `You have ${changes} unsaved annotation${changes.length > 1 ? 's' : null}, if you leave the page they will be lost.`;;\n      event.preventDefault();\n      event.returnValue = message;\n      return message;\n    }\n    return null;\n  };\n\n\n  componentDidMount() {\n    const {\n      setServer,\n      canvas: canvasId,\n      manifest,\n      createCollection,\n      addElucidateAnnotation,\n      setResource,\n      elucidateServer,\n      addManifest,\n      selectManifest,\n      selectCanvas,\n      importDraft,\n      savedDraftList,\n    } = this.props;\n\n    const subject = canvasId ? canvasId : manifest;\n\n    if (!elucidateServer) {\n      return;\n    }\n    if (canvasId) {\n      fetch(manifest)\n        .then(response => response.json())\n        .then(response => addManifest(manifest, response))\n        .then(response => selectManifest(manifest))\n        .then(response => canvasId ? selectCanvas(canvasId) : null);\n    }\n    // Set the server.\n    setServer(elucidateServer, subject);\n    // Set the resource.\n    if (subject) {\n      setResource(subject);\n    }\n\n    window.addEventListener('online',  this.setOnline);\n    window.addEventListener('offline', this.setOffline);\n    window.addEventListener('beforeunload', this.warnUser);\n\n    this.setState({ onlineStatus: navigator.onLine ? Core.ONLINE : Core.OFFLINE });\n\n    // Import local storage saved items\n    if (savedDraftList && Object.keys(savedDraftList).length) {\n      Object.values(savedDraftList).forEach(\n        drafts => Object.values(drafts).forEach(\n          draft => {\n            importDraft(draft.id, changeFingerPrintCreator(draft, 'you'))\n          }\n        )\n      );\n    }\n\n    const isSavedDraft = (annotation) => {\n      if (annotation.motivation !== 'http://www.digirati.com/ns/crowds#drafting') {\n        return false;\n      }\n      if (Array.isArray(annotation.body)) {\n        return false;\n      }\n      return (\n        annotation.body.purpose === 'editing'\n      );\n    };\n\n    // Set collection.\n    createCollection(subject, subject)\n      .then(c => getAllAnnotationsFromCollection(c))\n      .then(iterable =>\n        asyncForEach(iterable, i => {\n            if (isSavedDraft(i)) {\n              const draft = JSON.parse(i.body.value);\n              const identity = i.id.substr(i.id.length-1) === '/' ? i.id.substr(0, i.id.length-1).split('/').pop() : i.id.split('/').pop();\n              if (draft) {\n                importDraft(draft.id, changeFingerPrintCreator(changeFingerprintIdentity(draft, identity), (i.creator && i.creator.name) ? i.creator.name : 'unknown'));\n              }\n            } else {\n              addElucidateAnnotation(i);\n            }\n          }\n        ),\n      );\n  }\n\n  renderOffline() {\n    const {drafts} = this.props;\n    const changes = drafts ? Object.values(drafts).filter(draft => draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED') : [];\n    return (\n      <div className={'offline-notice'}>\n        This page is currently offline. {` `}\n        { changes.length ? (\n          <span>\n            If you leave this page you may lose your progress on {changes.length} annotation{changes.length > 1 ? 's' : null}\n          </span>\n          ) : null}\n      </div>\n    );\n  }\n\n  renderOnline() {\n    return (\n      <div className={'online-notice'}>\n        Internet connection restored\n      </div>\n    );\n  }\n\n  render() {\n    const {onlineStatus} = this.state;\n\n    return (\n      <div>\n        { onlineStatus === Core.OFFLINE ? (this.renderOffline()) : null}\n        { onlineStatus === Core.ONLINE_NOTIFICATION ? (this.renderOnline()) : null}\n        <span style={{ display: 'none' }}>Annotation studio is running on this page. React {React.version}</span>\n      </div>\n    );\n  }\n}\n\nexport default connector(Core);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-core/src/core.js","import * as actions from './actions';\nimport * as query from './query';\nimport reducers from './reducers';\nimport connector from './connector';\nimport createStore from './createStore';\n\nexport {\n  actions, query, reducers, createStore, connector,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/index.js","import React, {PureComponent} from 'react';\nimport './HelpTooltip.scss';\nimport BEM from 'digirati-bem-js';\n\nconst $style = BEM.block('help-tooltip');\nexport default class HelpTooltip extends PureComponent {\n  render() {\n    const {label, children} = this.props;\n    return (\n      <span className={$style}>\n        <span className={$style.element('label')}>{ label ? label : null }</span>\n        <span className={$style.element('tooltip')}>{ children }</span>\n      </span>\n    );\n\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/ui/HelpTooltip.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport Viewer from './viewer';\n\nclass ViewerProvider extends PureComponent {\n\n  render() {\n    const {store, ...props} = this.props;\n    return (\n      <Provider store={ store }>\n        <Viewer { ...props } />\n      </Provider>\n    );\n  }\n}\n\nexport default ViewerProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-viewer/src/viewer.provider.js","import React, {PureComponent} from 'react';\nimport 'core-js/modules/es6.object.keys';\nimport {immutableRegionsFromAnnotations} from 'digirati-annotation-bridge/es/annotations';\nimport {richAnnotationList} from 'digirati-annotation-redux/es/query/elucidateQuery';\nimport {currentCanvas} from 'digirati-annotation-redux/es/query/manifestQuery';\nimport {resourceTemplateList} from 'digirati-annotation-redux/es/query/resourceQuery';\nimport {Canvas} from 'digirati-annotation-components';\nimport {connector} from 'digirati-annotation-redux';\nimport {selectorCompat} from 'digirati-annotation-redux/es/utility';\nimport Measure from 'react-measure';\nimport {withState} from 'recompose';\n\nclass Viewer extends PureComponent {\n\n  setViewer(viewer) {\n    if (this.viewer) {\n      return;\n    }\n    this.viewer = viewer;\n    this.props.setViewer(viewer);\n  }\n\n  render() {\n    const MAX_HEIGHT = window.innerHeight - 250;\n\n    const {\n      image,\n      selectedViewer,\n      updateDimensions,\n      editableRegions,\n      dimensions,\n      state,\n      toggleable,\n      drafts,\n      currentDraftSelectors,\n      updateSelector,\n      editCurrentDraftSecondarySelector,\n      commitToCurrentDraft,\n      editCurrentDraftSelector,\n      currentSelector,\n      showControls,\n    } = this.props;\n    const VIEWER_WIDTH = dimensions.width;\n\n    const regions = [\n      ...editableRegions,\n      ...immutableRegionsFromAnnotations(\n        richAnnotationList(state),\n        resourceTemplateList(state),\n      ),\n      ...currentDraftSelectors,\n    ].map(region => selectorCompat(region));\n\n    // @todo move to selector\n    const selectedCanvas = currentCanvas(state);\n    return (\n      <Measure\n        onMeasure={(dimensions) => updateDimensions(dimensions)}\n      >\n        <div style={{ height: '100%' }}>\n          { selectedCanvas ? (\n            <Canvas ref={ref => this.setViewer(ref)}\n                    showAnnotationToggle={toggleable === \"true\"}\n                    onUpdateSelector={updateSelector}\n                    showControls={showControls}\n                    onSaveSelector={commitToCurrentDraft}\n                    selector={currentSelector && currentSelector.type ? currentSelector : null}\n                    selectedViewer={selectedViewer}\n                    image={image}\n                    canvas={selectedCanvas}\n                    regions={regions}\n                    displayWidth={VIEWER_WIDTH}\n                    onEditRegion={(e) => {\n                      if (e.isSecondary) {\n                        if (!e.id) {\n                          return;\n                        }\n                        editCurrentDraftSecondarySelector(e.id)\n                      }\n                      editCurrentDraftSelector();\n                    }}\n                    maxHeight={MAX_HEIGHT}/>\n          ) : (\n            <div style={{ height: '80vh', textAlign: 'center' }}>\n              <img src={image.src} style={{ maxHeight: '100%', margin: '0 auto'}}/>\n            </div>\n          ) }\n        </div>\n      </Measure>\n    );\n  }\n}\n\nexport default connector(\n  withState('dimensions', 'updateDimensions', {width: -1, height: -1})(\n    /*onlyUpdateForKeys([\n     'image',\n     'selectedViewer',\n     'drafts',\n     'currentDraft',\n     'updateSelector',\n     'commitToCurrentDraft',\n     'currentSelector',\n     ])(*/Viewer/*)*/,\n  ),\n);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-viewer/src/viewer.js","import { getCurrentDraft } from './draftQuery';\n\nexport function getResourceById(state, id) {\n  return state.resource.list[id];\n}\n\nexport function applyDefaultsToDraft(state, template, input, draftDefaults) {\n  const form = getForm(getResourceById(state, template));\n  if (!form || !form.fields) {\n    return input;\n  }\n\n  const fields = Object.values(form.fields).reduce((s, f) => (s[f.id] = f ) && s, {});\n  const draftDefaultKeys = Object.keys(draftDefaults);\n  const filledInputs = Object.keys(input).reduce((input, url) => {\n    if (\n      fields &&\n      fields[url] &&\n      fields[url].metaData &&\n      fields[url].metaData.conformsTo &&\n      fields[url].metaData.conformsTo.label &&\n      draftDefaultKeys.indexOf(fields[url].metaData.conformsTo.label) !== -1\n    ) {\n      input[url] = draftDefaults[fields[url].metaData.conformsTo.label];\n    }\n    return input;\n  }, input);\n\n  return {...input, ...filledInputs};\n}\n\nexport function getCurrentResource(tree, state) {\n  if (!(\n      state &&\n      state.resource &&\n      state.resource.currentPaths\n    )) {\n    return null;\n  }\n\n  const value = state.resource.currentPaths[tree];\n\n  if (!value) {\n    return getResourceById(state, tree);\n  }\n\n  if (value && value.length === 0) {\n    return state.resource.trees[tree];\n  }\n\n  const node = value.reduce((curState, path) => curState.choice[path], state.resource.trees[tree]);\n\n  if (!node) {\n    console.error('Invalid path', value, state.resource.trees[tree]);\n    return null;\n  }\n\n  // @todo add isReference field to pick up.\n  if (node.type === 'captureModel') {\n    return state.resource.list[node.id];\n  }\n\n  return node;\n}\n\nexport function isAtRoot(tree, state) {\n  if (!(\n      state &&\n      state.resource &&\n      state.resource.currentPaths &&\n      state.resource.currentPaths[tree]\n    )) {\n    return true; // default to true to hide UI.\n  }\n\n  return (state.resource.currentPaths[tree].length === 0);\n}\n\nexport function hasLandedOnForm(tree, state) {\n  const currentItem = getCurrentResource(state, tree);\n  if (!currentItem) {\n    return false;\n  }\n  return currentItem.type === 'captureModel';\n}\n\nexport function getCurrentResourceTemplate(state, scope) {\n  const currentDraft = getCurrentDraft(state, scope);\n  return (currentDraft && currentDraft.template) ? state.resource.list[currentDraft.template] : null;\n}\n\nexport function getForm(resourceTemplate) {\n  if (!resourceTemplate) {\n    return null;\n  }\n  const { id, fields, ...meta } = resourceTemplate;\n  return {\n    id,\n    fields,\n    meta: { ...meta, ...meta.metaData },\n  }\n}\n\nexport function resourceTemplateList(state) {\n  const list = state.resource.list;\n  const keys = Object.keys(list);\n  if (!keys[0]) {\n    return [];\n  }\n  return list[keys[0]];\n}\n\nexport function getCurrentPath(obj, state) {\n  return state.resource.currentPath.reduce((o, i) => o[i], obj);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/resourceQuery.js","import React from 'react';\nimport {branch, compose, renderComponent, renderNothing} from 'recompose';\nimport {withManifest} from './openseadragon/utility';\nimport OSDViewer from './openseadragon/viewer';\nimport withCanvas from './openseadragon/withCanvas';\nimport ScaledImageViewer from './ScaledImageViewer';\nimport StaticImageViewer from './StaticImageViewer';\n\n\nexport default compose(\n  // @todo optimise this!\n  // shouldUpdate(\n  //   (props, nextProps) => (\n  //     true ||\n  //     props.type !== nextProps.type ||\n  //     props.regions !== nextProps.regions ||\n  //     props.tileSource !== nextProps.tileSource ||\n  //     props.scale !== nextProps.scale\n  //   ),\n  // ),\n  // Branches are conditional render. First parameter is a bool\n  // the second argument is the truth-y and the third is the false-y\n  branch(\n    props => props.type === 'ScaledImageViewer',\n    // Needs withStaticCanvas for interoperability\n    // Needs to accept children that get drawn on.\n    renderComponent(ScaledImageViewer),\n    // I've nested the false-y to add another condition.\n    branch(\n      props => props.type === 'OpenSeadragonViewer',\n      renderComponent(\n          withManifest(\n            withCanvas(OSDViewer)\n          ),\n      ),\n      // Fallback.\n      renderComponent(StaticImageViewer),\n    ),\n  ),\n  // pure,\n)(renderNothing());\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/Viewer.js","import React, { Component } from 'react';\nimport StaticImageViewer from './StaticImageViewer';\n\nclass ScaledImageViewer extends Component {\n\n  // static propTypes = {\n  //     ...viewerPropTypes,\n  //     scale: PropTypes.number.isRequired\n  // };\n\n  getSelectedRegion() {\n    const { regions, scale } = this.props;\n    const r = regions.filter(region => region.selected).pop();\n    if (!r) return null;\n    return {\n      height: r.height / scale,\n      width: r.width / scale,\n      top: r.top / scale,\n      left: r.left / scale,\n    };\n  }\n\n  createRelativePoint(x, y) {\n    const { scale } = this.props;\n    return {\n      x: x / scale, y: y / scale\n    };\n  }\n\n  createViewportPoint(x, y) {\n    const { scale } = this.props;\n    return {\n      x: x * scale, y: y * scale\n    };\n  }\n\n  getImageSize() {\n    return {\n      height: this.props.height,\n      width: this.props.width,\n    }\n  }\n\n  getRef() {\n    const {getRef} = this.props;\n    if (getRef) {\n      getRef(this);\n    }\n  }\n\n  getRegions() {\n    const { regions, scale } = this.props;\n    return regions.map(r => ({\n      height: r.height / scale,\n      width: r.width / scale,\n      top: r.top / scale,\n      left: r.left / scale,\n    }))\n  }\n\n  render() {\n    const { height, width, top, left, scale, ...props } = this.props;\n    return (\n      <StaticImageViewer\n        height={height * scale}\n        width={width * scale}\n        top={top * scale}\n        left={left * scale}\n        modifiers={{ scaled: true }}\n        {...props}\n      />\n    );\n  }\n}\n\nexport default ScaledImageViewer;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/ScaledImageViewer.js","import BEM from 'digirati-bem-js';\nimport React, {PureComponent} from 'react';\nimport './StaticImageView.scss';\n\nconst style = BEM.block('static-image-viewer');\n\nclass StaticImageViewer extends PureComponent {\n\n  // propTypes = {\n  //   ...viewerPropTypes,\n  //   modifiers: PropTypes.object\n  // };\n\n  getSelectedRegion() {\n    const {regions} = this.props;\n    const r = regions.filter(region => region.selected).pop();\n    if (!r) return null;\n    return {\n      type: r.type,\n      height: r.height,\n      width: r.width,\n      top: r.top,\n      left: r.left,\n    };\n  }\n\n  getImageSize() {\n    return {\n      height: this.props.height,\n      width: this.props.width,\n    }\n  }\n\n  createRelativePoint(x, y) {\n    return {x, y};\n  }\n\n  createViewportPoint(x, y) {\n    return {x, y};\n  }\n\n  getRef() {\n    const {getRef} = this.props;\n    if (getRef) {\n      getRef(this);\n    }\n  }\n\n  resolveRegion(r) {\n    if (r.unit === 'percent') {\n      return this.resolveRegion({\n        unit: 'pixel',\n        type: r.type,\n        left: r.left * this.props.width,\n        top: r.top * this.props.height,\n        width: r.width * this.props.width,\n        height: r.height * this.props.height,\n      });\n    }\n\n    return {\n      type: r.type,\n      height: r.height,\n      width: r.width,\n      top: r.top,\n      left: r.left,\n    };\n  }\n\n  getRegions() {\n    return this.props.regions.map(r => this.resolveRegion(r));\n  }\n\n  render() {\n    const {resource, regions, height, width, modifiers} = this.props;\n    return (\n      <div className={style.modifiers(modifiers)} style={{height, width}}>\n        <div className={style.element('regions')}>\n          { regions && regions.map((region, key) => (\n            <div\n              key={key}\n              className={style.element('region-item').modifiers({\n                'selected': region.selected,\n                'editing': region.editing,\n              })}\n              style={{\n                height: region.height,\n                width: region.width,\n                top: region.top,\n                left: region.left,\n              }}\n              onClick={ region.onClick ? () => region.onClick(region) : null }>\n            </div>\n          )) }\n        </div>\n        <img className={style.element('image')} src={resource} height={height} width={width}/>\n      </div>\n    );\n  }\n\n}\n\nexport default StaticImageViewer;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/StaticImageViewer.js","import React, { PropTypes } from 'react';\nimport selectorPropTypes from './_selectorPropTypes';\nimport BoxSelector from './BoxSelector';\nimport PinSelector from './PinSelector';\nimport WholeCanvasSelector from './WholeCanvasSelector';\n\nfunction Selector({ type, ...props }) {\n\n  switch (type) {\n    case 'WholeCanvasSelector':\n    case 'wholecanvasselector':\n      return <WholeCanvasSelector {...props}/>;\n    case 'madoc:pin':\n      return <PinSelector {...props}/>;\n    case 'BoxSelector':\n    case 'madoc:boxdraw':\n    default:\n      return <BoxSelector {...props}/>;\n  }\n}\n\nSelector.PropTypes = {\n  type: PropTypes.string.isRequired,\n  ...selectorPropTypes\n};\n\nexport default Selector;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/selectors/Selector.js","import { PropTypes } from \"react\";\n\nexport default {\n  onSave: PropTypes.func.isRequired,\n  onCancel: PropTypes.func,\n  initialPosition: PropTypes.shape({\n    left: PropTypes.number,\n    top: PropTypes.number,\n    height: PropTypes.number,\n    width: PropTypes.number,\n  }),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/selectors/_selectorPropTypes.js","import BEM from 'digirati-bem-js';\nimport React, { PureComponent } from 'react';\nimport './Form.scss';\nimport FormGroup from './FormGroup';\n\nconst style = BEM.block('input-form');\n\nclass Form extends PureComponent {\n\n  renderGroups(draft, props, { render, groups }) {\n    const groupKeys = [FormGroup.DEFAULT_GROUP, ...Object.keys(groups)];\n    return groupKeys.map(key =>\n      render[key].length !== 0 ? (\n        <FormGroup\n          key={key}\n          groupKey={key}\n          style={style}\n          draft={draft}\n          fields={render[key]}\n          group={groups[key]} {...props}/>\n      ) : null,\n    );\n  }\n\n  render() {\n    const { fields, draft, ...props } = this.props;\n    return (\n      <div className={style}>\n        {this.renderGroups(\n          draft,\n          props,\n          fields.reduce(\n            ({ render, groups }, field) => {\n              if (!field.omekaMetaData.group.id) {\n                render[FormGroup.DEFAULT_GROUP].push(field);\n                return { render, groups };\n              }\n              if (!groups[field.omekaMetaData.group.id]) {\n                groups[field.omekaMetaData.group.id] = field.omekaMetaData.group;\n                render[field.omekaMetaData.group.id] = [];\n              }\n              render[field.omekaMetaData.group.id].push(field);\n              return { render, groups };\n            }\n            , { render: { defaultGroup: [] }, groups: {} }),\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Form;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/Form.js","import React, { PureComponent } from 'react';\nimport BEM from 'digirati-bem-js';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport debounce from 'lodash/debounce';\nimport './Autocomplete.scss';\n\nconst style = BEM.block('autocomplete');\n\nconst AUTOCOMPLETE_DEBOUNCE_DELAY = 250;\nconst KEYCODE_ESCAPE = 27;\n\ninterface AutocompleteValue {\n  label: string,\n  uri: string\n}\n\nexport default class Autocomplete extends PureComponent {\n\n  state = {\n    suggestionListHidden: false,\n    suggestions: [],\n    label: '',\n  };\n\n  componentDidMount() {\n    if (this.props.value && this.props.value.label) {\n      this.setState(() => ({\n        label: this.props.value.label\n      }));\n    }\n  }\n\n  fetchNewSuggestions = debounce(() => {\n    const { suggestionProvider } = this.props;\n\n    suggestionProvider(this.state.label)\n    .then(suggestions => {\n      this.setState({\n        suggestions,\n        suggestionListHidden: false,\n      });\n    });\n  }, AUTOCOMPLETE_DEBOUNCE_DELAY);\n\n  handleInputReference = (ref) => {\n    this.input = ref;\n  };\n\n  handleCompletionSelection = (selection) => {\n    this.updateValue({\n      label: selection.label,\n      uri: selection.uri,\n    });\n\n    this.setState({\n      suggestionListHidden: true,\n    });\n\n    if (this.input) {\n      this.input.focus();\n    }\n  };\n\n  handleKeyUp = (evt) => {\n    switch (evt.keyCode) {\n      case KEYCODE_ESCAPE:\n        this.setState({\n          suggestionListHidden: true\n        });\n        break;\n      default:\n        this.fetchNewSuggestions();\n        break;\n    }\n  };\n\n  updateValue(value: AutocompleteValue) {\n    this.setState({\n      label: value.label,\n    });\n\n    const { update } = this.props;\n    update({ label: value.label, url: value.uri });\n  }\n\n  render() {\n    const { preview, id, metaData } = this.props;\n    const { suggestionListHidden, label } = this.state;\n\n    if (preview) {\n      return <div className={style.element('preview')}>{label}</div>;\n    }\n\n    const suggestionList = <ul className={style.element('suggestions')}>\n      {this.state.suggestions.map((suggestion: AutocompleteValue, key) => {\n        return (\n          <li key={key}\n              onClick={e => this.handleCompletionSelection(suggestion)}>\n            {suggestion.label}\n          </li>\n        );\n      })}\n    </ul>;\n\n    return (\n      <div className={style}>\n        <label className={style.element('label')} htmlFor={id}>\n            {metaData.title} {' '}\n            { (metaData.selector && metaData.selectorValue) ?\n                (<a onClick={(e) => {\n                    e.preventDefault();\n                    displayFieldSelector(id);\n                }} href=\"#\">edit</a>)\n                : null }\n            {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        <input id={id} type=\"text\" className={style.element('input')} value={label}\n               ref={this.handleInputReference}\n               onChange={e => this.setState({ label: e.currentTarget.value })}\n               onKeyUp={e => this.handleKeyUp(e)} />\n        { suggestionListHidden ? '' : suggestionList}\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/Autocomplete.js","import plugin from './resourceEditor.plugin';\nimport provider from './resourceEditor.provider';\nimport Component from './resourceEditor';\n\nexport {\n  Component,\n  provider,\n  plugin,\n};\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/index.js","import uuid from 'uuid/v4';\nimport { addAnnotation } from './annotations';\nimport { cancelSelector, chooseSelector, commitToCurrentDraft, editCurrentDraftSelector } from './selectors';\nimport { applyDefaultsToDraft, getCurrentResourceTemplate } from '../query/resourceQuery';\nimport { getCurrentDraft, getDraftById } from '../query/draftQuery';\nimport { selectorCompat } from '../utility';\nimport { withViewer } from './viewer';\nimport { isSelecting, getCurrentSelector } from '../query/selectorQuery';\n\nexport const DRAFT_CREATE = 'DRAFT_CREATE';\nexport const DRAFT_UPDATE_SELECTOR = 'DRAFT_UPDATE_SELECTOR';\nexport const DRAFT_REMOVE_SELECTOR = 'DRAFT_REMOVE_SELECTOR';\nexport const DRAFT_UPDATE_FIELD_SELECTOR = 'DRAFT_UPDATE_FIELD_SELECTOR';\nexport const DRAFT_REMOVE_FIELD_SELECTOR = 'DRAFT_REMOVE_FIELD_SELECTOR';\nexport const DRAFT_UPDATE_INPUT = 'DRAFT_UPDATE_INPUT';\nexport const DRAFT_SELECT = 'DRAFT_SELECT';\nexport const DRAFT_DESELECT = 'DRAFT_DESELECT';\nexport const DRAFT_PUBLISHING = 'DRAFT_PUBLISHING';\nexport const DRAFT_PUBLISHED = 'DRAFT_PUBLISHED';\nexport const DRAFT_PREVIEW = 'DRAFT_PREVIEW';\nexport const DRAFT_UNPREVIEW = 'DRAFT_UNPREVIEW';\nexport const DRAFT_CONFIRM = 'DRAFT_CONFIRM';\nexport const DRAFT_DISCARD = 'DRAFT_DISCARD';\nexport const DRAFT_IMPORT = 'DRAFT_IMPORT';\n\nexport const DRAFT_LIFECYCLE_NEW = 'DRAFT_LIFECYCLE_NEW';\nexport const DRAFT_LIFECYCLE_CHANGED = 'DRAFT_LIFECYCLE_CHANGED';\nexport const DRAFT_LIFECYCLE_READ = 'DRAFT_LIFECYCLE_READ';\n\nexport function generateDraftId() {\n  return uuid();\n}\n\nexport function createDraft(scope, emptyInput, template, motivation = 'tagging', selectors = null, draftDefaults = null, immutableSelector = null, path = []) {\n  return (dispatch, getState) => {\n    const id = uuid();\n    const input = draftDefaults ? applyDefaultsToDraft(getState(), template, emptyInput, draftDefaults) : emptyInput;\n    // Create draft.\n    dispatch(createDirectDraft(scope, id, input, template, selectors, motivation, path));\n    // And select it straight away.\n    dispatch(selectDraft(scope, id));\n    // Choose the selector attached to the draft.\n    dispatch(chooseDraftSelector(scope, id, immutableSelector));\n  };\n}\n\nexport function chooseDraftSelector(scope, draftId, immutableSelector = null) {\n  return (dispatch, getState) => {\n    const currentTemplate = getCurrentResourceTemplate(getState(), scope);\n    if (currentTemplate) {\n      if (currentTemplate.metaData && currentTemplate.metaData.selector) {\n        dispatch(chooseSelector(currentTemplate.metaData.selector, {\n          template: currentTemplate.id,\n          scope,\n          draft: draftId,\n        }, immutableSelector, null, !!immutableSelector));\n      } else {\n        dispatch(chooseSelector('WholeCanvasSelector', { template: currentTemplate.id, scope, draft: draftId }));\n      }\n    }\n  };\n}\n\nfunction getValidLifecycle(desiredLifecycle, defaultLifecycle) {\n  // desiredLifecycle must be one of these constants.\n  return [\n    DRAFT_LIFECYCLE_CHANGED,\n    DRAFT_LIFECYCLE_NEW,\n    DRAFT_LIFECYCLE_READ,\n  ].indexOf(desiredLifecycle) === -1 ? (\n    // If not, the default lifecycle.\n    defaultLifecycle ?\n      defaultLifecycle :\n      // Defaulting to new.\n      DRAFT_LIFECYCLE_NEW\n    // If its valid, use it.\n  ) : desiredLifecycle;\n}\n\nexport function changeFingerPrintLifecyle({ fingerprint, ...draft }, desiredLifecycle) {\n  const lifecycle = getValidLifecycle(desiredLifecycle, draft.lifecycle);\n\n  return {\n    ...draft,\n    fingerprint: createFingerprint(\n      fingerprint.scope,\n      fingerprint.path,\n      fingerprint.identity,\n      fingerprint.created,\n      lifecycle,\n      fingerprint.source,\n      fingerprint.creator,\n    ),\n  };\n}\n\nexport function changeFingerPrintCreator({ fingerprint, ...draft }, creator) {\n  return {\n    ...draft,\n    fingerprint: createFingerprint(\n      fingerprint.scope,\n      fingerprint.path,\n      fingerprint.identity,\n      fingerprint.created,\n      fingerprint.lifecycle,\n      fingerprint.source,\n      creator,\n    ),\n  };\n}\n\nexport function changeFingerprintSource({ fingerprint, ...draft }, source) {\n  return {\n    ...draft,\n    fingerprint: createFingerprint(\n      fingerprint.scope,\n      fingerprint.path,\n      fingerprint.identity,\n      fingerprint.created,\n      fingerprint.lifecycle,\n      source,\n      fingerprint.creator,\n    ),\n  };\n}\n\nexport function changeFingerprintIdentity({ fingerprint, ...draft }, identity) {\n  return {\n    ...draft,\n    fingerprint: createFingerprint(\n      fingerprint.scope,\n      fingerprint.path,\n      identity,\n      fingerprint.created,\n      fingerprint.lifecycle,\n      fingerprint.source,\n      fingerprint.creator,\n    ),\n  };\n}\n\nexport function createFingerprint(scope, path, identity, created = null, lifecycle = null, source = null, creator = null) {\n  return {\n    scope,\n    path,\n    identity,\n    created: created ? created : (new Date()).toISOString(),\n    lifecycle: lifecycle ? lifecycle : DRAFT_LIFECYCLE_NEW, // DRAFT_LIFECYCLE_NEW | DRAFT_LIFECYCLE_CHANGED\n    source: source ? source : 'memory', // memory | elucidate | localStorage\n    creator: creator ? creator : 'unknown',\n  };\n}\n\nexport function createDirectDraft(scope, id, input, template, selectors = null, motivation = 'tagging', path = [], created = null) {\n  return {\n    type: DRAFT_CREATE,\n    payload: {\n      id,\n      input,\n      template,\n      selectors: selectors ? selectors : input,\n      motivation,\n      fingerprint: createFingerprint(scope, path, null, created, null, null, 'you'),\n    },\n  };\n}\n\nexport function importDraft(id, draft) {\n  return { type: DRAFT_IMPORT, payload: draft };\n}\n\nexport function confirmDraft(scope) {\n  return { type: DRAFT_CONFIRM, payload: { scope } };\n}\n\nexport function deselectDraft(scope) {\n  return { type: DRAFT_DESELECT, payload: { scope } };\n}\n\nexport function discardDraft(scope, id) {\n  return { type: DRAFT_DISCARD, payload: { id, scope } };\n}\n\nexport function discardCurrentDraft(scope) {\n  return (dispatch, getState) => {\n    const currentDraft = getCurrentDraft(getState(), scope);\n    if (currentDraft) {\n      dispatch(discardDraft(scope, currentDraft.id));\n      const selector = getCurrentSelector(getState());\n      // @todo make sure this actually works or change selectors too.\n      if (selector.source && selector.source.template === currentDraft.template) {\n        dispatch(cancelSelector());\n      }\n    }\n  };\n}\n\nexport function removeSelectorFromDraft(id) {\n  return { type: DRAFT_REMOVE_SELECTOR, payload: { id } };\n}\n\nexport function removeSelectorFromCurrentDraft(scope) {\n  return (dispatch, getState) => {\n    const { id } = getCurrentDraft(getState(), scope);\n    if (id) {\n      dispatch(removeSelectorFromDraft(id));\n    }\n  };\n}\n\nexport function markDraftAs(id, whenEqual, changeTo) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const draft = getDraftById(state, id);\n    if (draft.fingerprint.lifecycle === whenEqual) {\n      dispatch(importDraft(draft.id, changeFingerPrintLifecyle(draft, changeTo)));\n    }\n  }\n}\n\nexport function updateDraft(id, fields) {\n  return (dispatch, getState) => {\n    markDraftAs(id, DRAFT_LIFECYCLE_READ, DRAFT_LIFECYCLE_CHANGED)(dispatch, getState);\n    dispatch({ type: DRAFT_UPDATE_INPUT, payload: { id, fields } });\n  }\n}\n\nexport function addSelectorToDraftField(id, selector, fieldId) {\n  return { type: DRAFT_UPDATE_FIELD_SELECTOR, payload: { id, selectors: { [fieldId]: selectorCompat(selector) } } };\n}\n\nexport function editCurrentDraftFieldSelector(scope, fieldId, data) {\n  return (dispatch, getState) => {\n    const currentDraft = getCurrentDraft(getState(), scope);\n    if (!currentDraft) {\n      return;\n    }\n    if (!currentDraft.selectors || !currentDraft.selectors[fieldId]) {\n      return;\n    }\n    const selector = {\n      ...currentDraft.selectors[fieldId],\n      ...data\n    };\n    dispatch(addSelectorToDraftField(currentDraft.id, selector, fieldId));\n  };\n}\n\nexport function addSelectorToDraftFieldFromViewer(id, props, fieldId, done) {\n  return withViewer((Canvas, dispatch) => {\n    const topLeft = Canvas.createRelativePoint(props.x, props.y);\n    const bottomRight = Canvas.createRelativePoint(props.x + props.width, props.y + props.height);\n\n    const selector = selectorCompat({\n      type: props.type,\n      x: topLeft.x,\n      y: topLeft.y,\n      width: bottomRight.x - topLeft.x,\n      height: bottomRight.y - topLeft.y,\n    });\n    dispatch(addSelectorToDraftField(id, selector, fieldId));\n    if (done) {\n      done();\n    }\n  });\n}\n\nexport function removeSelectorFromDraftField(id, fieldId) {\n  return { type: DRAFT_REMOVE_FIELD_SELECTOR, payload: { id, fieldId } };\n}\n\nexport function convertSelectorFromCanvas(Canvas, props) {\n  if (!props.x && !props.y) {\n    return { type: props.type || 'WholeCanvasSelector' };\n  }\n  const topLeft = Canvas.createRelativePoint(props.x, props.y);\n  if (props.type !== 'boxSelector' && props.type !== 'madoc:boxdraw') {\n    return selectorCompat({\n      type: props.type,\n      x: topLeft.x,\n      y: topLeft.y,\n    });\n  }\n\n  const bottomRight = Canvas.createRelativePoint(props.x + props.width, props.y + props.height);\n  return selectorCompat({\n    type: props.type,\n    x: topLeft.x,\n    y: topLeft.y,\n    width: bottomRight.x - topLeft.x,\n    height: bottomRight.y - topLeft.y,\n  });\n}\n\nexport function addSelectorToDraftFromViewer(id, props, done) {\n  return withViewer((Canvas, dispatch) => {\n    const selector = convertSelectorFromCanvas(Canvas, props);\n\n    dispatch(addSelectorToDraft(id, selector));\n    if (done) {\n      done();\n    }\n  });\n}\n\nexport function addSelectorToDraft(id, selector) {\n  return (dispatch, getState) => {\n    markDraftAs(id, DRAFT_LIFECYCLE_READ, DRAFT_LIFECYCLE_CHANGED)(dispatch, getState);\n    dispatch({ type: DRAFT_UPDATE_SELECTOR, payload: { id, selector: selectorCompat(selector) } });\n  }\n}\n\nexport function selectDraft(scope, id) {\n  return (dispatch, getState) => {\n    markDraftAs(id, DRAFT_LIFECYCLE_NEW, DRAFT_LIFECYCLE_READ)(dispatch, getState);\n    dispatch({ type: DRAFT_SELECT, payload: { id, scope } });\n  }\n}\n\nexport function previewDraft(id) {\n  return (dispatch, getState) => {\n    const state = getState();\n    if (isSelecting(state)) {\n      dispatch(commitToCurrentDraft(\n        true,\n        /* state.selector.currentSelector.type.toLowerCase() === 'wholecanvasselector', */\n      ));\n    }\n    dispatch({ type: DRAFT_PREVIEW, payload: { id } });\n  };\n}\n\nexport function unpreviewDraft(scope, id, editSelector = false) {\n  return (dispatch, getState) => {\n    dispatch({ type: DRAFT_UNPREVIEW, payload: { id } });\n    if (editSelector) {\n      const state = getState();\n      const currentDraft = getCurrentDraft(state, scope);\n      if (\n        currentDraft.id === id &&\n        currentDraft.selector &&\n        currentDraft.selector.type &&\n        currentDraft.selector.type.toLowerCase() !== 'wholecanvasselector'\n      ) {\n        dispatch(editCurrentDraftSelector(scope));\n      }\n    }\n  };\n}\n\nexport function asyncPublishDraft(scope, id, promise) {\n  return (dispatch) => {\n    dispatch({ type: DRAFT_PUBLISHING, payload: { id } });\n    return promise.then((result) => {\n      dispatch(publishDraft(scope, id));\n      return result;\n    });\n  };\n}\n\nexport function publishDraft(scope, id) {\n  return (dispatch, getState) => {\n    markDraftAs(id, DRAFT_LIFECYCLE_CHANGED, DRAFT_LIFECYCLE_NEW)(dispatch, getState);\n    dispatch(addAnnotation(getState().drafts.list[id]));\n    dispatch({ type: DRAFT_PUBLISHED, payload: { id, scope } });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/drafts.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport ResourceEditor from './resourceEditor';\n\nclass ResourceEditorProvider extends PureComponent {\n\n  render() {\n    const {store, ...props} = this.props;\n    return (\n      <Provider store={store}>\n        <ResourceEditor {...props} />\n      </Provider>\n    );\n  }\n}\n\nexport default ResourceEditorProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/resourceEditor.provider.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport Transcriber from './transcriber';\n\nclass TranscriberProvider extends PureComponent {\n\n  render() {\n    const {store, ...props} = this.props;\n    return (\n      <Provider store={store}>\n        <Transcriber {...props} />\n      </Provider>\n    );\n  }\n}\n\nexport default TranscriberProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-transcriber/src/transcriber.provider.js","import React, {PureComponent} from 'react';\nimport ResourceEditor from 'digirati-annotation-plugin-resource-editor/es/resourceEditor';\nimport {connector} from 'digirati-annotation-redux';\nimport {createDraftFromCaptureModel} from 'digirati-annotation-bridge';\nimport BEM from 'digirati-bem-js';\n\nconst $style = BEM.block('transcriber');\n\nclass Transcriber extends PureComponent {\n\n  createDraft = (draftDefaults) => () => {\n    const {createDraftFromCaptureModel, tree} = this.props;\n    createDraftFromCaptureModel(tree, tree, draftDefaults);\n  };\n\n  render() {\n    const { transcriptionVocab = 'dcterms:description', currentDraft, transcriptionLabel, transcription, ...props } = this.props;\n    if (!currentDraft) {\n      return (\n        <div className={$style}>\n          <button className={$style.element('edit')} onClick={this.createDraft({ [transcriptionVocab]: transcription })}>{ transcriptionLabel ? transcriptionLabel : 'edit' }</button>\n          <div className={$style.element('transcription')}>\n            { transcription }\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className={$style.modifier('editing')}>\n        <ResourceEditor draftDefaults={{ [transcriptionVocab]: transcription }} hideTitle={true} {...props}/>\n      </div>\n    );\n  }\n}\n\nexport default connector(Transcriber, {createDraftFromCaptureModel});\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-transcriber/src/transcriber.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport Drafts from './drafts';\n\nclass DraftsProvider extends PureComponent {\n\n  render() {\n    const {store, ...props} = this.props;\n    return (\n      <Provider store={store}>\n        <Drafts {...props} />\n      </Provider>\n    );\n  }\n}\n\nexport default DraftsProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-drafts/src/drafts.provider.js","import React, { PureComponent } from 'react';\nimport { connector } from 'digirati-annotation-redux';\nimport { ActionTimeAgo } from 'digirati-annotation-components';\nimport ComboButton from 'digirati-annotation-components/es/components/inputs/ComboButton';\nimport {currentImageService} from 'digirati-annotation-redux/es/query/manifestQuery';\nimport { getAnnotationBody } from 'digirati-annotation-bridge/es/annotations';\nimport BEM from 'digirati-bem-js';\nimport './drafts.scss';\n\nfunction getImageFromTarget(state, draft, size) {\n  const imageService = currentImageService(state);\n  if (imageService) {\n    const prefix = imageService.split('info.json')[0];\n    if (!draft || !draft.selector) {\n      return null;\n    }\n    if (draft.selector.type.toLowerCase() === 'wholecanvasselector') {\n      return `${prefix}full/${size},/0/default.jpg`;\n    }\n    return `${prefix}${draft.selector.x},${draft.selector.y},${draft.selector.width || size},${draft.selector.height || size}/${size},/0/default.jpg`;\n  }\n  return null;\n}\n\nconst $style = BEM.block('drafts-list');\nclass Drafts extends PureComponent {\n\n  getUserName(draft) {\n    return draft.fingerprint.creator || 'unknown';\n  }\n\n  render() {\n    const {\n      state, \n      label, \n      description, \n      drafts, \n      selectScopedDraft, \n      currentDrafts, \n      moveForward, \n      reset, \n      filterBy, \n      emptyState, \n      hideIfEmpty, \n      showThumbnail = false,\n      thumbnailSize = 150\n    } = this.props;\n    const draftList = drafts ? Object.values(drafts) : [];\n    const filterByMultiple = filterBy.split(',');\n    const filteredDraftLIst = draftList.length ? draftList.filter(draft => {\n      return !(filterByMultiple && filterByMultiple.indexOf(draft.fingerprint.source) === -1);\n    }) : [];\n    if (filteredDraftLIst.length === 0 && hideIfEmpty) {\n      return null;\n    }\n\n    return (\n      <div className={$style}>\n        { label ? (\n          <h3 className={$style.element('label')}>{label}</h3>\n        ) : null }\n        { description ? (\n          <p className={$style.element('description')}>{ description }</p>\n        ) : null }\n        <ul className={$style.element('list').modifiers({ hasThumbnail: showThumbnail, [`thumbnail-${thumbnailSize}`]: showThumbnail })}>\n          { filteredDraftLIst.length ? filteredDraftLIst.map(draft => {\n            const thumbnail = showThumbnail && getImageFromTarget(state, \n              draft, 40);\n\n            return <li className={$style.element('list-item').modifier({\n              'selected': (currentDrafts && draft.fingerprint && draft.fingerprint.scope && currentDrafts[draft.fingerprint.scope] === draft.id)\n            })} key={draft.id} onClick={() => {\n              // moveForward(draft.selector.source.scope);\n              if (draft.fingerprint && draft.fingerprint.scope && draft.fingerprint.path) {\n                if (draft.fingerprint.path.length) {\n                  reset(draft.fingerprint.scope);\n                  draft.fingerprint.path.forEach(forward => moveForward(draft.fingerprint.scope, forward));\n                }\n                selectScopedDraft(draft.fingerprint.scope, draft.id);\n              }\n            }}>\n              { showThumbnail && thumbnail ? (\n                <div className={$style.element('thumbnail')}>\n                  <img src={getImageFromTarget(state, draft, thumbnailSize)} />\n                </div>\n              ) : null }\n              <ActionTimeAgo verb=\"Created\" subject={ this.getUserName(draft) } time={draft.fingerprint.created}/>\n              { draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED' ? (\n                <span className={$style.element('unsaved')}>unsaved changes</span>\n              ) : null }\n            </li>\n          }) : (\n            <div className={$style.element('empty-state')}>\n              {emptyState ? emptyState : 'Any annotations you mark as in progress will show here'}\n            </div>\n          ) }\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default connector(Drafts);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-drafts/src/drafts.js","import React, {Component} from 'react';\nimport {connector} from 'digirati-annotation-redux';\nimport {isTaggedAs, annotationToTag, tagDetails} from './tagging.utils';\n\nexport class TaggingAnnotations extends Component {\n\n    render() {\n        const {entityTypes, ...props} = this.props;\n\n        let annotations = props.regionAnnotations.concat(props.wholeCanvasAnnotations)\n            .filter(isTaggedAs(entityTypes))\n            .sort((a, b) => {\n                let source = tagDetails(a).uri;\n                let target = tagDetails(b).uri;\n\n                return source.localeCompare(target);\n            })\n            .reduce((output, next) => {\n                let slice = output.slice(-1);\n                let prev = slice[0];\n\n                if (prev) {\n                    let prevUri = tagDetails(prev).uri;\n                    let nextUri = tagDetails(next).uri;\n\n                    if (prevUri !== nextUri) {\n                        output.push(next);\n                    }\n                } else {\n                    output.push(next);\n                }\n\n                return output;\n            }, []);\n\n        return ((\n            <div>\n                {annotations.map(annotationToTag)}\n            </div>\n        ))\n    }\n}\n\nexport default connector(TaggingAnnotations);\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging-annotations.component.js","import React, {PureComponent} from 'react';\nimport {Provider} from 'react-redux';\nimport TaggingAnnotations from './tagging-annotations.component';\n\nclass TaggingAnnotationsProvider extends PureComponent {\n\n    render() {\n        const {store, ...props} = this.props;\n        return (\n            <Provider store={store}>\n                <TaggingAnnotations {...props} />\n            </Provider>\n        );\n    }\n}\n\nexport default TaggingAnnotationsProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging-annotations.provider.js","import React, { Component } from 'react';\nimport { connector } from 'digirati-annotation-redux';\nimport { Component as ResourceEditor } from 'digirati-annotation-plugin-resource-editor';\nimport { createDraftFromCaptureModel } from 'digirati-annotation-bridge';\n\nclass Tagging extends Component {\n\n  state = {\n    isAdding: false,\n  };\n\n  handleAdd = () => {\n    const { createDraftFromCaptureModel, tree } = this.props;\n    createDraftFromCaptureModel(tree, tree, {});\n\n    this.setState({\n      isAdding: true,\n    });\n  };\n\n  render() {\n    const { currentDraft, content, ...props } = this.props;\n    const hasDraft = !!currentDraft;\n\n    if (!currentDraft) {\n      return ((\n        <div>\n          <button className=\"c-tag\" disabled={hasDraft}\n                  type=\"submit\" onClick={this.handleAdd}>{content}\n          </button>\n        </div>\n      ));\n    }\n\n    return ((\n      <div>\n        <ResourceEditor {...props} hideTitle={true} />\n\n      </div>\n    ));\n  }\n}\nexport default connector(Tagging, { createDraftFromCaptureModel });\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging.js","import React, { PureComponent } from 'react';\nimport { Provider } from 'react-redux';\nimport Tagging from './tagging';\n\nclass TaggingProvider extends PureComponent {\n\n  render() {\n    const { store, ...props } = this.props;\n    return (\n      <Provider store={store}>\n        <Tagging {...props} />\n      </Provider>\n    );\n  }\n}\n\nexport default TaggingProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging.provider.js","import React from 'react';\nimport { render } from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './css/style.scss';\nimport './css/base.scss';\nimport './css/grid.scss';\nimport './css/image-grid.scss';\nimport './css/collection-list.scss';\nimport './css/collection-item.scss';\nimport './css/topic-list.scss';\nimport './css/prev-next.scss';\nimport './css/pagination.scss';\n\nimport CorePlugin, {utils} from 'digirati-annotation-plugin-core';\nimport ViewerPlugin from 'digirati-annotation-plugin-viewer';\nimport ResourceEditorPlugin from 'digirati-annotation-plugin-resource-editor';\nimport TranscriberPlugin from 'digirati-annotation-plugin-transcriber';\nimport DraftsPlugin from 'digirati-annotation-plugin-drafts';\nimport {TaggingAnnotationsPlugin, TaggingPlugin} from 'digirati-annotation-plugin-tagging';\nimport RegionAnnotation from './js/region-annotations';\n\nif (process.env.NODE_ENV !== 'production') {\n  const {whyDidYouUpdate} = require('why-did-you-update');\n  let createClass = React.createClass;\n  Object.defineProperty(React, 'createClass', {\n    set: (nextCreateClass) => {\n      createClass = nextCreateClass;\n    }\n  });\n  // whyDidYouUpdate(React, { exclude: /^Core|Measure/ })\n}\n\nconst behaviours = resolveSharedStore => ({\n  'annotation-studio-core': (image, attributes) => CorePlugin(image, attributes).then(store => resolveSharedStore(store)),\n  'annotation-studio-viewer': ViewerPlugin,\n  'annotation-studio-resource-editor': ResourceEditorPlugin,\n  'annotation-studio-transcriber': TranscriberPlugin,\n  'annotation-studio-drafts': DraftsPlugin,\n  'annotation-studio-region-annotations': ($el, attributes, store) => {\n    return render((\n      <Provider store={store}>\n        <RegionAnnotation />\n      </Provider>\n    ), $el);\n  },\n  'annotation-studio-tagging-annotations': TaggingAnnotationsPlugin,\n  'annotation-studio-tagging': TaggingPlugin\n});\n\nconst { resolve, promise: whenToRender } = utils.deferred();\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // Small error-prone example of data behaviour factory.\n  for (const $el of document.querySelectorAll('[data-behaviour]')) {\n    const register = behaviours(resolve);\n    try {\n      const attribute = $el.getAttribute('data-behaviour');\n      const behaviour = register[attribute];\n      if (behaviour.length === 3) {\n        whenToRender.then(store => behaviour($el, utils.getAttributes($el), store));\n      } else {\n        register[$el.getAttribute('data-behaviour')]($el, utils.getAttributes($el));\n      }\n    } catch (e) {\n      console.error('Behaviour does not exist: ' + $el.getAttribute('data-behaviour'), e);\n    }\n  }\n});\n\nexport default {};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-application/src/index.js","import { getCurrentResourceTemplate, getForm, getResourceById } from 'digirati-annotation-redux/es/query/resourceQuery';\nimport { getCurrentDraft } from 'digirati-annotation-redux/es/query/draftQuery';\nimport { importResource, importResourceTree } from 'digirati-annotation-redux/es/actions/resources';\n\nimport {\n  createDraftFromAnnotation,\n  mapAnnotationBody,\n  mapTarget,\n  parseTarget,\n  resourceTemplateReverseTypeLookup\n} from './annotations';\n\nimport { motivationFromForm } from './helpers';\nimport Choice from './model/Choice';\nimport CaptureModel from './model/CaptureModel';\nimport { createDraft } from 'digirati-annotation-redux/es/actions/drafts';\n\n/**\n * @deprecated\n */\nexport function mapDraftToDataSet(fields, values) {\n  const contexts = {};\n  const body = {};\n\n  fields.forEach(model => {\n    if (model.metaData.conformsTo && values[model.id]) {\n      contexts[model.metaData.conformsTo.label] = model.metaData.conformsTo.id;\n      body[model.metaData.conformsTo.label] = values[model.id];\n    }\n  });\n\n  return {\n    '@context': contexts,\n    ...body\n  };\n}\n\n/**\n * @deprecated\n */\nfunction getLabelFromResourceTemplate(template, data) {\n  if (!(\n      template.metaData.labelParts &&\n      template.metaData.labelParts.label\n    )) {\n    return null;\n  }\n  const labelField = template.metaData.labelParts.label;\n\n  return data[labelField] ? data[labelField] : null;\n}\n\n/**\n * @deprecated\n */\nexport function dataSetToAnnotation(template, dataset) {\n  const body = {\n    type: ['TextualBody', 'Dataset'],\n    value: JSON.stringify(dataset),\n    format: 'text/plain',\n  };\n  const label = getLabelFromResourceTemplate(template, dataset);\n\n  return { body, label };\n}\n\nexport function dataSetToSingleAnnotation(template, dataset) {\n  const { metaData: { title, description } } = template;\n\n  dataset.context = dataset.context ? dataset.context : {};\n  if (title) {\n    dataset.context.Title = 'http://dublincore.org/documents/dcmi-terms/#terms-title';\n    dataset.Title = title;\n  }\n  if (description) {\n    dataset.context.Description = 'http://dublincore.org/documents/dcmi-terms/#terms-description';\n    dataset.Description = description;\n  }\n\n  const body = {\n    type: ['TextualBody', 'Dataset'],\n    value: JSON.stringify(dataset),\n    format: 'text/plain',\n  };\n\n\n  return { body, label: title };\n}\n\n/**\n * @deprecated\n */\nexport function getIndividualW3CAnnotationBodies(state, scope) {\n  const currentDraft = getCurrentDraft(state, scope);\n  const resourceTemplate = getCurrentResourceTemplate(state, scope);\n  const fields = Object.values(getForm(resourceTemplate).fields);\n\n  const selectors = Object.keys(currentDraft.selectors || {})\n    .map(key => ({ id: key, value: currentDraft.selectors[key] }))\n    .map(selector => {\n      const capModel = fields.find(model => model.id === selector.id);\n      return {\n        id: selector.id,\n        annotation: dataSetToSingleAnnotation(\n          capModel,\n          mapDraftToDataSet(fields, { [selector.id]: currentDraft.input[selector.id] }),\n        ),\n      }\n    });\n  const keyedSelectors = {};\n  for (let selector of selectors) {\n    keyedSelectors[selector.id] = selector.annotation;\n  }\n\n  return keyedSelectors;\n}\n\nexport function getW3CAnnotationBody(state, scope) {\n  const currentDraft = getCurrentDraft(state, scope);\n  const resourceTemplate = getCurrentResourceTemplate(state, scope);\n  const fields = Object.values(getForm(resourceTemplate).fields);\n\n  return dataSetToAnnotation(\n    resourceTemplate,\n    mapDraftToDataSet(fields, currentDraft.input),\n  );\n}\n\n\nexport function createDraftFromCaptureModel(scope, captureModelId, draftDefaults = {}, defaultMotivation = 'tagging', path = []) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const { resources, motivation, selectors } = getDraftFromCaptureModel(\n      getResourceById(state, captureModelId),\n    );\n    dispatch(\n      createDraft(scope, resources, captureModelId, motivation || defaultMotivation, selectors, draftDefaults, null, path)\n    );\n  }\n}\n\nexport function getDraftFromCaptureModel(template) {\n  return {\n    motivation: motivationFromForm(\n      (template && template.metaData && template.metaData.motivatedBy) ? template.metaData.motivatedBy : {\n        id: 'oa:tagging',\n        label: 'Tagging',\n      },\n    ),\n    resources: getDraftTemplateFromCaptureModel(template),\n    selectors: getDraftSelectorsFromCaptureModel(template),\n  }\n}\n\nexport function getDraftTemplateFromCaptureModel(template) {\n  const resources = template.fields;\n  return Object.keys(resources).reduce((obj, key) => {\n    obj[resources[key].id] = null;\n    return obj;\n  }, {});\n}\n\nexport function getDraftSelectorsFromCaptureModel(template) {\n  const resources = template.fields;\n  return Object.keys(resources).reduce((obj, key) => {\n    obj[resources[key].id] = {\n      type: resources[key].metaData.selector,\n      ...resources[key].metaData.selectorValue\n    };\n    return obj;\n  }, {});\n}\n\nexport function constructUnknownTemplate(resourceTemplate) {\n  if (Choice.is(resourceTemplate)) {\n    return Choice.fromJsonLD(resourceTemplate);\n  }\n  if (CaptureModel.is(resourceTemplate)) {\n    return CaptureModel.fromJsonLD(resourceTemplate);\n  }\n}\n\nexport function importResourceTemplate(resourceTemplate, target = 'canvas') {\n  return (dispatch) => {\n    const tree = constructUnknownTemplate(resourceTemplate);\n\n    if (!tree) {\n      return;\n    }\n    if (tree instanceof CaptureModel) {\n      return dispatch(importResource(tree));\n    }\n\n    dispatch(importResourceTree(tree.getTree(target)));\n\n    tree\n      .flatten()\n      .forEach(r => dispatch(importResource(r)));\n  }\n}\n\n\nexport {\n  createDraftFromAnnotation,\n  mapAnnotationBody,\n  mapTarget,\n  parseTarget,\n  resourceTemplateReverseTypeLookup,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/index.js","import plugin from './core.plugin';\nimport provider from './core.provider';\nimport * as utils from './core.utils';\nimport Component from './core';\n\nexport {\n  Component,\n  provider,\n  utils,\n  plugin,\n};\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-core/src/index.js","export function getCurrentDraftId(state, scope) {\n  return state.drafts.currentDrafts[scope];\n}\n\nexport function getCurrentDrafts(state) {\n  return Object.values(state.drafts.currentDrafts);\n}\n\nexport function getDraftById(state, id) {\n  return state.drafts.list[id];\n}\n\nexport function getCurrentDraft(state, scope) {\n  return getDraftById(state, getCurrentDraftId(state, scope));\n}\n\nexport function getAllDraftsWithSelectors(state) {\n  return getDraftsWithSelectors(state.drafts.list);\n}\n\nexport function getDraftsByFingerprintIdentity(state) {\n  return (id, identity) => {\n    const drafts = state.drafts.list;\n    return Object.values(drafts).reduce((state, draft) => {\n      if (state) return state;\n      if (draft.id !== id && draft.fingerprint.identity === identity) {\n        return draft;\n      }\n    }, null);\n  };\n}\n\nexport function getDraftsWithSelectors(drafts) {\n  return Object.keys(drafts)\n  .filter(k => drafts[k] && drafts[k].selector)\n  .map(k => drafts[k]);\n}\n\nexport function currentDraftEditableRegions(state) {\n  const currentDrafts = getCurrentDrafts(state);\n  if (!currentDrafts) {\n    return [];\n  }\n  return editableRegionsFromDraftList(state.drafts.list, currentDrafts);\n}\n\n// @todo to revise.\nexport function mapDraftSelectorToRegion(draft, currentDraftKeys, onClickRegion, currentSelectorExists) {\n  const selector = draft.selector;\n  const keysAsString = currentDraftKeys.map(e => `${e}`);\n  return {\n    id: draft.id,\n    onClick: () => onClickRegion(draft.id),\n    selected: keysAsString.indexOf(`${draft.id}`) !== -1,\n    editing: keysAsString.indexOf(`${draft.id}`) !== -1 && currentSelectorExists,\n    immutable: false,\n    ...selector\n  };\n}\n\nexport function editableRegionsFromDraftList(\n  drafts,\n  currentDraftKeys = [],\n  onClickRegion = () => null,\n  currentSelectorExists = true,\n) {\n  return getDraftsWithSelectors(drafts).map(draft => mapDraftSelectorToRegion(\n    draft,\n    currentDraftKeys,\n    onClickRegion,\n    currentSelectorExists,\n  ));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/draftQuery.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./style.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./style.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./style.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/style.scss\n// module id = 552\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiif-integration p {\\n  line-height: 1.25em;\\n  margin-bottom: 1rem; }\\n\\n.iiif-integration-spec {\\n  font-style: italic;\\n  padding: 1em 2em;\\n  border: 1px dotted grey;\\n  margin-bottom: 10px; }\\n\\n.iiif-integration-spec__list li {\\n  line-height: 1.75em; }\\n\\n.iiif-integration-description {\\n  font-size: 1.25rem; }\\n\\n.iiif-integration-admin {\\n  padding: 10px;\\n  background-color: #ffc; }\\n\\n.iiif-integration__row {\\n  display: block;\\n  clear: both; }\\n\\n.iiif-integration__image--large {\\n  width: 100%;\\n  height: 200px;\\n  background-color: #999; }\\n\\n.iiif-integration__image--small {\\n  display: block;\\n  float: left;\\n  width: 12.5%;\\n  margin: 2%;\\n  height: 180px;\\n  margin-bottom: 20px;\\n  background-color: #999; }\\n\\n.iiif-integration-places {\\n  display: block;\\n  float: left;\\n  width: 31.3%;\\n  margin: 0 1%; }\\n\\n.iiif-integration-places__list {\\n  padding: 0 1em; }\\n\\n.iiif-integration-places__list li {\\n  line-height: 1.75em; }\\n\\n.iiif-integration-schools {\\n  display: block;\\n  float: left;\\n  width: 31.3%;\\n  margin: 0 1%; }\\n\\n.iiif-integration-schools__list {\\n  padding: 0 1em; }\\n\\n.iiif-integration-schools__list li {\\n  line-height: 1.75em; }\\n\\n.iiif-integration-organisations {\\n  display: block;\\n  float: left;\\n  width: 31.3%;\\n  margin: 0 1%; }\\n\\n.iiif-integration-organisations__list {\\n  padding: 0 1em; }\\n\\n.iiif-integration-organisations__list li {\\n  line-height: 1.75em; }\\n\\n.iiif-integration-collection {\\n  display: block;\\n  float: left;\\n  width: 46%;\\n  margin: 0 2%;\\n  height: 300px; }\\n\\n#iiif-integration-canvas-image {\\n  width: 100%;\\n  height: 750px; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/style.scss\n// module id = 553\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./base.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./base.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./base.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/base.scss\n// module id = 555\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"body.minimal {\\n  width: 95% !important;\\n  margin: 30px 0 !important;\\n  margin-left: auto !important;\\n  margin-right: auto !important; }\\n\\nbody.minimal div[role=\\\"main\\\"] {\\n  padding: 5% !important; }\\n\\n.osd-viewer__region-item {\\n  box-shadow: 0 0 4px 2px rgba(0, 0, 0, 0.4); }\\n\\n[data-selector-type=\\\"WholeCanvasSelector\\\"] .osd-viewer__region-item {\\n  display: none; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/base.scss\n// module id = 556\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./grid.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./grid.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./grid.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/grid.scss\n// module id = 557\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-grid {\\n  display: block;\\n  box-sizing: border-box; }\\n  .iiifi-grid > div ~ div {\\n    padding-left: 20px; }\\n  .iiifi-grid__third {\\n    float: left;\\n    width: 33.333333%; }\\n  .iiifi-grid__two-thirds {\\n    float: left;\\n    width: 66.666666%; }\\n  .iiifi-grid:after, .iiifi-grid:before {\\n    content: '';\\n    display: table;\\n    clear: both; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/grid.scss\n// module id = 558\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./image-grid.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./image-grid.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./image-grid.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/image-grid.scss\n// module id = 559\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-image-grid__item {\\n  display: inline-block;\\n  vertical-align: middle;\\n  transform: perspective(1px) translateZ(0);\\n  box-shadow: 0 0 1px transparent;\\n  transition-duration: 0.3s;\\n  transition-property: transform;\\n  width: 180px;\\n  height: 190px;\\n  float: left;\\n  white-space: nowrap;\\n  display: block;\\n  padding: 20px 10px;\\n  margin: 10px;\\n  background-color: #535353;\\n  text-align: center; }\\n  .iiifi-image-grid__item:hover, .iiifi-image-grid__item:focus, .iiifi-image-grid__item:active {\\n    transform: scale(1.02); }\\n  .iiifi-image-grid__item:before {\\n    content: '';\\n    display: inline-block;\\n    height: 100%;\\n    vertical-align: middle;\\n    margin-right: -0.25em;\\n    /* Adjusts for spacing */ }\\n  .iiifi-image-grid__item:hover {\\n    background-color: #2f2f2f; }\\n\\n.iiifi-image-grid__image {\\n  display: inline-block;\\n  vertical-align: middle; }\\n\\n.iiifi-image-grid:after, .iiifi-image-grid:before {\\n  content: '';\\n  display: table;\\n  clear: both; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/image-grid.scss\n// module id = 560\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-list.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-list.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-list.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/collection-list.scss\n// module id = 561\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-collection-list {\\n  width: 100%; }\\n  .iiifi-collection-list ul {\\n    padding: 0;\\n    margin: 0 -10px; }\\n  .iiifi-collection-list__item {\\n    margin: 0;\\n    list-style-type: none;\\n    float: left;\\n    width: 50%;\\n    padding: 5px 10px; }\\n  .iiifi-collection-list__item-inline {\\n    padding: 5px 15px;\\n    list-style-type: none; }\\n  .iiifi-collection-list:after, .iiifi-collection-list:before {\\n    content: '';\\n    display: table;\\n    clear: both; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/collection-list.scss\n// module id = 562\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-item.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-item.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./collection-item.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/collection-item.scss\n// module id = 563\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-collection-item {\\n  margin-bottom: 20px; }\\n  .iiifi-collection-item__image-container {\\n    width: 100%; }\\n  .iiifi-collection-item__image {\\n    max-width: 100%; }\\n  .iiifi-collection-item__caption {\\n    padding: 10px; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/collection-item.scss\n// module id = 564\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./topic-list.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./topic-list.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./topic-list.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/topic-list.scss\n// module id = 565\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-topic-list ul {\\n  padding: 0;\\n  margin: 0 0 1.4em; }\\n\\n.iiifi-topic-list__item {\\n  list-style-type: none; }\\n\\n.iiifi-topic-list--inline {\\n  display: inline; }\\n  .iiifi-topic-list--inline ul {\\n    display: inline; }\\n  .iiifi-topic-list--inline .iiifi-topic-list__item {\\n    display: inline; }\\n    .iiifi-topic-list--inline .iiifi-topic-list__item ~ .iiifi-topic-list__item:before {\\n      content: ', ';\\n      width: 0.4em;\\n      display: inline-block; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/topic-list.scss\n// module id = 566\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./prev-next.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./prev-next.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./prev-next.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/prev-next.scss\n// module id = 567\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-prev-next ul {\\n  padding: 0; }\\n\\n.iiifi-prev-next__item {\\n  display: inline-block;\\n  list-style: none;\\n  float: left;\\n  width: 200px; }\\n  .iiifi-prev-next__item a {\\n    padding: 10px;\\n    display: block;\\n    background: #f1f1f1;\\n    text-align: center;\\n    margin: 0 0 30px; }\\n  .iiifi-prev-next__item--next {\\n    text-align: right;\\n    float: right; }\\n\\n.iiifi-prev-next:after, .iiifi-prev-next:before {\\n  content: '';\\n  display: table;\\n  clear: both; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/prev-next.scss\n// module id = 568\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./pagination.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./pagination.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./pagination.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-application/src/css/pagination.scss\n// module id = 569\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".iiifi-pagination__item {\\n  display: inline-block;\\n  list-style: none; }\\n  .iiifi-pagination__item a {\\n    display: block;\\n    border: 1px solid #ccc;\\n    padding: 5px 10px;\\n    margin: 5px 3px;\\n    width: 3em;\\n    text-align: center; }\\n    .iiifi-pagination__item a.active {\\n      border-color: #afafaf;\\n      background-color: #f1f1f1; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-application/src/css/pagination.scss\n// module id = 570\n// module chunks = 0","import React from 'react';\nimport {render} from 'react-dom';\nimport {createStore, reducers} from 'digirati-annotation-redux';\nimport {unknownPropertyWarning} from './core.utils';\nimport CoreProvider from './core.provider';\nimport localstorage from 'store';\nimport moment from 'moment';\n\nexport default function CorePlugin($el, {\n  manifest,\n  canvas,\n  elucidateServer,\n  locale,\n  ...unknownProps\n}) {\n  unknownPropertyWarning(unknownProps);\n\n  if (locale) {\n    moment.locale(locale);\n  }\n\n  const url = window.location.href;\n  const savedDraftList = localstorage.get(`annotation-studio/${url}`) || {};\n\n  const store = createStore(reducers);\n  render(\n    <CoreProvider\n      store={store}\n      manifest={manifest}\n      savedDraftList={savedDraftList}\n      elucidateServer={elucidateServer}\n      canvas={canvas}\n    />\n    , $el);\n\n  return Promise.resolve(store);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-core/src/core.plugin.js","import * as logging from './logging';\nimport * as annotations from './annotations';\nimport * as selectors from './selectors';\nimport * as drafts from './drafts';\nimport * as resources from './resources';\nimport * as elucidate from './elucidate';\nimport * as manifest from './manifest';\nimport * as viewer from './viewer';\nimport * as help from './help';\n\nexport { logging, annotations, selectors, drafts, resources, elucidate, manifest, viewer, help };\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/index.js","export class AnnotationSelector {\n\n  static DIRECTION_LTR = 'ltr';\n  static DIRECTION_RTL = 'rtl';\n  static DIRECTION_AUTO = 'auto';\n  static W3C_SELECTOR = /[#&\\?]xywh\\=(pixel\\:|percent\\:)?(\\d+),(\\d+),(\\d+),(\\d+)/;\n\n  static fromArray(multipleSelectors) {\n    return multipleSelectors.map(\n      annotation => AnnotationSelector.parse(annotation),\n    );\n  }\n\n  constructor(id, scale, format, language, processingLanguage, textDirection, selector) {\n    if (!id) {\n      throw new Error('ID is required in selector');\n    }\n    if (\n      textDirection && (\n        textDirection !== AnnotationSelector.DIRECTION_AUTO &&\n        textDirection !== AnnotationSelector.DIRECTION_LTR &&\n        textDirection !== AnnotationSelector.DIRECTION_RTL\n      )\n    ) {\n      throw new Error('textDirection must be ONE of [ltr, rtl, auto]');\n    }\n\n    this.id = id;\n    this.format = format;\n    this.language = language;\n    this.processingLanguage = processingLanguage;\n    this.textDirection = textDirection;\n    this.target = AnnotationSelector.parseTarget(id, scale, selector);\n  }\n\n\n  static parse(text, scale = 1) {\n    if (!text) {\n      return null;\n    }\n\n    // https://www.w3.org/TR/annotation-model/#bodies-and-targets\n    if (text.id) {\n      return new AnnotationSelector(\n        text.id,\n        scale,\n        text.format,\n        text.language,\n        text.processingLanguage,\n        text.textDirection,\n      )\n    }\n\n    // https://www.w3.org/TR/annotation-model/#selectors\n    if (text.source) {\n      return new AnnotationSelector(\n        text.source,\n        scale,\n        text.format,\n        text.language,\n        text.processingLanguage,\n        text.textDirection,\n        text.selector,\n      );\n    }\n\n    // @todo check for is text or is object and construct accordingly.\n    return new AnnotationSelector(text, scale);\n  }\n\n  static parseTarget(source, scale = 1, selector = null) {\n    let toParse = source;\n    if (selector && selector.type === 'FragmentSelector') {\n      toParse = `${source}#${selector.value}`;\n    }\n\n    const match = AnnotationSelector.W3C_SELECTOR.exec(toParse);\n    if (match) {\n      return {\n        unit: (match[1] === 'percent:' ? 'percent' : 'pixel'),\n        scale,\n        expanded: true,\n        x: parseInt(match[2], 10) * scale,\n        y: parseInt(match[3], 10) * scale,\n        width: parseInt(match[4], 10) * scale,\n        height: parseInt(match[5], 10) * scale,\n        toString() {\n          // @todo maybe something else?\n          return source.split('#')[0];\n        },\n      };\n    }\n    return source;\n  }\n\n  toString() {\n    return this.id;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/elucidate/AnnotationSelector.js","export * from './draftQuery';\nexport * from './resourceQuery';\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/query/index.js","import logging from './loggingReducer';\nimport drafts from './draftReducer';\nimport annotations from './annotationReducer';\nimport selector from './selectorReducer';\nimport elucidate from './elucidateReducer';\nimport manifest from './manifestReducer';\nimport resource from './resourceReducer';\nimport help from './helpReducer';\n\nexport default {\n  logging,\n  drafts,\n  resource,\n  annotations,\n  selector,\n  elucidate,\n  manifest,\n  help,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/index.js","import { LOGGING_LOG } from '../actions/logging';\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  messages: [],\n};\n\nexport default function loggingReducer(state = defaultState, action) {\n  if (action.type === LOGGING_LOG) {\n    return update(state, {\n      messages: { $push: [action.payload.message] },\n    });\n  }\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/loggingReducer.js","import {\n  DRAFT_CONFIRM,\n  DRAFT_CREATE,\n  DRAFT_DESELECT,\n  DRAFT_DISCARD,\n  DRAFT_PREVIEW,\n  DRAFT_PUBLISHED,\n  DRAFT_PUBLISHING,\n  DRAFT_REMOVE_SELECTOR,\n  DRAFT_SELECT,\n  DRAFT_UNPREVIEW,\n  DRAFT_UPDATE_FIELD_SELECTOR,\n  DRAFT_UPDATE_INPUT,\n  DRAFT_UPDATE_SELECTOR,\n  DRAFT_IMPORT,\n  DRAFT_LIFECYCLE_NEW,\n  DRAFT_LIFECYCLE_CHANGED,\n} from '../actions/drafts';\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  currentDrafts: {},\n  isConfirmed: {},\n  list: {},\n};\n\nfunction draftModel(draft) {\n  return {\n    id: draft.id,\n    input: draft.input || {},\n    selectors: draft.selectors || {},\n    template: draft.template,\n    motivation: draft.motivation,\n    isPublishing: draft.isPublishing || false,\n    isPreviewing: draft.isPreviewing || false,\n    selector: draft.selector || null,\n    fingerprint: draft.fingerprint ? draft.fingerprint : {\n      scope: draft.template,\n      path: [],\n      lifecycle: DRAFT_LIFECYCLE_NEW, // DRAFT_LIFECYCLE_NEW | DRAFT_LIFECYCLE_CHANGED\n      source: 'memory', // memory | elucidate | localStorage\n      // To detect this default.\n      unstable: true,\n    },\n  };\n}\n\nexport default function draftReducer(state = defaultState, action) {\n  switch (action.type) {\n    case DRAFT_CREATE:\n    case DRAFT_IMPORT:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            $set: draftModel(action.payload),\n          },\n        },\n      });\n\n    case DRAFT_UPDATE_FIELD_SELECTOR:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            selectors: { $merge: action.payload.selectors },\n          },\n        },\n      });\n\n    case DRAFT_UPDATE_INPUT:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            input: { $merge: action.payload.fields },\n          },\n        },\n      });\n\n    case DRAFT_REMOVE_SELECTOR:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            selector: { $set: null },\n          },\n        },\n      });\n\n    case DRAFT_UPDATE_SELECTOR:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            selector: { $set: action.payload.selector ? action.payload.selector : state.list[action.payload.id].selector },\n          },\n        },\n      });\n\n    case DRAFT_SELECT:\n      return update(state, {\n        currentDrafts: { [action.payload.scope]: { $set: action.payload.id } },\n      });\n\n    case DRAFT_DESELECT:\n      return update(state, {\n        currentDrafts: { [action.payload.scope]: { $set: null } },\n      });\n\n    case DRAFT_PUBLISHING:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            isPublishing: { $set: true },\n          },\n        },\n      });\n\n    case DRAFT_PREVIEW:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            isPreviewing: { $set: true },\n          },\n        },\n      });\n\n    case DRAFT_UNPREVIEW:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            isPreviewing: { $set: false },\n          },\n        },\n      });\n\n    case DRAFT_CONFIRM:\n      return update(state, {\n        isConfirmed: { [action.payload.scope]: { $set: true } },\n      });\n\n    case DRAFT_PUBLISHED:\n      return update(state, {\n        currentDrafts: { [action.payload.scope]: { $set: null } },\n        isConfirmed: { [action.payload.scope]: { $set: false } },\n        list: {\n          $apply: function (obj) {\n            const { [action.payload.id]: _, ...copy } = obj;\n            return copy;\n          },\n        },\n      });\n\n    case DRAFT_DISCARD:\n      const listUpdate = {\n        $apply: function (obj) {\n          const { [action.payload.id]: _, ...copy } = obj;\n          return copy;\n        },\n      };\n      if (state.currentDrafts[action.payload.scope] !== action.payload.id) {\n        return update(state, {\n          list: listUpdate,\n        });\n      }\n      return update(state, {\n        currentDrafts: { [action.payload.scope]: { $set: null } },\n        list: listUpdate,\n      });\n\n\n  }\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/draftReducer.js","import { ANNOTATIONS_ADD } from '../actions/annotations';\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  list: [],\n};\n\nexport default function annotationReducer(state = defaultState, action) {\n  if (action.type === ANNOTATIONS_ADD) {\n    return update(state, {\n      list: { $push: [action.payload.annotation] },\n    });\n  }\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/annotationReducer.js","import {\n  SELECTOR_CANCEL,\n  SELECTOR_CHOOSE,\n  SELECTOR_COMMIT_TO_DRAFT,\n  SELECTOR_COMMIT_TO_DRAFT_FIELD,\n  SELECTOR_SET_AVAILABLE,\n  SELECTOR_UPDATE\n} from '../actions/selectors';\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  available: [],\n  currentSelector: {},\n};\n\nexport default function selectorReducer(state = defaultState, action) {\n\n  switch (action.type) {\n    case SELECTOR_SET_AVAILABLE:\n      return update(state, {\n        available: { $set: action.payload.selectors },\n      });\n\n    case SELECTOR_CHOOSE:\n      return update(state, {\n        currentSelector: {\n          $set: {\n            type: action.payload.type,\n            source: action.payload.source,\n            ...action.payload.defaults\n          },\n        },\n      });\n\n    case SELECTOR_UPDATE:\n      return update(state, {\n        currentSelector: { $merge: action.payload.data },\n      });\n\n    case SELECTOR_COMMIT_TO_DRAFT:\n    case SELECTOR_COMMIT_TO_DRAFT_FIELD:\n    case SELECTOR_CANCEL:\n      return update(state, {\n        currentSelector: { $set: {} },\n      });\n\n  }\n\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/selectorReducer.js","import update from 'immutability-helper';\nimport {\n  ELUCIDATE_ADD_ANNOTATION,\n  ELUCIDATE_CREATE_COLLECTION,\n  ELUCIDATE_SEND_ANNOTATION,\n  ELUCIDATE_SET_COLLECTION,\n  ELUCIDATE_SET_RESOURCE,\n  ELUCIDATE_SET_SERVER\n} from '../actions/elucidate';\n\nconst defaultState = {\n  server: null,\n  resource: null,\n  collection: {\n    id: null,\n    label: null,\n    resourceId: null,\n    loading: false,\n  },\n  annotations: {},\n  pendingAnnotations: 0,\n};\n\nexport default function elucidateReducer(state = defaultState, action) {\n  switch (action.type) {\n    case ELUCIDATE_SET_SERVER:\n      return update(state, {\n        server: { $set: action.payload.server },\n      });\n\n    case ELUCIDATE_SET_RESOURCE:\n      return update(state, {\n        resource: { $set: action.payload.resource },\n      });\n\n    case ELUCIDATE_CREATE_COLLECTION:\n      return update(state, {\n        collection: {\n          loading: { $set: true },\n          label: { $set: action.payload.label },\n          resourceId: { $set: action.payload.resourceId },\n        },\n      });\n\n    case ELUCIDATE_SET_COLLECTION:\n      return update(state, {\n        collection: {\n          $set: Object.assign({}, action.payload.collection, { loading: false }),\n        },\n      });\n\n    case ELUCIDATE_SEND_ANNOTATION:\n      return update(state, {\n        pendingAnnotations: { $apply: (n) => n + 1 },\n      });\n\n    case ELUCIDATE_ADD_ANNOTATION:\n      return update(state, {\n        pendingAnnotations: { $apply: (n) => n - 1 },\n        annotations: {\n          [action.payload.id]: {\n            $set: action.payload.annotation,\n          },\n        },\n      });\n\n    default:\n      return state;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/elucidateReducer.js","import update from 'immutability-helper';\nimport {\n  MANIFEST_ADD,\n  MANIFEST_CANVAS_SELECT,\n  MANIFEST_REMOVE,\n  MANIFEST_REQUEST,\n  MANIFEST_SELECT\n} from '../actions/manifest';\n\nconst defaultState = {\n  currentCanvas: null,\n  current: null,\n  list: {},\n  pending: [],\n};\n\nexport default function manifestReducer(state = defaultState, action) {\n\n  switch (action.type) {\n\n    case MANIFEST_ADD:\n      return update(state, {\n        list: {\n          $set: {\n            [action.payload.url]: action.payload.manifest,\n          },\n        },\n      });\n\n    case MANIFEST_SELECT:\n      return update(state, {\n        current: {\n          $set: action.payload.url,\n        },\n      });\n\n    case MANIFEST_CANVAS_SELECT:\n      return update(state, {\n        currentCanvas: {\n          $set: action.payload.url,\n        },\n      });\n\n    case MANIFEST_REMOVE:\n      const listUpdate = {\n        $apply: function (obj) {\n          const { [action.payload.url]: _, ...copy } = obj;\n          return copy;\n        },\n      };\n      if (state.current !== action.payload.url) {\n        return update(state, {\n          list: listUpdate,\n        });\n      }\n      return update(state, {\n        current: { $set: null },\n        list: listUpdate,\n      });\n\n    case MANIFEST_REQUEST:\n      return update(state, {\n        pending: { $push: [action.payload.url] },\n      });\n  }\n\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/manifestReducer.js","import {\n  IMPORT_CAPTURE_MODEL,\n  IMPORT_RESOURCE_CHOICE,\n  IMPORT_RESOURCE_FIELD,\n  IMPORT_RESOURCE_TREE,\n  IMPORT_UNKNOWN_RESOURCE,\n  RESOURCE_NAV_BACK,\n  RESOURCE_NAV_FORWARD,\n  RESOURCE_NAV_RESET\n} from '../actions/resources';\n\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  currentPaths: {},\n  trees: {},\n  list: {},\n};\n\nconst captureModelDefaults = {\n  fields: {},\n};\n\nexport default function resourceReducer(state = defaultState, action) {\n  if (action.error) {\n    switch (action.type) {\n      case IMPORT_RESOURCE_TREE:\n      case IMPORT_UNKNOWN_RESOURCE:\n      case IMPORT_RESOURCE_FIELD:\n        console.error(action.payload);\n        return state;\n    }\n\n    return state;\n  }\n\n  switch (action.type) {\n\n    case RESOURCE_NAV_FORWARD:\n      if (!state.currentPaths[action.payload.tree]) {\n        // @todo Log error.\n        return state;\n      }\n      return update(state, {\n        currentPaths: { [action.payload.tree]: { $push: [action.payload.path] } },\n      });\n\n    case RESOURCE_NAV_BACK:\n      if (!state.currentPaths[action.payload.tree]) {\n        // @todo Log error.\n        return state;\n      }\n      return update(state, {\n        currentPaths: { [action.payload.tree]: { $apply: (path) => path.length > 0 ? path.slice(0, -1) : [] } },\n      });\n\n    case RESOURCE_NAV_RESET:\n      return update(state, {\n        currentPaths: { [action.payload.tree]: { $set: [] } },\n      });\n\n    case IMPORT_RESOURCE_TREE:\n      return update(state, {\n        currentPaths: {\n          [action.payload.id]: { $set: [] },\n        },\n        trees: {\n          [action.payload.id]: { $set: action.payload.tree },\n        },\n      });\n\n    case IMPORT_RESOURCE_CHOICE:\n      return state; // This all exists in the tree for now.\n\n    case IMPORT_CAPTURE_MODEL:\n      return update(state, {\n        list: {\n          [action.payload.id]: { $set: { ...captureModelDefaults, ...action.payload.resource } },\n        },\n      });\n\n    case IMPORT_RESOURCE_FIELD:\n      return update(state, {\n        list: {\n          [action.payload.id]: {\n            fields: {\n              [action.payload.resource.id]: { $set: action.payload.resource },\n            },\n          },\n        },\n      });\n      return state;\n  }\n\n  return state;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/resourceReducer.js","import { HELP_CONTEXT_ADD, HELP_CONTEXT_REMOVE, HELP_INFO_ADD, HELP_INFO_REMOVE } from '../actions/help';\nimport update from 'immutability-helper';\n\nconst defaultState = {\n  context: null,\n  info: {},\n  warning: {},\n  error: {},\n};\n\nexport default function elucidateReducer(state = defaultState, action) {\n\n  switch (action.type) {\n    case HELP_INFO_ADD:\n      return update(state, {\n        [action.payload.type]: {\n          [action.payload.key]: { $set: action.payload.content },\n        },\n      });\n\n    case HELP_INFO_REMOVE:\n      return update(state, {\n        [action.payload.type]: {\n          $apply: function (obj) {\n            const { [action.payload.key]: _, ...copy } = obj;\n            return copy;\n          },\n        },\n      });\n\n    case HELP_CONTEXT_ADD:\n      return update(state, {\n        context: { $set: action.payload.content },\n      });\n\n    case HELP_CONTEXT_REMOVE:\n      return update(state, {\n        context: { $set: null },\n      });\n    default:\n      return state;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/reducers/helpReducer.js","import React from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport {\n  addSelectorToDraftFromViewer,\n  asyncPublishDraft,\n  confirmDraft,\n  createDraft,\n  deselectDraft,\n  discardCurrentDraft,\n  discardDraft,\n  editCurrentDraftFieldSelector,\n  previewDraft,\n  publishDraft,\n  removeSelectorFromCurrentDraft,\n  removeSelectorFromDraft,\n  selectDraft,\n  unpreviewDraft,\n  updateDraft,\n  importDraft,\n  markDraftAs,\n} from './actions/drafts';\nimport { addAnnotation } from './actions/annotations';\nimport {\n  cancelSelector,\n  chooseSecondarySelector,\n  chooseSelector,\n  commitToCurrentDraft,\n  commitToCurrentDraftField,\n  editCurrentDraftSecondarySelector,\n  editCurrentDraftSelector,\n  setAvailableSelectors,\n  updateSelector,\n} from './actions/selectors';\nimport {\n  addElucidateAnnotation,\n  createCollection,\n  createAnnotation,\n  sendAnnotation,\n  updateAnnotation,\n  setCollection,\n  setResource,\n  setServer,\n} from './actions/elucidate';\nimport { moveBack, moveForward, reset } from './actions/resources';\nimport {\n  currentDraftEditableRegions,\n  getCurrentDraft,\n  getDraftById,\n  getDraftsByFingerprintIdentity,\n} from './query/draftQuery';\nimport { getCurrentResource, getCurrentResourceTemplate, getForm, resourceTemplateList } from './query/resourceQuery';\nimport { addManifest, removeManifest, requestManifest, selectCanvas, selectManifest } from './actions/manifest';\nimport { richAnnotationList } from './query/elucidateQuery';\nimport { setViewer, withViewer } from './actions/viewer';\nimport { currentSelectorIsSecondary, isSelecting } from './query/selectorQuery';\n\nfunction bindCurrentResource(currentResource, actions) {\n  if (!currentResource) {\n    return {};\n  }\n  return Object.keys(actions).reduce((state, key) => {\n    state[key] = (...args) => actions[key](currentResource, ...args);\n    return state;\n  }, {});\n}\n\nexport default (WrappedComponent, actions = {}) => connect((state, props) => {\n  const annotationList = richAnnotationList(state);\n  const currentResource = props.tree ? getCurrentResource(props.tree, state) : null;\n  const currentResourceTemplate = props.tree ? getCurrentResourceTemplate(state, props.tree) : null;\n  const currentDraft = props.tree ? getCurrentDraft(state, props.tree) : null;\n  const currentSelector = (state.selector && state.selector.currentSelector) ? state.selector.currentSelector : null;\n  const treeRoute = props.tree && state.resource.currentPaths ? state.resource.currentPaths[props.tree] : null;\n\n  // @todo move to query.\n  const currentDraftList = Object.values(state.drafts.currentDrafts);\n  const currentDraftSelectors = currentDraftList.length ? currentDraftList.reduce((selectors, currentDraftId) => {\n    if (!currentDraftId) {\n      return [];\n    }\n    const currentDraft = getDraftById(state, currentDraftId);\n    if (!currentDraft) {\n      return [];\n    }\n    Object.keys(currentDraft.selectors).forEach(k => {\n      selectors.push({ ...currentDraft.selectors[k], id: k, isSecondary: true });\n    });\n    return selectors;\n  }, []) : [];\n\n  return {\n    state,\n    treeRoute,\n    currentSelector,\n    currentDraft,\n    currentDrafts: state.drafts.currentDrafts,\n    currentResource,\n    isSelecting: isSelecting(state),\n    isSelectingPrimary: (isSelecting(state) && currentSelectorIsSecondary(state) === false),\n    isSelectingSecondary: (isSelecting(state) && currentSelectorIsSecondary(state) === true),\n    isConfirmingDraft: props.tree ? state.drafts.isConfirmed[props.tree] === false : true,\n    editableRegions: currentDraftEditableRegions(state),\n    drafts: state.drafts.list,\n    currentResourceTemplate,\n    currentDraftSelectors,\n    draftIsCurrentlySelecting: (!currentDraft || !currentDraft.selector) && currentSelector.type,\n    draftHasSelector: (!currentDraft || !currentDraft.selector),\n    resourceTemplateList: resourceTemplateList(state),\n    wholeCanvasAnnotations: annotationList ? annotationList.filter(anno => anno.selector && !anno.selector.target.expanded) : [],\n    regionAnnotations: annotationList ? annotationList.filter(anno => anno.selector && anno.selector.target.expanded) : [],\n    resourceForm: currentResourceTemplate ? getForm(currentResourceTemplate) : null,\n    resourceTemplates: state.resource,\n    getDraftsByFingerprintIdentity: getDraftsByFingerprintIdentity(state),\n  };\n}, (dispatch, ownProps) => bindActionCreators({\n  ...bindCurrentResource(ownProps.tree, {\n    confirmDraft,\n    deselectDraft,\n    discardDraft,\n    discardCurrentDraft,\n    removeSelectorFromCurrentDraft,\n    selectDraft,\n    editCurrentDraftSecondarySelector,\n    editCurrentDraftSelector,\n    editCurrentDraftFieldSelector,\n    unpreviewDraft,\n    createDraft,\n    publishDraft,\n    asyncPublishDraft,\n  }),\n  selectScopedDraft: selectDraft,\n  importDraft,\n  commitToCurrentDraft,\n  commitToCurrentDraftField,\n  cancelSelector,\n  chooseSecondarySelector,\n  setAvailableSelectors,\n  chooseSelector,\n  updateSelector,\n  getCurrentDraft,\n  updateDraft,\n  previewDraft,\n  addSelectorToDraftFromViewer,\n  removeSelectorFromDraft,\n  setViewer,\n  withViewer,\n  setServer,\n  createCollection,\n  setCollection,\n  sendAnnotation,\n  updateAnnotation,\n  createAnnotation,\n  addElucidateAnnotation,\n  addAnnotation,\n  setResource,\n  requestManifest,\n  addManifest,\n  removeManifest,\n  selectCanvas,\n  selectManifest,\n  moveForward,\n  moveBack,\n  reset,\n  ...actions\n}, dispatch), null, { withRef: true })(WrappedComponent);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/connector.js","import { applyMiddleware, combineReducers, compose, createStore } from 'redux';\nimport middleware from './middleware';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default function createCustomStore(reducers = [e => e || {}], extraMiddleware = []) {\n  return createStore(\n    combineReducers(reducers),\n    composeEnhancers(\n      applyMiddleware(...[...middleware, ...extraMiddleware]),\n    ),\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/createStore.js","import thunk from 'redux-thunk';\n\nconst logger = store => next => action => {\n  if (typeof action !== 'function' && process.env.__DEV__ === true) {\n    // console.log('dispatching', action);\n  }\n  return next(action);\n};\nconst ViewerStore = { viewer: null, resolve: null, err: null };\nconst viewerReady = new Promise((resolve, err) => {\n  ViewerStore.resolve = resolve;\n  ViewerStore.err = err;\n});\n\nconst viewerAware = store => next => action => {\n  if (action.type === 'VIEWER_MUTATION') {\n    ViewerStore.resolve(action.payload.viewer);\n  }\n  if (action.type === 'VIEWER_ACCESS') {\n    return viewerReady.then(viewer => {\n      action.payload.func(viewer, store.dispatch, store.getState);\n    })\n  }\n  return next(action);\n};\n\nconst showUntilQueue = {};\n\nconst showUntil = store => next => action => {\n  if (action.type === 'SHOW_UNTIL') {\n    showUntilQueue[action.payload.type] = showUntilQueue[action.payload.type] ? showUntilQueue[action.payload.type] : [];\n    showUntilQueue[action.payload.type].push(action.payload.name);\n  }\n  if (showUntilQueue[action.type]) {\n    store.dispatch({ type: 'SHOW_UNTIL_REMOVED', payload: { names: showUntilQueue[action.type] } });\n    showUntilQueue[action.type] = [];\n  }\n  return next(action);\n};\n\nexport default [\n  logger, thunk, viewerAware, showUntil,\n];\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/middleware.js","import plugin from './viewer.plugin';\nimport provider from './viewer.provider';\nimport Component from './viewer';\n\nexport {\n  Component,\n  provider,\n  plugin,\n};\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-viewer/src/index.js","import React from 'react';\nimport {render} from 'react-dom';\nimport {utils} from 'digirati-annotation-plugin-core';\nimport ViewerProvider from './viewer.provider';\n\nexport default function ViewerPlugin($el, {\n  viewer,\n  height,\n  width,\n  toggleable,\n  showControls,\n  ...unknownProps\n}, store) {\n  utils.unknownPropertyWarning(unknownProps);\n\n  const image = {\n    src: $el.querySelector('img').src,\n    height: parseInt(height, 10) || 0,\n    width: parseInt(width, 10) || 0,\n  };\n\n  render(<ViewerProvider toggleable={toggleable} showControls={showControls} selectedViewer={viewer} image={image} store={store}/>, $el);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-viewer/src/viewer.plugin.js","/**\n * This is a port of: https://github.com/digirati-co-uk/omeka-elucidate-module/blob/master/src/Domain/AnnotationBody.php\n */\n\n/**\n * Parse and return the entity class for a given source URI.\n *\n * @param uri\n */\nexport function tagClassForUri(uri) {\n  if (!uri) {\n    return null;\n  }\n  const regex = /\\/topics\\/(?:virtual:)?([A-Za-z_+-].+)\\//;\n  const matches = regex.exec(uri);\n  if (!matches) {\n    return null;\n  }\n\n  if (matches.length > 1) {\n    return matches[1];\n  } else {\n    return null;\n  }\n}\n\nexport default class AnnotationBody {\n\n  constructor(type = null, textualBody = null, source = null) {\n    this.type = type;\n    this.textualBody = textualBody;\n    this.source = source;\n  }\n\n  static fromJsonLD(jsonLd) {\n    return AnnotationBody.fromBody(jsonLd);\n  }\n\n  static fromBody(body) {\n    if (!body) {\n      return new AnnotationBody();\n    }\n    if (\n      Object.prototype.toString.call(body) === '[object Object]' && body.value\n    ) {\n      return new AnnotationBody(null, body['value']);\n    }\n\n    if (Object.prototype.toString.call(body) !== '[object Array]' || body.length === 0) {\n      return new AnnotationBody();\n    }\n\n    const textualBody = body.filter(function (item) {\n        return (item.type ? item.type : '').toLowerCase() === 'textualbody' || (item.type ? item.type : '').toLowerCase() === 'text';\n      }) || null;\n\n    const specificResource = body.filter(function (item) {\n        return item.type === 'SpecificResource';\n      }) || '';\n\n    const source = (specificResource && specificResource[0]) ? specificResource[0]['source'] : null;\n    const type = source ? tagClassForUri(source) : null;\n\n    return new AnnotationBody(\n      type,\n      AnnotationBody.getFirstBody(textualBody),\n      source,\n    );\n  }\n\n  static getFirstBody(textualBody) {\n    if (Array.isArray(textualBody) && textualBody.length > 0 && textualBody[0] !== null) {\n      return textualBody[0].value;\n    }\n    return {};\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/annotationBody.js","import React from 'react';\nimport {branch, compose, lifecycle, mapProps, pure, renderComponent, renderNothing} from 'recompose';\nimport BEM from 'digirati-bem-js';\n\nconst style = BEM.block('osd-viewer');\n\nexport function isValidTileSource(tileSource) {\n  return !!(\n    tileSource &&\n    tileSource['@context'] &&\n    tileSource['@id'] &&\n    tileSource.protocol === 'http://iiif.io/api/image' &&\n    tileSource.width &&\n    tileSource.height &&\n    tileSource.profile\n  );\n}\n\nexport function getCanonicalImage(image) {\n  if (image.substr(-9, 9) === 'info.json') {\n    return image;\n  }\n  if (image.substr(-1, 1) === '/') {\n    return `${image}info.json`;\n  }\n  return `${image}/info.json`;\n}\n\nexport function resolveRealTileSourceFromCanvas(canvas) {\n  return resolveRealTileSource(\n    canvas.images.map(image => image.resource.service || null).filter(e => e).pop(),\n  );\n}\n\nexport function resolveRealTileSource(image) {\n  if (isValidTileSource(image)) {\n    return Promise.resolve(image);\n  }\n\n  if (image['@id']) {\n    return fetch(getCanonicalImage(image['@id']))\n      .then(r => r.json())\n      .then(tileSource => isValidTileSource(tileSource) ? tileSource : null);\n  }\n\n  return Promise.resolve(null);\n}\n\nexport function createElement(isSelected, id, type) {\n  const container = document.createElement('div');\n  const $el = document.createElement('div');\n  container.setAttribute('data-selected', isSelected);\n  if (type) {\n    container.setAttribute('data-selector-type', type);\n  }\n  container.id = `overlay-${id}`;\n  $el.classList.add(\n    ...style.element('region-item').modifiers({selected: isSelected}, false)\n  );\n  container.appendChild($el);\n  return container;\n}\n\nexport function withManifest(BaseComponent) {\n  return compose(\n    mapProps(props => ({\n      regionIds: props.regions ? props.regions.map(region => region.id) : [],\n      ...props\n    })),\n    lifecycle({\n      componentWillMount() {\n        const {canvas} = this.props;\n        resolveRealTileSourceFromCanvas(canvas).then((tileSource) => this.setState({tileSource}));\n      },\n    }),\n    branch(\n      ({tileSource}) => tileSource,\n      renderComponent(BaseComponent),\n      renderComponent((props) => {\n        if (props.resource) {\n          return <img src={props.resource} style={{ maxHeight: '80vh' }}/>;\n        }\n        return <div>this? loading...</div>\n      }),\n    ),\n  )(renderNothing());\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/openseadragon/utility.js","import OpenSeadragon from 'openseadragon';\nimport React, {PureComponent} from 'react';\nimport './viewer.scss';\nimport ScaledImageViewer from '../ScaledImageViewer';\nimport {withState} from 'recompose';\nimport BEM from 'digirati-bem-js';\n\nconst style = BEM.block('osd-viewer');\n\nclass Viewer extends PureComponent {\n\n  asyncAddTile(args) {\n    return new Promise((success, err) => {\n      try {\n        this.viewer.addTiledImage.call(this.viewer, {success, ...args});\n      } catch (e) {\n        err(e);\n      }\n    });\n  }\n\n  createRelativePoint(x, y) {\n    return this.viewer.viewport.viewerElementToImageCoordinates(\n      new OpenSeadragon.Point(x, y),\n    );\n  }\n\n  createViewportPoint(x, y) {\n    return this.viewer.viewport.imageToViewerElementCoordinates(\n      new OpenSeadragon.Point(x, y),\n    );\n  }\n\n  getImageSize() {\n    return {\n      width: this.props.width,\n      height: this.props.height,\n    }\n  }\n\n  componentDidMount() {\n    const {getRef, setFallback, onImageLoaded, tileSource} = this.props;\n    if (!tileSource) {\n      console.error('Something went wrong, we cannot display the open sea dragon');\n      setFallback(true);\n    }\n    this.viewer = new OpenSeadragon({\n      element: this.element,\n      ajaxWithCredentials: false,\n      showNavigator: true,\n      showRotationControl: true,\n      defaultZoomLevel: 0,\n      maxZoomPixelRatio: 1,\n      navigatorPosition: 'BOTTOM_RIGHT',\n      animationTime: 0.3,\n      immediateRender: true,\n      preserveViewport: true,\n      blendTime: 0.1,\n      minPixelRatio: 0.5,\n      visibilityRatio: 0.65,\n      constrainDuringPan: false,\n      showSequenceControl: false,\n      showNavigationControl: false,\n      showZoomControl: true,\n      showHomeControl: false,\n      showFullPageControl: false,\n      sequenceMode: true,\n      prefixUrl: 'http://zimeon.github.io/iiif-dragndrop/openseadragon/images/',\n    });\n    if (getRef) {\n      getRef(this);\n    }\n\n    this.asyncAddTile({tileSource}).then(e => {\n      this.viewer.viewport.goHome(true);\n      if (onImageLoaded) {\n        onImageLoaded(this.viewer, e);\n      }\n    });\n  }\n\n  zoomIn = (e) => {\n    e.preventDefault();\n    this.viewer.viewport.zoomBy(1/0.7);\n  }\n\n  zoomOut = (e) => {\n    e.preventDefault();\n    this.viewer.viewport.zoomBy(0.7);\n  }\n\n  setRef = el => this.element = el;\n\n  render() {\n    const {height, fallback, width, maxHeight = Infinity, scale, showControls} = this.props;\n\n    if (fallback) {\n      return (\n        <ScaledImageViewer { ...this.props}/>\n      );\n    }\n\n    const actualHeight = ( height * scale ) < maxHeight ? height * scale : maxHeight;\n    return (\n      <div className={style} style={{position: 'relative'}}>\n        { showControls ? (\n          <div className={style.element('controls')}>\n            <div onClick={this.zoomIn} className={style.element('control').modifier('plus')}>{`+`}</div>\n            <div onClick={this.zoomOut} className={style.element('control').modifier('minus')}>{`-`}</div>\n          </div>\n        ) : null}\n        <div ref={this.setRef} style={{height: actualHeight, width: width * scale}}/>\n      </div>\n    );\n  }\n}\n\nexport default withState('fallback', 'setFallback', false)(Viewer);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/openseadragon/viewer.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../../node_modules/sass-loader/lib/loader.js!./viewer.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../../node_modules/sass-loader/lib/loader.js!./viewer.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../../node_modules/sass-loader/lib/loader.js!./viewer.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/viewers/openseadragon/viewer.scss\n// module id = 632\n// module chunks = 0","exports = module.exports = require(\"../../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".osd-viewer__region-item {\\n  height: 100%;\\n  width: 100%;\\n  border: 1px solid #FFF;\\n  background-color: rgba(255, 255, 255, 0.3); }\\n  .osd-viewer__region-item--selected {\\n    border-width: 3px; }\\n  .osd-viewer__region-item--editing {\\n    opacity: .1; }\\n\\n.osd-viewer__controls {\\n  position: absolute;\\n  top: 10px;\\n  right: 10px;\\n  padding: 10px;\\n  z-index: 999; }\\n\\n.osd-viewer__control {\\n  user-select: none;\\n  cursor: pointer;\\n  border-radius: 1px;\\n  width: 30px;\\n  height: 30px;\\n  line-height: 30px;\\n  text-align: center;\\n  display: inline-block;\\n  color: #fff;\\n  margin: 5px;\\n  background: rgba(0, 0, 0, 0.8);\\n  border: 1px solid rgba(255, 255, 255, 0.8); }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/viewers/openseadragon/viewer.scss\n// module id = 633\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./StaticImageView.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./StaticImageView.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./StaticImageView.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/viewers/StaticImageView.scss\n// module id = 634\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".static-image-viewer--scaled {\\n  border: 1px solid #000; }\\n\\n.static-image-viewer__regions {\\n  position: relative; }\\n\\n.static-image-viewer__image {\\n  pointer-events: none; }\\n  .static-image-viewer__image::selection {\\n    color: transparent;\\n    background-color: transparent; }\\n\\n.static-image-viewer__region-item {\\n  position: absolute;\\n  border: 1px solid #FFF;\\n  background-color: rgba(255, 255, 255, 0.3); }\\n  .static-image-viewer__region-item--selected {\\n    border-width: 3px; }\\n  .static-image-viewer__region-item--editing {\\n    opacity: .1; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/viewers/StaticImageView.scss\n// module id = 635\n// module chunks = 0","import React, {Component} from 'react';\nimport ReactDOM from 'react-dom';\nimport OpenSeadragon from 'openseadragon';\n\nconst styles = {\n  container: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100%',\n    width: '100%',\n    pointerEvents: 'none',\n    overflow: 'hidden',\n  },\n\n  canvas: (transform, height, width) => ({\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    transformOrigin: 'left top',\n    pointerEvents: 'none',\n    transform,\n    height,\n    width,\n  }),\n};\n\nexport default function withCanvas(WrappedComponent) {\n\n  return class extends Component {\n\n    state = {\n      transform: null,\n      scale: 3,\n    };\n\n    componentDidMount() {\n      if (this.viewer) {\n        this.bindEvents(this.viewer);\n      }\n    }\n\n    bindEvents(viewer) {\n      viewer.addHandler('update-viewport', () => this.resize(viewer));\n      viewer.addHandler('open', () => this.resize(viewer));\n      this.resize(viewer);\n    }\n\n    resize(viewer) {\n      const firstImage = viewer.world.getItemAt(0);\n      if (!firstImage) {\n        return;\n      }\n      const imgWidth = firstImage.source.dimensions.x;\n      const imgHeight = firstImage.source.dimensions.y;\n      const imgAspectRatio = imgWidth / imgHeight;\n      const boundsRect = viewer.viewport.getBounds(true);\n      const viewportOrigin = new OpenSeadragon.Point(boundsRect.x, boundsRect.y * imgAspectRatio);\n\n      const viewportWidth = boundsRect.width;\n      const viewportHeight = boundsRect.height * imgAspectRatio;\n\n      // Redraw\n      const viewportZoom = viewer.viewport.getZoom(true);\n      const zoom = firstImage.viewportToImageZoom(viewportZoom);\n      const rotation = viewer.viewport.getRotation();\n\n      const x = ((viewportOrigin.x / imgWidth - viewportOrigin.x ) / viewportWidth) * viewer.container.clientWidth;\n      const y = ((viewportOrigin.y / imgHeight - viewportOrigin.y ) / viewportHeight) * viewer.container.clientHeight;\n\n      if (this.viewer) {\n\n        // Set position for parents.\n        if (this.props.getPosition) {\n          this.props.getPosition({\n            x, y, zoom, scale: this.state.scale, rotation\n          });\n        }\n\n        // Set state for transform.\n        this.setState(() => ({\n          canvasScale: this.state.scale * zoom,\n          transform: `translate(${x}px,${y}px) scale(${zoom * this.state.scale}) rotate(${rotation})`,\n        }));\n      }\n    }\n\n    setViewer(viewer, onImageLoaded) {\n      if (this.viewer) {\n        return;\n      }\n      this.viewer = viewer;\n      if (onImageLoaded) {\n        onImageLoaded(viewer);\n      }\n      this.bindEvents(viewer);\n    }\n\n    transformOut({ x, y, height, width, ...props }) {\n      const {scale} = this.state;\n      return {\n        width: width * scale,\n        height: height * scale,\n        x: x * scale,\n        y: y * scale,\n        ...props,\n      };\n    }\n\n    transformIn({ x, y, defaultX, defaultY, height, width, onChange, onUpdate, onCommit, onClick, ...props }) {\n      const {scale, canvasScale} = this.state;\n      return {\n        width: width / scale,\n        height: height / scale,\n        x: x / scale,\n        y: y / scale,\n        defaultX: defaultX / scale,\n        defaultY: defaultY / scale,\n        onChange: onChange ? (e) => onChange(this.transformOut(e)) : null,\n        onUpdate: onUpdate ? (e) => onUpdate(this.transformOut(e)) : null,\n        onCommit: onCommit ? (e) => onCommit(this.transformOut(e)) : null,\n        onClick: onClick ? (e) => onClick(this.transformOut(e)) : null,\n        canvasScale,\n        ...props,\n      };\n    }\n\n    render() {\n      const {scale, transform, canvasScale} = this.state;\n      const {children, onImageLoaded, ...props} = this.props;\n\n      return (\n        <div style={{position: 'relative'}}>\n          <WrappedComponent canvasScale={canvasScale} onImageLoaded={viewer => this.setViewer(viewer, onImageLoaded)} {...props}/>\n          <div style={Object.assign({}, styles.container, {\n            right: 0,\n            bottom: 0,\n            // width: this.props.width / scale,\n            // height: this.props.height / scale,\n          })} ref={el => this.container = el}>\n            <div id=\"withCanvas\" style={styles.canvas(\n              transform,\n              this.props.height / scale,\n              this.props.width / scale,\n            )}>\n              {React.Children.map(children, child => (\n                child ?\n                  (child.props && (\n                    (child.props.x && child.props.y) ||\n                    (child.props.defaultX && child.props.defaultY)\n                  ) ?\n                    React.cloneElement(child, this.transformIn({\n                      width: child.props.width,\n                      height: child.props.height,\n                      x: child.props.x,\n                      defaultX: child.props.defaultX,\n                      defaultY: child.props.defaultY,\n                      onChange: child.props.onChange,\n                      onUpdate: child.props.onUpdate,\n                      onCommit: child.props.onCommit,\n                      onClick: child.props.onClick,\n                      y: child.props.y,\n                    })) : child ) : null\n              ))}\n            </div>\n          </div>\n        </div>\n      );\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/openseadragon/withCanvas.js","import React, { PureComponent, PropTypes } from 'react';\nimport Rnd from 'react-rnd';\nimport selectorPropTypes from './_selectorPropTypes';\nimport BEM from 'digirati-bem-js';\nimport './BoxSelector.scss';\n\nconst style = BEM.block('box-selector');\n\nclass BoxSelector extends PureComponent {\n\n  // static propTypes = {\n  //   ...selectorPropTypes,\n  //   onUpdate: PropTypes.func.isRequired,\n  // };\n\n  updateHeightWidth() {\n    this.props.onUpdate({\n      height: this.rnd.resizable.state.height,\n      width: this.rnd.resizable.state.width,\n      y: this.rnd.state.y,\n      x: this.rnd.state.x,\n    })\n  }\n\n  save() {\n    this.props.onSave({\n      height: this.rnd.resizable.state.height,\n      width: this.rnd.resizable.state.width,\n      y: this.rnd.state.y,\n      x: this.rnd.state.x,\n    });\n  }\n\n  getInitialPosition() {\n    const { x, y, height, width } = this.props;\n\n    return {\n      x: x ? (x > 0 ? x : 0) : 100,\n      y: y ? (y > 0 ? y : 0) : 100,\n      width: width ? width : 100,\n      height: height ? height : 100,\n    };\n  }\n\n  render() {\n    return (\n        <Rnd ref={c => this.rnd = c }\n             initial={this.getInitialPosition()}\n             onResizeStop={() => this.updateHeightWidth()}\n             onDragStop={() => this.updateHeightWidth()}\n             className={style}\n             bounds={'parent'}>\n        <span style={{ color: '#000' }}>\n          <button className={style.element('button')} onClick={(e) => this.save()}>Save</button>\n        </span>\n        </Rnd>\n    );\n  }\n}\n\nexport default BoxSelector;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/selectors/BoxSelector.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./BoxSelector.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./BoxSelector.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./BoxSelector.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/selectors/BoxSelector.scss\n// module id = 642\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".box-selector {\\n  border: 2px dashed blueviolet;\\n  padding: 0.5rem 1rem;\\n  cursor: move;\\n  background: rgba(255, 255, 255, 0.3);\\n  pointer-events: auto; }\\n  .box-selector__button {\\n    top: 100%;\\n    margin-top: 10px;\\n    right: 0;\\n    position: absolute; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/selectors/BoxSelector.scss\n// module id = 643\n// module chunks = 0","import BEM from 'digirati-bem-js';\nimport React, {Component} from 'react';\nimport './PinSelector.scss';\nimport withDraggable from '../viewers/openseadragon/withDraggable';\nimport withFixedScale from '../viewers/openseadragon/withFixedScale';\n\nconst $pin = BEM.block('pin-selector');\n\nclass PinSelector extends Component {\n\n  render() {\n    const { x, y, style } = this.props;\n    return (\n      x && y ?\n        <div className={$pin.element('icon')}\n             style={{top: y - 17, left: x - 17, pointerEvents: 'auto', ...style}}>\n        </div> : <div />\n    );\n  }\n}\n\nexport default withDraggable(\n  withFixedScale(\n    PinSelector\n  )\n);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/selectors/PinSelector.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./PinSelector.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./PinSelector.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./PinSelector.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/selectors/PinSelector.scss\n// module id = 645\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".pin-selector {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  z-index: 10;\\n  cursor: crosshair; }\\n  .pin-selector__icon {\\n    position: absolute;\\n    width: 3px;\\n    height: 3px;\\n    border-radius: 17px;\\n    background: #FFF;\\n    background-clip: content-box;\\n    border: 16px solid rgba(66, 133, 244, 0.3); }\\n  .pin-selector__image {\\n    position: absolute;\\n    top: -15px;\\n    left: -6px; }\\n  .pin-selector__edit {\\n    position: absolute;\\n    top: -50px;\\n    pointer-events: initial; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/selectors/PinSelector.scss\n// module id = 646\n// module chunks = 0","import React, { Component } from 'react';\nimport Draggable from '../../../patches/react-draggable';\n\nexport default function withDraggable(WrappedComponent) {\n\n  return class extends Component {\n\n    state = {\n      x: 0,\n      y: 0,\n    };\n\n    onDrag = (e, { deltaX, deltaY }) => this.setState(() => ({\n      x: this.state.x + deltaX,\n      y: this.state.y + deltaY\n    }));\n\n    onStop = () => {\n      this.props.onUpdate({\n        x: this.props.x + this.state.x,\n        y: this.props.y + this.state.y\n      });\n      this.setState({\n        x: 0,\n        y: 0\n      });\n    };\n\n    render() {\n      const { canvasScale, drag = false } = this.props;\n\n      if (drag === false) {\n        return <WrappedComponent {...this.props}/>;\n      }\n      return (\n        <Draggable\n          scale={canvasScale}\n          position={{ x: 0, y: 0 }}\n          grid={[1, 1]}\n          onDrag={ this.onDrag }\n          onStop={ this.onStop }\n        >\n          <div style={{ pointerEvents: 'auto', zIndex: 999999 }}>\n            <WrappedComponent {...this.props} onUpdate={null}/>\n          </div>\n        </Draggable>\n      );\n    }\n\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/openseadragon/withDraggable.js","(function webpackUniversalModuleDefinition(root, factory) {\n  if(typeof exports === 'object' && typeof module === 'object')\n    module.exports = factory(require(\"react\"), require(\"react-dom\"));\n  else if(typeof define === 'function' && define.amd)\n    define([\"react\", \"react-dom\"], factory);\n  else if(typeof exports === 'object')\n    exports[\"ReactDraggable\"] = factory(require(\"react\"), require(\"react-dom\"));\n  else\n    root[\"ReactDraggable\"] = factory(root[\"React\"], root[\"ReactDOM\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\n  return /******/ (function(modules) { // webpackBootstrap\n    /******/ \t// The module cache\n    /******/ \tvar installedModules = {};\n    /******/\n    /******/ \t// The require function\n    /******/ \tfunction __webpack_require__(moduleId) {\n      /******/\n      /******/ \t\t// Check if module is in cache\n      /******/ \t\tif(installedModules[moduleId])\n      /******/ \t\t\treturn installedModules[moduleId].exports;\n      /******/\n      /******/ \t\t// Create a new module (and put it into the cache)\n      /******/ \t\tvar module = installedModules[moduleId] = {\n        /******/ \t\t\texports: {},\n        /******/ \t\t\tid: moduleId,\n        /******/ \t\t\tloaded: false\n        /******/ \t\t};\n      /******/\n      /******/ \t\t// Execute the module function\n      /******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n      /******/\n      /******/ \t\t// Flag the module as loaded\n      /******/ \t\tmodule.loaded = true;\n      /******/\n      /******/ \t\t// Return the exports of the module\n      /******/ \t\treturn module.exports;\n      /******/ \t}\n    /******/\n    /******/\n    /******/ \t// expose the modules object (__webpack_modules__)\n    /******/ \t__webpack_require__.m = modules;\n    /******/\n    /******/ \t// expose the module cache\n    /******/ \t__webpack_require__.c = installedModules;\n    /******/\n    /******/ \t// __webpack_public_path__\n    /******/ \t__webpack_require__.p = \"\";\n    /******/\n    /******/ \t// Load entry module and return exports\n    /******/ \treturn __webpack_require__(0);\n    /******/ })\n  /************************************************************************/\n  /******/ ([\n    /* 0 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      'use strict';\n\n      module.exports = __webpack_require__(1).default;\n      module.exports.DraggableCore = __webpack_require__(9).default;\n\n      /***/ },\n    /* 1 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      'use strict';\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n\n      var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n      var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n      var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n      var _react = __webpack_require__(2);\n\n      var _react2 = _interopRequireDefault(_react);\n\n      var _reactDom = __webpack_require__(3);\n\n      var _reactDom2 = _interopRequireDefault(_reactDom);\n\n      var _classnames = __webpack_require__(4);\n\n      var _classnames2 = _interopRequireDefault(_classnames);\n\n      var _domFns = __webpack_require__(5);\n\n      var _positionFns = __webpack_require__(8);\n\n      var _shims = __webpack_require__(6);\n\n      var _DraggableCore = __webpack_require__(9);\n\n      var _DraggableCore2 = _interopRequireDefault(_DraggableCore);\n\n      var _log = __webpack_require__(11);\n\n      var _log2 = _interopRequireDefault(_log);\n\n      function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n      function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n      function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n      function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\n      function _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n      // $FlowIgnore\n\n\n      /*:: import type {DraggableEventHandler} from './utils/types';*/\n      /*:: type DraggableState = {\n       dragging: boolean,\n       dragged: boolean,\n       x: number, y: number,\n       slackX: number, slackY: number,\n       isElementSVG: boolean\n       };*/\n\n\n      //\n      // Define <Draggable>\n      //\n\n      /*:: type ConstructorProps = {\n       position: { x: number, y: number },\n       defaultPosition: { x: number, y: number }\n       };*/\n\n      var Draggable = function (_React$Component) {\n        _inherits(Draggable, _React$Component);\n\n        function Draggable(props /*: ConstructorProps*/) {\n          _classCallCheck(this, Draggable);\n\n          var _this = _possibleConstructorReturn(this, (Draggable.__proto__ || Object.getPrototypeOf(Draggable)).call(this, props));\n\n          _this.onDragStart = function (e, coreData) {\n            (0, _log2.default)('Draggable: onDragStart: %j', coreData);\n\n            // Short-circuit if user's callback killed it.\n            var shouldStart = _this.props.onStart(e, (0, _positionFns.createDraggableData)(_this, coreData));\n            // Kills start event on core as well, so move handlers are never bound.\n            if (shouldStart === false) return false;\n\n            _this.setState({ dragging: true, dragged: true });\n          };\n\n          _this.onDrag = function (e, coreData) {\n            if (!_this.state.dragging) return false;\n            (0, _log2.default)('Draggable: onDrag: %j', coreData);\n\n            var uiData = (0, _positionFns.createDraggableData)(_this, coreData);\n\n            var newState /*: $Shape<DraggableState>*/ = {\n              x: uiData.x,\n              y: uiData.y\n            };\n\n            // Keep within bounds.\n            if (_this.props.bounds) {\n              // Save original x and y.\n              var _x = newState.x,\n                _y = newState.y;\n\n              // Add slack to the values used to calculate bound position. This will ensure that if\n              // we start removing slack, the element won't react to it right away until it's been\n              // completely removed.\n\n              newState.x += _this.state.slackX;\n              newState.y += _this.state.slackY;\n\n              // Get bound position. This will ceil/floor the x and y within the boundaries.\n              // $FlowBug\n\n              // Recalculate slack by noting how much was shaved by the boundPosition handler.\n              var _getBoundPosition = (0, _positionFns.getBoundPosition)(_this, newState.x, newState.y);\n\n              var _getBoundPosition2 = _slicedToArray(_getBoundPosition, 2);\n\n              newState.x = _getBoundPosition2[0];\n              newState.y = _getBoundPosition2[1];\n              newState.slackX = _this.state.slackX + (_x - newState.x);\n              newState.slackY = _this.state.slackY + (_y - newState.y);\n\n              // Update the event we fire to reflect what really happened after bounds took effect.\n              uiData.x = _x;\n              uiData.y = _y;\n              uiData.deltaX = newState.x - _this.state.x;\n              uiData.deltaY = newState.y - _this.state.y;\n            }\n\n            // Short-circuit if user's callback killed it.\n            var shouldUpdate = _this.props.onDrag(e, uiData);\n            if (shouldUpdate === false) return false;\n\n            _this.setState(newState);\n          };\n\n          _this.onDragStop = function (e, coreData) {\n            if (!_this.state.dragging) return false;\n\n            // Short-circuit if user's callback killed it.\n            var shouldStop = _this.props.onStop(e, (0, _positionFns.createDraggableData)(_this, coreData));\n            if (shouldStop === false) return false;\n\n            (0, _log2.default)('Draggable: onDragStop: %j', coreData);\n\n            var newState /*: $Shape<DraggableState>*/ = {\n              dragging: false,\n              slackX: 0,\n              slackY: 0\n            };\n\n            // If this is a controlled component, the result of this operation will be to\n            // revert back to the old position. We expect a handler on `onDragStop`, at the least.\n            var controlled = Boolean(_this.props.position);\n            if (controlled) {\n              var _this$props$position = _this.props.position,\n                _x2 = _this$props$position.x,\n                _y2 = _this$props$position.y;\n\n              newState.x = _x2;\n              newState.y = _y2;\n            }\n\n            _this.setState(newState);\n          };\n\n          _this.state = {\n            // Whether or not we are currently dragging.\n            dragging: false,\n\n            // Whether or not we have been dragged before.\n            dragged: false,\n\n            // Current transform x and y.\n            x: props.position ? props.position.x : props.defaultPosition.x,\n            y: props.position ? props.position.y : props.defaultPosition.y,\n\n            // Used for compensating for out-of-bounds drags\n            slackX: 0, slackY: 0,\n\n            // Can only determine if SVG after mounting\n            isElementSVG: false\n          };\n          return _this;\n        }\n\n        _createClass(Draggable, [{\n          key: 'componentWillMount',\n          value: function componentWillMount() {\n            if (this.props.position && !(this.props.onDrag || this.props.onStop)) {\n              // eslint-disable-next-line\n              console.warn('A `position` was applied to this <Draggable>, without drag handlers. This will make this ' + 'component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the ' + '`position` of this element.');\n            }\n          }\n        }, {\n          key: 'componentDidMount',\n          value: function componentDidMount() {\n            // Check to see if the element passed is an instanceof SVGElement\n            if (typeof SVGElement !== 'undefined' && _reactDom2.default.findDOMNode(this) instanceof SVGElement) {\n              this.setState({ isElementSVG: true });\n            }\n          }\n        }, {\n          key: 'componentWillReceiveProps',\n          value: function componentWillReceiveProps(nextProps /*: Object*/) {\n            // Set x/y if position has changed\n            if (nextProps.position && (!this.props.position || nextProps.position.x !== this.props.position.x || nextProps.position.y !== this.props.position.y)) {\n              this.setState({ x: nextProps.position.x, y: nextProps.position.y });\n            }\n          }\n        }, {\n          key: 'componentWillUnmount',\n          value: function componentWillUnmount() {\n            this.setState({ dragging: false }); // prevents invariant if unmounted while dragging\n          }\n        }, {\n          key: 'render',\n          value: function render() /*: React.Element<any>*/ {\n            var _classNames;\n\n            var style = {},\n              svgTransform = null;\n\n            // If this is controlled, we don't want to move it - unless it's dragging.\n            var controlled = Boolean(this.props.position);\n            var draggable = !controlled || this.state.dragging;\n\n            var position = this.props.position || this.props.defaultPosition;\n            var transformOpts = {\n              // Set left if horizontal drag is enabled\n              x: (0, _positionFns.canDragX)(this) && draggable ? this.state.x : position.x,\n\n              // Set top if vertical drag is enabled\n              y: (0, _positionFns.canDragY)(this) && draggable ? this.state.y : position.y\n            };\n\n            // If this element was SVG, we use the `transform` attribute.\n            if (this.state.isElementSVG) {\n              svgTransform = (0, _domFns.createSVGTransform)(transformOpts);\n            } else {\n              // Add a CSS transform to move the element around. This allows us to move the element around\n              // without worrying about whether or not it is relatively or absolutely positioned.\n              // If the item you are dragging already has a transform set, wrap it in a <span> so <Draggable>\n              // has a clean slate.\n              style = (0, _domFns.createCSSTransform)(transformOpts);\n            }\n\n            var _props = this.props,\n              defaultClassName = _props.defaultClassName,\n              defaultClassNameDragging = _props.defaultClassNameDragging,\n              defaultClassNameDragged = _props.defaultClassNameDragged;\n\n            // Mark with class while dragging\n\n            var className = (0, _classnames2.default)(this.props.children.props.className || '', defaultClassName, (_classNames = {}, _defineProperty(_classNames, defaultClassNameDragging, this.state.dragging), _defineProperty(_classNames, defaultClassNameDragged, this.state.dragged), _classNames));\n\n            // Reuse the child provided\n            // This makes it flexible to use whatever element is wanted (div, ul, etc)\n            return _react2.default.createElement(\n              _DraggableCore2.default,\n              _extends({}, this.props, { onStart: this.onDragStart, onDrag: this.onDrag, onStop: this.onDragStop }),\n              _react2.default.cloneElement(_react2.default.Children.only(this.props.children), {\n                className: className,\n                style: _extends({}, this.props.children.props.style, style),\n                transform: svgTransform\n              })\n            );\n          }\n        }]);\n\n        return Draggable;\n      }(_react2.default.Component);\n\n      Draggable.displayName = 'Draggable';\n      Draggable.propTypes = _extends({}, _DraggableCore2.default.propTypes, {\n\n        /**\n         * `axis` determines which axis the draggable can move.\n         *\n         *  Note that all callbacks will still return data as normal. This only\n         *  controls flushing to the DOM.\n         *\n         * 'both' allows movement horizontally and vertically.\n         * 'x' limits movement to horizontal axis.\n         * 'y' limits movement to vertical axis.\n         * 'none' limits all movement.\n         *\n         * Defaults to 'both'.\n         */\n        axis: _react.PropTypes.oneOf(['both', 'x', 'y', 'none']),\n\n        /**\n         * `bounds` determines the range of movement available to the element.\n         * Available values are:\n         *\n         * 'parent' restricts movement within the Draggable's parent node.\n         *\n         * Alternatively, pass an object with the following properties, all of which are optional:\n         *\n         * {left: LEFT_BOUND, right: RIGHT_BOUND, bottom: BOTTOM_BOUND, top: TOP_BOUND}\n         *\n         * All values are in px.\n         *\n         * Example:\n         *\n         * ```jsx\n         *   let App = React.createClass({\n\t   *       render: function () {\n\t   *         return (\n\t   *            <Draggable bounds={{right: 300, bottom: 300}}>\n\t   *              <div>Content</div>\n\t   *           </Draggable>\n\t   *         );\n\t   *       }\n\t   *   });\n         * ```\n         */\n        bounds: _react.PropTypes.oneOfType([_react.PropTypes.shape({\n          left: _react.PropTypes.number,\n          right: _react.PropTypes.number,\n          top: _react.PropTypes.number,\n          bottom: _react.PropTypes.number\n        }), _react.PropTypes.string, _react.PropTypes.oneOf([false])]),\n\n        defaultClassName: _react.PropTypes.string,\n        defaultClassNameDragging: _react.PropTypes.string,\n        defaultClassNameDragged: _react.PropTypes.string,\n\n        /**\n         * `defaultPosition` specifies the x and y that the dragged item should start at\n         *\n         * Example:\n         *\n         * ```jsx\n         *      let App = React.createClass({\n\t   *          render: function () {\n\t   *              return (\n\t   *                  <Draggable defaultPosition={{x: 25, y: 25}}>\n\t   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n\t   *                  </Draggable>\n\t   *              );\n\t   *          }\n\t   *      });\n         * ```\n         */\n        defaultPosition: _react.PropTypes.shape({\n          x: _react.PropTypes.number,\n          y: _react.PropTypes.number\n        }),\n\n        /**\n         * `position`, if present, defines the current position of the element.\n         *\n         *  This is similar to how form elements in React work - if no `position` is supplied, the component\n         *  is uncontrolled.\n         *\n         * Example:\n         *\n         * ```jsx\n         *      let App = React.createClass({\n\t   *          render: function () {\n\t   *              return (\n\t   *                  <Draggable position={{x: 25, y: 25}}>\n\t   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n\t   *                  </Draggable>\n\t   *              );\n\t   *          }\n\t   *      });\n         * ```\n         */\n        position: _react.PropTypes.shape({\n          x: _react.PropTypes.number,\n          y: _react.PropTypes.number\n        }),\n\n        /**\n         * These properties should be defined on the child, not here.\n         */\n        className: _shims.dontSetMe,\n        style: _shims.dontSetMe,\n        transform: _shims.dontSetMe\n      });\n      Draggable.defaultProps = _extends({}, _DraggableCore2.default.defaultProps, {\n        axis: 'both',\n        bounds: false,\n        defaultClassName: 'react-draggable',\n        defaultClassNameDragging: 'react-draggable-dragging',\n        defaultClassNameDragged: 'react-draggable-dragged',\n        defaultPosition: { x: 0, y: 0 },\n        position: null,\n        scale: 1\n      });\n      exports.default = Draggable;\n\n      /***/ },\n    /* 2 */\n    /***/ function(module, exports) {\n\n      module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n      /***/ },\n    /* 3 */\n    /***/ function(module, exports) {\n\n      module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n      /***/ },\n    /* 4 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n       Copyright (c) 2016 Jed Watson.\n       Licensed under the MIT License (MIT), see\n       http://jedwatson.github.io/classnames\n       */\n      /* global define */\n\n      (function () {\n        'use strict';\n\n        var hasOwn = {}.hasOwnProperty;\n\n        function classNames () {\n          var classes = [];\n\n          for (var i = 0; i < arguments.length; i++) {\n            var arg = arguments[i];\n            if (!arg) continue;\n\n            var argType = typeof arg;\n\n            if (argType === 'string' || argType === 'number') {\n              classes.push(arg);\n            } else if (Array.isArray(arg)) {\n              classes.push(classNames.apply(null, arg));\n            } else if (argType === 'object') {\n              for (var key in arg) {\n                if (hasOwn.call(arg, key) && arg[key]) {\n                  classes.push(key);\n                }\n              }\n            }\n          }\n\n          return classes.join(' ');\n        }\n\n        if (typeof module !== 'undefined' && module.exports) {\n          module.exports = classNames;\n        } else if (true) {\n          // register as 'classnames', consistent with npm package name\n          !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function () {\n            return classNames;\n          }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n        } else {\n          window.classNames = classNames;\n        }\n      }());\n\n\n      /***/ },\n    /* 5 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      'use strict';\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n\n      var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n      exports.matchesSelector = matchesSelector;\n      exports.matchesSelectorAndParentsTo = matchesSelectorAndParentsTo;\n      exports.addEvent = addEvent;\n      exports.removeEvent = removeEvent;\n      exports.outerHeight = outerHeight;\n      exports.outerWidth = outerWidth;\n      exports.innerHeight = innerHeight;\n      exports.innerWidth = innerWidth;\n      exports.offsetXYFromParent = offsetXYFromParent;\n      exports.createCSSTransform = createCSSTransform;\n      exports.createSVGTransform = createSVGTransform;\n      exports.getTouch = getTouch;\n      exports.getTouchIdentifier = getTouchIdentifier;\n      exports.addUserSelectStyles = addUserSelectStyles;\n      exports.removeUserSelectStyles = removeUserSelectStyles;\n      exports.styleHacks = styleHacks;\n\n      var _shims = __webpack_require__(6);\n\n      var _getPrefix = __webpack_require__(7);\n\n      var _getPrefix2 = _interopRequireDefault(_getPrefix);\n\n      function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n      function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n      /*:: import type {ControlPosition} from './types';*/\n\n\n      var matchesSelectorFunc = '';\n      function matchesSelector(el /*: Node*/, selector /*: string*/) /*: boolean*/ {\n        if (!matchesSelectorFunc) {\n          matchesSelectorFunc = (0, _shims.findInArray)(['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'], function (method) {\n            // $FlowIgnore: Doesn't think elements are indexable\n            return (0, _shims.isFunction)(el[method]);\n          });\n        }\n\n        // $FlowIgnore: Doesn't think elements are indexable\n        return el[matchesSelectorFunc].call(el, selector);\n      }\n\n      // Works up the tree to the draggable itself attempting to match selector.\n      function matchesSelectorAndParentsTo(el /*: Node*/, selector /*: string*/, baseNode /*: Node*/) /*: boolean*/ {\n        var node = el;\n        do {\n          if (matchesSelector(node, selector)) return true;\n          if (node === baseNode) return false;\n          node = node.parentNode;\n        } while (node);\n\n        return false;\n      }\n\n      function addEvent(el /*: ?Node*/, event /*: string*/, handler /*: Function*/) /*: void*/ {\n        if (!el) {\n          return;\n        }\n        if (el.attachEvent) {\n          el.attachEvent('on' + event, handler);\n        } else if (el.addEventListener) {\n          el.addEventListener(event, handler, true);\n        } else {\n          // $FlowIgnore: Doesn't think elements are indexable\n          el['on' + event] = handler;\n        }\n      }\n\n      function removeEvent(el /*: ?Node*/, event /*: string*/, handler /*: Function*/) /*: void*/ {\n        if (!el) {\n          return;\n        }\n        if (el.detachEvent) {\n          el.detachEvent('on' + event, handler);\n        } else if (el.removeEventListener) {\n          el.removeEventListener(event, handler, true);\n        } else {\n          // $FlowIgnore: Doesn't think elements are indexable\n          el['on' + event] = null;\n        }\n      }\n\n      function outerHeight(node /*: HTMLElement*/) /*: number*/ {\n        // This is deliberately excluding margin for our calculations, since we are using\n        // offsetTop which is including margin. See getBoundPosition\n        var height = node.clientHeight;\n        var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n        height += (0, _shims.int)(computedStyle.borderTopWidth);\n        height += (0, _shims.int)(computedStyle.borderBottomWidth);\n        return height;\n      }\n\n      function outerWidth(node /*: HTMLElement*/) /*: number*/ {\n        // This is deliberately excluding margin for our calculations, since we are using\n        // offsetLeft which is including margin. See getBoundPosition\n        var width = node.clientWidth;\n        var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n        width += (0, _shims.int)(computedStyle.borderLeftWidth);\n        width += (0, _shims.int)(computedStyle.borderRightWidth);\n        return width;\n      }\n      function innerHeight(node /*: HTMLElement*/) /*: number*/ {\n        var height = node.clientHeight;\n        var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n        height -= (0, _shims.int)(computedStyle.paddingTop);\n        height -= (0, _shims.int)(computedStyle.paddingBottom);\n        return height;\n      }\n\n      function innerWidth(node /*: HTMLElement*/) /*: number*/ {\n        var width = node.clientWidth;\n        var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n        width -= (0, _shims.int)(computedStyle.paddingLeft);\n        width -= (0, _shims.int)(computedStyle.paddingRight);\n        return width;\n      }\n\n      // Get from offsetParent\n      function offsetXYFromParent(evt /*: {clientX: number, clientY: number}*/, offsetParent /*: HTMLElement*/) /*: ControlPosition*/ {\n        var isBody = offsetParent === offsetParent.ownerDocument.body;\n        var offsetParentRect = isBody ? { left: 0, top: 0 } : offsetParent.getBoundingClientRect();\n\n        var x = evt.clientX + offsetParent.scrollLeft - offsetParentRect.left;\n        var y = evt.clientY + offsetParent.scrollTop - offsetParentRect.top;\n\n        return { x: x, y: y };\n      }\n\n      function createCSSTransform(_ref) /*: Object*/ {\n        var x = _ref.x,\n          y = _ref.y;\n\n        // Replace unitless items with px\n        return _defineProperty({}, (0, _getPrefix.browserPrefixToKey)('transform', _getPrefix2.default), 'translate(' + x + 'px,' + y + 'px)');\n      }\n\n      function createSVGTransform(_ref3) /*: string*/ {\n        var x = _ref3.x,\n          y = _ref3.y;\n\n        return 'translate(' + x + ',' + y + ')';\n      }\n\n      function getTouch(e /*: MouseTouchEvent*/, identifier /*: number*/) /*: ?{clientX: number, clientY: number}*/ {\n        return e.targetTouches && (0, _shims.findInArray)(e.targetTouches, function (t) {\n            return identifier === t.identifier;\n          }) || e.changedTouches && (0, _shims.findInArray)(e.changedTouches, function (t) {\n            return identifier === t.identifier;\n          });\n      }\n\n      function getTouchIdentifier(e /*: MouseTouchEvent*/) /*: ?number*/ {\n        if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier;\n        if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier;\n      }\n\n      // User-select Hacks:\n      //\n      // Useful for preventing blue highlights all over everything when dragging.\n      var userSelectPrefix = (0, _getPrefix.getPrefix)('user-select');\n      var userSelect = (0, _getPrefix.browserPrefixToStyle)('user-select', userSelectPrefix);\n      var userSelectStyle = ';' + userSelect + ': none;';\n      var userSelectReplaceRegExp = new RegExp(';?' + userSelect + ': none;'); // leading ; not present on IE\n\n      // Note we're passing `document` b/c we could be iframed\n      function addUserSelectStyles(body /*: HTMLElement*/) {\n        var style = body.getAttribute('style') || '';\n        body.setAttribute('style', style + userSelectStyle);\n      }\n\n      function removeUserSelectStyles(body /*: HTMLElement*/) {\n        var style = body.getAttribute('style') || '';\n        body.setAttribute('style', style.replace(userSelectReplaceRegExp, ''));\n      }\n\n      function styleHacks() /*: Object*/ {\n        var childStyle /*: Object*/ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n        // Workaround IE pointer events; see #51\n        // https://github.com/mzabriskie/react-draggable/issues/51#issuecomment-103488278\n        return _extends({\n          touchAction: 'none'\n        }, childStyle);\n      }\n\n      /***/ },\n    /* 6 */\n    /***/ function(module, exports) {\n\n      'use strict';\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports.findInArray = findInArray;\n      exports.isFunction = isFunction;\n      exports.isNum = isNum;\n      exports.int = int;\n      exports.dontSetMe = dontSetMe;\n\n      // @credits https://gist.github.com/rogozhnikoff/a43cfed27c41e4e68cdc\n      function findInArray(array /*: Array<any> | TouchList*/, callback /*: Function*/) /*: any*/ {\n        for (var i = 0, length = array.length; i < length; i++) {\n          if (callback.apply(callback, [array[i], i, array])) return array[i];\n        }\n      }\n\n      function isFunction(func /*: any*/) /*: boolean*/ {\n        return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]';\n      }\n\n      function isNum(num /*: any*/) /*: boolean*/ {\n        return typeof num === 'number' && !isNaN(num);\n      }\n\n      function int(a /*: string*/) /*: number*/ {\n        return parseInt(a, 10);\n      }\n\n      function dontSetMe(props /*: Object*/, propName /*: string*/, componentName /*: string*/) {\n        if (props[propName]) {\n          return new Error('Invalid prop ' + propName + ' passed to ' + componentName + ' - do not set this, set it on the child.');\n        }\n      }\n\n      /***/ },\n    /* 7 */\n    /***/ function(module, exports) {\n\n      'use strict';\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports.getPrefix = getPrefix;\n      exports.browserPrefixToKey = browserPrefixToKey;\n      exports.browserPrefixToStyle = browserPrefixToStyle;\n      var prefixes = ['Moz', 'Webkit', 'O', 'ms'];\n      function getPrefix() /*: string*/ {\n        var prop /*: string*/ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'transform';\n\n        // Checking specifically for 'window.document' is for pseudo-browser server-side\n        // environments that define 'window' as the global context.\n        // E.g. React-rails (see https://github.com/reactjs/react-rails/pull/84)\n        if (typeof window === 'undefined' || typeof window.document === 'undefined') return '';\n\n        var style = window.document.documentElement.style;\n\n        if (prop in style) return '';\n\n        for (var i = 0; i < prefixes.length; i++) {\n          if (browserPrefixToKey(prop, prefixes[i]) in style) return prefixes[i];\n        }\n\n        return '';\n      }\n\n      function browserPrefixToKey(prop /*: string*/, prefix /*: string*/) /*: string*/ {\n        return prefix ? '' + prefix + kebabToTitleCase(prop) : prop;\n      }\n\n      function browserPrefixToStyle(prop /*: string*/, prefix /*: string*/) /*: string*/ {\n        return prefix ? '-' + prefix.toLowerCase() + '-' + prop : prop;\n      }\n\n      function kebabToTitleCase(str /*: string*/) /*: string*/ {\n        var out = '';\n        var shouldCapitalize = true;\n        for (var i = 0; i < str.length; i++) {\n          if (shouldCapitalize) {\n            out += str[i].toUpperCase();\n            shouldCapitalize = false;\n          } else if (str[i] === '-') {\n            shouldCapitalize = true;\n          } else {\n            out += str[i];\n          }\n        }\n        return out;\n      }\n\n      // Default export is the prefix itself, like 'Moz', 'Webkit', etc\n      // Note that you may have to re-test for certain things; for instance, Chrome 50\n      // can handle unprefixed `transform`, but not unprefixed `user-select`\n      exports.default = getPrefix();\n\n      /***/ },\n    /* 8 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      'use strict';\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports.getBoundPosition = getBoundPosition;\n      exports.snapToGrid = snapToGrid;\n      exports.canDragX = canDragX;\n      exports.canDragY = canDragY;\n      exports.getControlPosition = getControlPosition;\n      exports.createCoreData = createCoreData;\n      exports.createDraggableData = createDraggableData;\n\n      var _shims = __webpack_require__(6);\n\n      var _reactDom = __webpack_require__(3);\n\n      var _reactDom2 = _interopRequireDefault(_reactDom);\n\n      var _domFns = __webpack_require__(5);\n\n      function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n      /*:: import type Draggable from '../Draggable';*/\n      /*:: import type {Bounds, ControlPosition, DraggableData} from './types';*/\n      /*:: import type DraggableCore from '../DraggableCore';*/\n      function getBoundPosition(draggable /*: Draggable*/, x /*: number*/, y /*: number*/) /*: [number, number]*/ {\n        // If no bounds, short-circuit and move on\n        if (!draggable.props.bounds) return [x, y];\n\n        // Clone new bounds\n        var bounds = draggable.props.bounds;\n\n        bounds = typeof bounds === 'string' ? bounds : cloneBounds(bounds);\n        var node = _reactDom2.default.findDOMNode(draggable);\n\n        if (typeof bounds === 'string') {\n          var ownerDocument = node.ownerDocument;\n\n          var ownerWindow = ownerDocument.defaultView;\n          var boundNode = void 0;\n          if (bounds === 'parent') {\n            boundNode = node.parentNode;\n          } else {\n            boundNode = ownerDocument.querySelector(bounds);\n            if (!boundNode) throw new Error('Bounds selector \"' + bounds + '\" could not find an element.');\n          }\n          var nodeStyle = ownerWindow.getComputedStyle(node);\n          var boundNodeStyle = ownerWindow.getComputedStyle(boundNode);\n          // Compute bounds. This is a pain with padding and offsets but this gets it exactly right.\n          bounds = {\n            left: -node.offsetLeft + (0, _shims.int)(boundNodeStyle.paddingLeft) + (0, _shims.int)(nodeStyle.borderLeftWidth) + (0, _shims.int)(nodeStyle.marginLeft),\n            top: -node.offsetTop + (0, _shims.int)(boundNodeStyle.paddingTop) + (0, _shims.int)(nodeStyle.borderTopWidth) + (0, _shims.int)(nodeStyle.marginTop),\n            right: (0, _domFns.innerWidth)(boundNode) - (0, _domFns.outerWidth)(node) - node.offsetLeft,\n            bottom: (0, _domFns.innerHeight)(boundNode) - (0, _domFns.outerHeight)(node) - node.offsetTop\n          };\n        }\n\n        // Keep x and y below right and bottom limits...\n        if ((0, _shims.isNum)(bounds.right)) x = Math.min(x, bounds.right);\n        if ((0, _shims.isNum)(bounds.bottom)) y = Math.min(y, bounds.bottom);\n\n        // But above left and top limits.\n        if ((0, _shims.isNum)(bounds.left)) x = Math.max(x, bounds.left);\n        if ((0, _shims.isNum)(bounds.top)) y = Math.max(y, bounds.top);\n\n        return [x, y];\n      }\n\n      function snapToGrid(grid /*: [number, number]*/, pendingX /*: number*/, pendingY /*: number*/) /*: [number, number]*/ {\n        var x = Math.round(pendingX / grid[0]) * grid[0];\n        var y = Math.round(pendingY / grid[1]) * grid[1];\n        return [x, y];\n      }\n\n      function canDragX(draggable /*: Draggable*/) /*: boolean*/ {\n        return draggable.props.axis === 'both' || draggable.props.axis === 'x';\n      }\n\n      function canDragY(draggable /*: Draggable*/) /*: boolean*/ {\n        return draggable.props.axis === 'both' || draggable.props.axis === 'y';\n      }\n\n      // Get {x, y} positions from event.\n      function getControlPosition(e /*: MouseTouchEvent*/, touchIdentifier /*: ?number*/, draggableCore /*: DraggableCore*/) /*: ?ControlPosition*/ {\n        var touchObj = typeof touchIdentifier === 'number' ? (0, _domFns.getTouch)(e, touchIdentifier) : null;\n        if (typeof touchIdentifier === 'number' && !touchObj) return null; // not the right touch\n        var node = _reactDom2.default.findDOMNode(draggableCore);\n        // User can provide an offsetParent if desired.\n        var offsetParent = draggableCore.props.offsetParent || node.offsetParent || node.ownerDocument.body;\n        return (0, _domFns.offsetXYFromParent)(touchObj || e, offsetParent);\n      }\n\n      // Create an data object exposed by <DraggableCore>'s events\n      function createCoreData(draggable /*: DraggableCore*/, x /*: number*/, y /*: number*/) /*: DraggableData*/ {\n        var state = draggable.state;\n        var isStart = !(0, _shims.isNum)(state.lastX);\n\n        if (isStart) {\n          // If this is our first move, use the x and y as last coords.\n          return {\n            node: _reactDom2.default.findDOMNode(draggable),\n            deltaX: 0, deltaY: 0,\n            lastX: x, lastY: y,\n            x: x, y: y\n          };\n        } else {\n          // Otherwise calculate proper values.\n          return {\n            node: _reactDom2.default.findDOMNode(draggable),\n            deltaX: x - state.lastX, deltaY: y - state.lastY,\n            lastX: state.lastX, lastY: state.lastY,\n            x: x, y: y\n          };\n        }\n      }\n\n      // Create an data exposed by <Draggable>'s events\n      function createDraggableData(draggable /*: Draggable*/, coreData /*: DraggableData*/) /*: DraggableData*/ {\n        var scale = draggable.props.scale;\n        return {\n          node: coreData.node,\n          x: draggable.state.x + coreData.deltaX / scale,\n          y: draggable.state.y + coreData.deltaY / scale,\n          deltaX: coreData.deltaX / scale,\n          deltaY: coreData.deltaY / scale,\n          lastX: draggable.state.x,\n          lastY: draggable.state.y\n        };\n      }\n\n      // A lot faster than stringify/parse\n      function cloneBounds(bounds /*: Bounds*/) /*: Bounds*/ {\n        return {\n          left: bounds.left,\n          top: bounds.top,\n          right: bounds.right,\n          bottom: bounds.bottom\n        };\n      }\n\n      /***/ },\n    /* 9 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      /* WEBPACK VAR INJECTION */(function(process) {'use strict';\n\n        Object.defineProperty(exports, \"__esModule\", {\n          value: true\n        });\n\n        var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n        var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n        var _react = __webpack_require__(2);\n\n        var _react2 = _interopRequireDefault(_react);\n\n        var _reactDom = __webpack_require__(3);\n\n        var _reactDom2 = _interopRequireDefault(_reactDom);\n\n        var _domFns = __webpack_require__(5);\n\n        var _positionFns = __webpack_require__(8);\n\n        var _shims = __webpack_require__(6);\n\n        var _log = __webpack_require__(11);\n\n        var _log2 = _interopRequireDefault(_log);\n\n        function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n        function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n        function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\n        function _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n        // Simple abstraction for dragging events names.\n        /*:: import type {EventHandler} from './utils/types';*/\n        var eventsFor = {\n          touch: {\n            start: 'touchstart',\n            move: 'touchmove',\n            stop: 'touchend'\n          },\n          mouse: {\n            start: 'mousedown',\n            move: 'mousemove',\n            stop: 'mouseup'\n          }\n        };\n\n        // Default to mouse events.\n        var dragEventFor = eventsFor.mouse;\n\n        //\n        // Define <DraggableCore>.\n        //\n        // <DraggableCore> is for advanced usage of <Draggable>. It maintains minimal internal state so it can\n        // work well with libraries that require more control over the element.\n        //\n\n        /*:: type CoreState = {\n         dragging: boolean,\n         lastX: number,\n         lastY: number,\n         touchIdentifier: ?number\n         };*/\n\n        var DraggableCore = function (_React$Component) {\n          _inherits(DraggableCore, _React$Component);\n\n          function DraggableCore() {\n            var _ref;\n\n            var _temp, _this, _ret;\n\n            _classCallCheck(this, DraggableCore);\n\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = DraggableCore.__proto__ || Object.getPrototypeOf(DraggableCore)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n              dragging: false,\n              // Used while dragging to determine deltas.\n              lastX: NaN, lastY: NaN,\n              touchIdentifier: null\n            }, _this.handleDragStart = function (e) {\n              // Make it possible to attach event handlers on top of this one.\n              _this.props.onMouseDown(e);\n\n              // Only accept left-clicks.\n              if (!_this.props.allowAnyClick && typeof e.button === 'number' && e.button !== 0) return false;\n\n              // Get nodes. Be sure to grab relative document (could be iframed)\n              var domNode = _reactDom2.default.findDOMNode(_this);\n              var ownerDocument = domNode.ownerDocument;\n\n              // Short circuit if handle or cancel prop was provided and selector doesn't match.\n\n              if (_this.props.disabled || !(e.target instanceof ownerDocument.defaultView.Node) || _this.props.handle && !(0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.handle, domNode) || _this.props.cancel && (0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.cancel, domNode)) {\n                return;\n              }\n\n              // Set touch identifier in component state if this is a touch event. This allows us to\n              // distinguish between individual touches on multitouch screens by identifying which\n              // touchpoint was set to this element.\n              var touchIdentifier = (0, _domFns.getTouchIdentifier)(e);\n              _this.setState({ touchIdentifier: touchIdentifier });\n\n              // Get the current drag point from the event. This is used as the offset.\n              var position = (0, _positionFns.getControlPosition)(e, touchIdentifier, _this);\n              if (position == null) return; // not possible but satisfies flow\n              var x = position.x,\n                y = position.y;\n\n              // Create an event object with all the data parents need to make a decision here.\n\n              var coreEvent = (0, _positionFns.createCoreData)(_this, x, y);\n\n              (0, _log2.default)('DraggableCore: handleDragStart: %j', coreEvent);\n\n              // Call event handler. If it returns explicit false, cancel.\n              (0, _log2.default)('calling', _this.props.onStart);\n              var shouldUpdate = _this.props.onStart(e, coreEvent);\n              if (shouldUpdate === false) return;\n\n              // Add a style to the body to disable user-select. This prevents text from\n              // being selected all over the page.\n              if (_this.props.enableUserSelectHack) (0, _domFns.addUserSelectStyles)(ownerDocument.body);\n\n              // Initiate dragging. Set the current x and y as offsets\n              // so we know how much we've moved during the drag. This allows us\n              // to drag elements around even if they have been moved, without issue.\n              _this.setState({\n                dragging: true,\n\n                lastX: x,\n                lastY: y\n              });\n\n              // Add events to the document directly so we catch when the user's mouse/touch moves outside of\n              // this element. We use different events depending on whether or not we have detected that this\n              // is a touch-capable device.\n              (0, _domFns.addEvent)(ownerDocument, dragEventFor.move, _this.handleDrag);\n              (0, _domFns.addEvent)(ownerDocument, dragEventFor.stop, _this.handleDragStop);\n            }, _this.handleDrag = function (e) {\n\n              // Prevent scrolling on mobile devices, like ipad/iphone.\n              if (e.type === 'touchmove') e.preventDefault();\n\n              // Get the current drag point from the event. This is used as the offset.\n              var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _this);\n              if (position == null) return;\n              var x = position.x,\n                y = position.y;\n\n              // Snap to grid if prop has been provided\n\n              if (x !== x) debugger;\n\n              if (Array.isArray(_this.props.grid)) {\n                var deltaX = x - _this.state.lastX,\n                  deltaY = y - _this.state.lastY;\n\n                var _snapToGrid = (0, _positionFns.snapToGrid)(_this.props.grid, deltaX, deltaY);\n\n                var _snapToGrid2 = _slicedToArray(_snapToGrid, 2);\n\n                deltaX = _snapToGrid2[0];\n                deltaY = _snapToGrid2[1];\n\n                if (!deltaX && !deltaY) return; // skip useless drag\n                x = _this.state.lastX + deltaX, y = _this.state.lastY + deltaY;\n              }\n\n              var coreEvent = (0, _positionFns.createCoreData)(_this, x, y);\n\n              (0, _log2.default)('DraggableCore: handleDrag: %j', coreEvent);\n\n              // Call event handler. If it returns explicit false, trigger end.\n              var shouldUpdate = _this.props.onDrag(e, coreEvent);\n              if (shouldUpdate === false) {\n                try {\n                  // $FlowIgnore\n                  _this.handleDragStop(new MouseEvent('mouseup'));\n                } catch (err) {\n                  // Old browsers\n                  var event = ((document.createEvent('MouseEvents') /*: any*/) /*: MouseTouchEvent*/);\n                  // I see why this insanity was deprecated\n                  // $FlowIgnore\n                  event.initMouseEvent('mouseup', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n                  _this.handleDragStop(event);\n                }\n                return;\n              }\n\n              _this.setState({\n                lastX: x,\n                lastY: y\n              });\n            }, _this.handleDragStop = function (e) {\n              if (!_this.state.dragging) return;\n\n              var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _this);\n              if (position == null) return;\n              var x = position.x,\n                y = position.y;\n\n              var coreEvent = (0, _positionFns.createCoreData)(_this, x, y);\n\n              var _ReactDOM$findDOMNode = _reactDom2.default.findDOMNode(_this),\n                ownerDocument = _ReactDOM$findDOMNode.ownerDocument;\n\n              // Remove user-select hack\n\n\n              if (_this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(ownerDocument.body);\n\n              (0, _log2.default)('DraggableCore: handleDragStop: %j', coreEvent);\n\n              // Reset the el.\n              _this.setState({\n                dragging: false,\n                lastX: NaN,\n                lastY: NaN\n              });\n\n              // Call event handler\n              _this.props.onStop(e, coreEvent);\n\n              // Remove event handlers\n              (0, _log2.default)('DraggableCore: Removing handlers');\n              (0, _domFns.removeEvent)(ownerDocument, dragEventFor.move, _this.handleDrag);\n              (0, _domFns.removeEvent)(ownerDocument, dragEventFor.stop, _this.handleDragStop);\n            }, _this.onMouseDown = function (e) {\n              dragEventFor = eventsFor.mouse; // on touchscreen laptops we could switch back to mouse\n\n              return _this.handleDragStart(e);\n            }, _this.onMouseUp = function (e) {\n              dragEventFor = eventsFor.mouse;\n\n              return _this.handleDragStop(e);\n            }, _this.onTouchStart = function (e) {\n              // We're on a touch device now, so change the event handlers\n              dragEventFor = eventsFor.touch;\n\n              return _this.handleDragStart(e);\n            }, _this.onTouchEnd = function (e) {\n              // We're on a touch device now, so change the event handlers\n              dragEventFor = eventsFor.touch;\n\n              return _this.handleDragStop(e);\n            }, _temp), _possibleConstructorReturn(_this, _ret);\n          }\n\n          _createClass(DraggableCore, [{\n            key: 'componentWillUnmount',\n            value: function componentWillUnmount() {\n              // Remove any leftover event handlers. Remove both touch and mouse handlers in case\n              // some browser quirk caused a touch event to fire during a mouse move, or vice versa.\n              var _ReactDOM$findDOMNode2 = _reactDom2.default.findDOMNode(this),\n                ownerDocument = _ReactDOM$findDOMNode2.ownerDocument;\n\n              (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.move, this.handleDrag);\n              (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.move, this.handleDrag);\n              (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.stop, this.handleDragStop);\n              (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.stop, this.handleDragStop);\n              if (this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(ownerDocument.body);\n            }\n\n            // Same as onMouseDown (start drag), but now consider this a touch device.\n\n          }, {\n            key: 'render',\n            value: function render() /*: React.Element<any>*/ {\n              // Reuse the child provided\n              // This makes it flexible to use whatever element is wanted (div, ul, etc)\n              return _react2.default.cloneElement(_react2.default.Children.only(this.props.children), {\n                style: (0, _domFns.styleHacks)(this.props.children.props.style),\n\n                // Note: mouseMove handler is attached to document so it will still function\n                // when the user drags quickly and leaves the bounds of the element.\n                onMouseDown: this.onMouseDown,\n                onTouchStart: this.onTouchStart,\n                onMouseUp: this.onMouseUp,\n                onTouchEnd: this.onTouchEnd\n              });\n            }\n          }]);\n\n          return DraggableCore;\n        }(_react2.default.Component);\n\n        DraggableCore.displayName = 'DraggableCore';\n        DraggableCore.propTypes = {\n          /**\n           * `allowAnyClick` allows dragging using any mouse button.\n           * By default, we only accept the left button.\n           *\n           * Defaults to `false`.\n           */\n          allowAnyClick: _react.PropTypes.bool,\n\n          /**\n           * `disabled`, if true, stops the <Draggable> from dragging. All handlers,\n           * with the exception of `onMouseDown`, will not fire.\n           */\n          disabled: _react.PropTypes.bool,\n\n          /**\n           * By default, we add 'user-select:none' attributes to the document body\n           * to prevent ugly text selection during drag. If this is causing problems\n           * for your app, set this to `false`.\n           */\n          enableUserSelectHack: _react.PropTypes.bool,\n\n          /**\n           * `offsetParent`, if set, uses the passed DOM node to compute drag offsets\n           * instead of using the parent node.\n           */\n          offsetParent: function offsetParent(props, propName) {\n            if (process.browser && props[propName] && props[propName].nodeType !== 1) {\n              throw new Error('Draggable\\'s offsetParent must be a DOM Node.');\n            }\n          },\n\n          /**\n           * `grid` specifies the x and y that dragging should snap to.\n           */\n          grid: _react.PropTypes.arrayOf(_react.PropTypes.number),\n\n          /**\n           * `scale` specifies the scale of the area you are dragging inside of. It allows\n           * the drag deltas to scale correctly with how far zoomed in/out you are.\n           */\n          scale: _react.PropTypes.number,\n\n          /**\n           * `handle` specifies a selector to be used as the handle that initiates drag.\n           *\n           * Example:\n           *\n           * ```jsx\n           *   let App = React.createClass({\n\t   *       render: function () {\n\t   *         return (\n\t   *            <Draggable handle=\".handle\">\n\t   *              <div>\n\t   *                  <div className=\"handle\">Click me to drag</div>\n\t   *                  <div>This is some other content</div>\n\t   *              </div>\n\t   *           </Draggable>\n\t   *         );\n\t   *       }\n\t   *   });\n           * ```\n           */\n          handle: _react.PropTypes.string,\n\n          /**\n           * `cancel` specifies a selector to be used to prevent drag initialization.\n           *\n           * Example:\n           *\n           * ```jsx\n           *   let App = React.createClass({\n\t   *       render: function () {\n\t   *           return(\n\t   *               <Draggable cancel=\".cancel\">\n\t   *                   <div>\n\t   *                     <div className=\"cancel\">You can't drag from here</div>\n\t   *                     <div>Dragging here works fine</div>\n\t   *                   </div>\n\t   *               </Draggable>\n\t   *           );\n\t   *       }\n\t   *   });\n           * ```\n           */\n          cancel: _react.PropTypes.string,\n\n          /**\n           * Called when dragging starts.\n           * If this function returns the boolean false, dragging will be canceled.\n           */\n          onStart: _react.PropTypes.func,\n\n          /**\n           * Called while dragging.\n           * If this function returns the boolean false, dragging will be canceled.\n           */\n          onDrag: _react.PropTypes.func,\n\n          /**\n           * Called when dragging stops.\n           * If this function returns the boolean false, the drag will remain active.\n           */\n          onStop: _react.PropTypes.func,\n\n          /**\n           * A workaround option which can be passed if onMouseDown needs to be accessed,\n           * since it'll always be blocked (as there is internal use of onMouseDown)\n           */\n          onMouseDown: _react.PropTypes.func,\n\n          /**\n           * These properties should be defined on the child, not here.\n           */\n          className: _shims.dontSetMe,\n          style: _shims.dontSetMe,\n          transform: _shims.dontSetMe\n        };\n        DraggableCore.defaultProps = {\n          allowAnyClick: false, // by default only accept left click\n          cancel: null,\n          disabled: false,\n          enableUserSelectHack: true,\n          offsetParent: null,\n          handle: null,\n          grid: null,\n          transform: null,\n          onStart: function onStart() {},\n          onDrag: function onDrag() {},\n          onStop: function onStop() {},\n          onMouseDown: function onMouseDown() {}\n        };\n        exports.default = DraggableCore;\n        /* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(10)))\n\n      /***/ },\n    /* 10 */\n    /***/ function(module, exports) {\n\n      // shim for using process in browser\n      var process = module.exports = {};\n\n      // cached from whatever global is present so that test runners that stub it\n      // don't break things.  But we need to wrap it in a try catch in case it is\n      // wrapped in strict mode code which doesn't define any globals.  It's inside a\n      // function because try/catches deoptimize in certain engines.\n\n      var cachedSetTimeout;\n      var cachedClearTimeout;\n\n      function defaultSetTimout() {\n        throw new Error('setTimeout has not been defined');\n      }\n      function defaultClearTimeout () {\n        throw new Error('clearTimeout has not been defined');\n      }\n      (function () {\n        try {\n          if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n          } else {\n            cachedSetTimeout = defaultSetTimout;\n          }\n        } catch (e) {\n          cachedSetTimeout = defaultSetTimout;\n        }\n        try {\n          if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n          } else {\n            cachedClearTimeout = defaultClearTimeout;\n          }\n        } catch (e) {\n          cachedClearTimeout = defaultClearTimeout;\n        }\n      } ())\n      function runTimeout(fun) {\n        if (cachedSetTimeout === setTimeout) {\n          //normal enviroments in sane situations\n          return setTimeout(fun, 0);\n        }\n        // if setTimeout wasn't available but was latter defined\n        if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n          cachedSetTimeout = setTimeout;\n          return setTimeout(fun, 0);\n        }\n        try {\n          // when when somebody has screwed with setTimeout but no I.E. maddness\n          return cachedSetTimeout(fun, 0);\n        } catch(e){\n          try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n          } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n          }\n        }\n\n\n      }\n      function runClearTimeout(marker) {\n        if (cachedClearTimeout === clearTimeout) {\n          //normal enviroments in sane situations\n          return clearTimeout(marker);\n        }\n        // if clearTimeout wasn't available but was latter defined\n        if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n          cachedClearTimeout = clearTimeout;\n          return clearTimeout(marker);\n        }\n        try {\n          // when when somebody has screwed with setTimeout but no I.E. maddness\n          return cachedClearTimeout(marker);\n        } catch (e){\n          try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n          } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n          }\n        }\n\n\n\n      }\n      var queue = [];\n      var draining = false;\n      var currentQueue;\n      var queueIndex = -1;\n\n      function cleanUpNextTick() {\n        if (!draining || !currentQueue) {\n          return;\n        }\n        draining = false;\n        if (currentQueue.length) {\n          queue = currentQueue.concat(queue);\n        } else {\n          queueIndex = -1;\n        }\n        if (queue.length) {\n          drainQueue();\n        }\n      }\n\n      function drainQueue() {\n        if (draining) {\n          return;\n        }\n        var timeout = runTimeout(cleanUpNextTick);\n        draining = true;\n\n        var len = queue.length;\n        while(len) {\n          currentQueue = queue;\n          queue = [];\n          while (++queueIndex < len) {\n            if (currentQueue) {\n              currentQueue[queueIndex].run();\n            }\n          }\n          queueIndex = -1;\n          len = queue.length;\n        }\n        currentQueue = null;\n        draining = false;\n        runClearTimeout(timeout);\n      }\n\n      process.nextTick = function (fun) {\n        var args = new Array(arguments.length - 1);\n        if (arguments.length > 1) {\n          for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n          }\n        }\n        queue.push(new Item(fun, args));\n        if (queue.length === 1 && !draining) {\n          runTimeout(drainQueue);\n        }\n      };\n\n      // v8 likes predictible objects\n      function Item(fun, array) {\n        this.fun = fun;\n        this.array = array;\n      }\n      Item.prototype.run = function () {\n        this.fun.apply(null, this.array);\n      };\n      process.title = 'browser';\n      process.browser = true;\n      process.env = {};\n      process.argv = [];\n      process.version = ''; // empty string to avoid regexp issues\n      process.versions = {};\n\n      function noop() {}\n\n      process.on = noop;\n      process.addListener = noop;\n      process.once = noop;\n      process.off = noop;\n      process.removeListener = noop;\n      process.removeAllListeners = noop;\n      process.emit = noop;\n\n      process.binding = function (name) {\n        throw new Error('process.binding is not supported');\n      };\n\n      process.cwd = function () { return '/' };\n      process.chdir = function (dir) {\n        throw new Error('process.chdir is not supported');\n      };\n      process.umask = function() { return 0; };\n\n\n      /***/ },\n    /* 11 */\n    /***/ function(module, exports, __webpack_require__) {\n\n      \"use strict\";\n\n      Object.defineProperty(exports, \"__esModule\", {\n        value: true\n      });\n      exports.default = log;\n\n      /*eslint no-console:0*/\n      function log() {\n        var _console;\n\n        if ((undefined)) (_console = console).log.apply(_console, arguments);\n      }\n\n      /***/ }\n    /******/ ])\n});\n;\n//# sourceMappingURL=react-draggable.js.map\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/patches/react-draggable.js","import React, { Component } from 'react';\n\n\nexport default function withFixedScale(WrappedComponent) {\n\n  return class extends Component {\n    render() {\n\n      if (!this.props.canvasScale) {\n        return <WrappedComponent {...this.props}/>\n      }\n      return (\n        <WrappedComponent style={{ transform: `scale(${1/this.props.canvasScale})` }} {...this.props}/>\n      );\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/openseadragon/withFixedScale.js","import BEM from 'digirati-bem-js';\nimport React, {PureComponent} from 'react';\nimport './WholeCanvasSelector.scss';\n\nconst style = BEM.block('whole-canvas-selector');\n\nclass WholeCanvasSelector extends PureComponent {\n\n  // propTypes = {\n  //   skipConfirm: PropTypes.bool,\n  //   onSave: PropTypes.func.isRequired,\n  //   onCancel: PropTypes.func, // unused\n  // };\n\n  componentDidMount() {\n    const { skipConfirm = true } = this.props;\n    if (skipConfirm) {\n      this.props.onSave();\n    }\n  }\n\n  render() {\n    return (\n      <div />\n    );\n  }\n}\n\nexport default WholeCanvasSelector;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/selectors/WholeCanvasSelector.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./WholeCanvasSelector.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./WholeCanvasSelector.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./WholeCanvasSelector.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/selectors/WholeCanvasSelector.scss\n// module id = 651\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".whole-canvas-selector {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0; }\\n  .whole-canvas-selector__button {\\n    position: absolute;\\n    width: 100px;\\n    left: 50%;\\n    margin-left: -50px;\\n    top: 50%;\\n    z-index: 10; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/selectors/WholeCanvasSelector.scss\n// module id = 652\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Form.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Form.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Form.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/Form.scss\n// module id = 653\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".input-form__error {\\n  padding: 5px;\\n  border: 3px solid crimson;\\n  color: crimson;\\n  background: #FFF0F0;\\n  margin: 10px; }\\n  .input-form__error--hidden {\\n    display: none; }\\n\\n.input-form__group {\\n  border: 2px solid #DDD;\\n  padding: 20px;\\n  margin-bottom: 10px; }\\n  .input-form__group--defaultGroup {\\n    border-width: 0;\\n    padding: 0;\\n    margin-bottom: 10px; }\\n\\n.input-form__group-name {\\n  font-weight: bold;\\n  margin-bottom: 14px;\\n  font-size: 1.4em; }\\n\\n.input-form__group-fields {\\n  display: none; }\\n\\n.input-form__group-fields--open {\\n  display: block; }\\n\\n.input-form__group-fields--defaultGroup {\\n  display: block; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/Form.scss\n// module id = 654\n// module chunks = 0","import React, { Component } from 'react';\nimport FormField from './FormField';\n\nexport default class FormGroup extends Component {\n\n  static DEFAULT_GROUP = 'defaultGroup';\n\n  state = {\n    isOpen: false,\n  };\n\n  toggle = () => this.setState({ isOpen: !this.state.isOpen });\n\n  render() {\n    const { groupKey, style, group, fields, draft, ...props } = this.props;\n    const { isOpen } = this.state;\n    const groupClass = groupKey === FormGroup.DEFAULT_GROUP || isOpen;\n    const groupKeyClass = groupKey.replace(/ /g, '-');\n\n    return (\n      <div\n        className={style.element('group').modifiers({ [groupKeyClass]: true, open: groupClass })}>\n        {groupKey !== FormGroup.DEFAULT_GROUP ? (\n          <div onClick={this.toggle}\n               className={style.element('group-name').modifiers({ [groupKeyClass]: true, open: isOpen })}>\n            {group.label}\n          </div>\n        ) : null}\n        <div className={style.element('group-fields').modifiers({ [groupKeyClass]: true, open: isOpen })}>\n          {fields.map(field =>\n            (draft.isPreviewing && (!draft.input[field.id]) ) ? null :\n            <FormField\n              key={field.id}\n              currentDraft={draft}\n              draftId={draft.id}\n              field={field}\n              value={draft.input[field.id]}\n              preview={draft.isPreviewing}\n              {...props}\n            />)}\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/FormGroup.js","import React, { PureComponent } from 'react';\nimport Autocomplete from './Autocomplete';\nimport DatePicker from './DatePicker';\nimport DropDown from './DropDown';\nimport GoogleMapSearch from './GoogleMapSearch';\nimport TextArea from './TextArea';\nimport TextBox from './TextBox';\nimport Fallback from './Fallback';\nimport Hidden from './Hidden';\nimport NullableCaptureModel from './NullableCaptureModel';\nimport VALIDATION_MAP from '../domain/validation';\nimport EmbeddedResourceEditor from './EmbeddedResourceEditor';\n\nexport default class FormField extends PureComponent {\n\n  update(validate, field) {\n    const { updateField } = this.props;\n    return (value) => {\n      // if (validate) {\n      //   const validation = validate(value);\n      //   if (!validation.isValid) {\n      //     this.setState({error: validation.message});\n      //   } else {\n      //     if (this.state.error) {\n      //       this.setState({error: null});\n      //     }\n      //   }\n      // }\n      updateField(field, value);\n    };\n  }\n\n  render() {\n    const { field, draftId, ...allProps } = this.props;\n    const validation = ( field.metaData && field.metaData.conformsTo ) ? VALIDATION_MAP[field.metaData.conformsTo.id] : null;\n    const update = this.update(validation, field).bind(this);\n    const props = {\n      key: `${field.id}-${draftId}`,\n      update,\n      ...allProps,\n      ...field\n    };\n    switch (field.inputType) {\n      case 'madoc:autocomplete':\n        if (field.annotationMetaData.autocomplete) {\n            return <Autocomplete key={props.id} {...props} suggestionProvider={(value) => {\n                const url = field.annotationMetaData.autocomplete + '&q=' + encodeURIComponent(value);\n\n                return fetch(url)\n                    .then(result => result.json())\n                    .then(response => response.completions);\n            }}/>;\n        }\n        return <TextBox key={props.id} {...props}/>;\n      case 'madoc:dropdown':\n        if (field.annotationMetaData.options) {\n          return <DropDown key={props.id} options={field.annotationMetaData.options} {...props}/>;\n        }\n        return <TextBox key={props.id} {...props}/>;\n      case 'madoc:textarea':\n        return <TextArea key={props.id} {...props}/>;\n      case 'madoc:datepicker':\n        return <DatePicker key={props.id} {...props}/>;\n      case 'madoc:map':\n      case 'madoc:mappicker':\n        return <GoogleMapSearch key={props.id} {...props}/>;\n      case 'madoc:nullableCaptureModel':\n        return <NullableCaptureModel key={props.id} {...props}/>;\n      case 'madoc:resource':\n        return <EmbeddedResourceEditor key={props.id} {...props}/>;\n      case 'madoc:hiddenvalue':\n        return <Hidden key={props.id} {...props}/>\n      case 'madoc:fallbackOptions':\n        const isOption = name => (option) => option['o:label'] === name;\n        let opts = field.annotationMetaData.options || [];\n        let autocomplete = opts.find(isOption('autocomplete'));\n        let captureModel = opts.find(isOption('captureModel'));\n\n        if (!captureModel || !autocomplete) {\n          console.warn('Unable to create Fallback component, missing autocomplete or captureModel options');\n          return null;\n        }\n\n        return <Fallback autocomplete={autocomplete} captureModel={captureModel} key={props.id} {...props}/>;\n      case 'madoc:textbox':\n      default:\n        return <TextBox key={props.id} {...props}/>;\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/FormField.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./HelpTooltip.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./HelpTooltip.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./HelpTooltip.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/ui/HelpTooltip.scss\n// module id = 657\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".help-tooltip {\\n  position: relative; }\\n  .help-tooltip__tooltip {\\n    display: none; }\\n  .help-tooltip__label {\\n    font-size: 0.8em; }\\n    .help-tooltip__label:after {\\n      content: '[?]'; }\\n  .help-tooltip:hover .help-tooltip__tooltip {\\n    display: block;\\n    position: absolute;\\n    top: 10px;\\n    left: 10px;\\n    width: auto;\\n    min-width: 160px;\\n    padding: 5px;\\n    margin-top: 3px;\\n    margin-left: 3px;\\n    background: rgba(238, 238, 238, 0.8);\\n    font-weight: initial;\\n    font-size: 0.8em;\\n    z-index: 10; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/ui/HelpTooltip.scss\n// module id = 658\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Autocomplete.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Autocomplete.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Autocomplete.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/Autocomplete.scss\n// module id = 663\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".autocomplete__suggestions {\\n  display: none;\\n  position: absolute;\\n  width: 100%;\\n  background: #fff;\\n  border: 1px solid #EEE;\\n  border-radius: 0 0 5px 5px;\\n  padding: 0;\\n  margin: 0;\\n  max-height: 300px;\\n  overflow-y: auto; }\\n  .autocomplete__suggestions:hover {\\n    display: block; }\\n  .autocomplete__suggestions li {\\n    padding: 3px;\\n    list-style: none; }\\n    .autocomplete__suggestions li:hover {\\n      background: #ddd; }\\n\\n.autocomplete__suggestions:empty {\\n  border: none; }\\n\\n.autocomplete__input {\\n  font-size: 14px;\\n  width: 100%;\\n  padding: 12px;\\n  border: 2px solid #c1c7ca !important;\\n  font-weight: bold;\\n  margin-bottom: 10px;\\n  background-color: #FFF; }\\n  .autocomplete__input:focus ~ .autocomplete__suggestions {\\n    display: block; }\\n  .autocomplete__input:focus {\\n    border-color: blueviolet;\\n    outline: none; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/Autocomplete.scss\n// module id = 664\n// module chunks = 0","import React, { PureComponent } from 'react';\nimport DatePickerComponent from 'react-datepicker';\nimport moment from 'moment';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport BEM from 'digirati-bem-js';\nimport './TextBox.scss';\n\nconst style = BEM.block('input-text-box');\n\nclass DatePicker extends PureComponent {\n\n  // propTypes = {\n  //   id: PropTypes.string.isRequired,\n  //   value: PropTypes.string.isRequired,\n  //   update: PropTypes.func.isRequired,\n  //   metaData: PropTypes.shape({\n  //     title: PropTypes.string.isRequired,\n  //     description: PropTypes.string\n  //   }).isRequired,\n  //   preview: PropTypes.bool,\n  // };\n\n  handleChange(time) {\n    this.props.update(time.toISOString());\n  }\n\n  state = {\n    isStarted: false\n  }\n\n  componentDidMount() {\n    if (this.props.value) {\n      this.setState({ isStarted: true });\n    }\n  }\n\n  onAddDate = () => {\n    this.setState({ isStarted: true });\n  }\n\n  render() {\n    const { isStarted } = this.state;\n    const { id, value, metaData, preview, displayFieldSelector } = this.props;\n    const time = moment(value);\n    return (\n      <div className={style}>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n            : null }\n          { (isStarted) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              this.setState({ isStarted: false })\n              this.props.update(null);\n            }} href=\"#\"> remove</a>)\n            : null }\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        { preview ? (\n          <div className={style.element('preview')}>{moment(value).format('LL')}</div>\n        ) : (\n          isStarted ? (\n          <DatePickerComponent\n            dateFormat=\"DD/MM/YYYY\"\n            className={style.element('input').modifier('datepicker')}\n            selected={time.isValid() ? time : moment()}\n            showYearDropdown={true}\n            onChange={(e) => this.handleChange(e)}/>\n        ) : (\n          <div className={style.element('choice')} onClick={this.onAddDate}>Choose date</div>\n        )) }\n      </div>\n    );\n  }\n\n}\n\nexport default DatePicker;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/DatePicker.js","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".input-text-box {\\n  padding: 10px; }\\n  .input-text-box__input {\\n    width: 100%;\\n    padding: 12px;\\n    border: 2px solid #000;\\n    font-weight: bold;\\n    font-size: 14px;\\n    margin: 5px 0;\\n    background-color: #FFF; }\\n    .input-text-box__input--textarea {\\n      height: 120px; }\\n    .input-text-box__input:focus {\\n      border-color: blueviolet;\\n      outline: none; }\\n  .input-text-box__choice {\\n    width: 100%;\\n    padding: 12px;\\n    border: 2px solid #CCC;\\n    margin: 5px 0;\\n    cursor: pointer;\\n    font-weight: bold; }\\n  .input-text-box__label {\\n    font-weight: bold;\\n    display: block; }\\n  .input-text-box__description {\\n    color: #888;\\n    font-size: .75em; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/TextBox.scss\n// module id = 671\n// module chunks = 0","import BEM from 'digirati-bem-js';\nimport React, {Component} from 'react';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport './DropDown.scss';\n\nconst style = BEM.block('input-drop-down');\n\n// Source: https://jsfiddle.net/11szrbx9/\nfunction printf(format, ...values) {\n  return values.reduce((str, val) => str.replace(/%s/, val), format);\n}\n\nclass DropDown extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      suggestions: []\n    }\n  }\n\n  selectSuggestion(suggestion) {\n    this.props.update(suggestion.uri);\n  }\n\n  updateSuggestions(update, value) {\n    update(value);\n    fetch(\n      printf(this.props.autocomplete, value)\n    )\n    .then(f => f.json())\n    .then(data => this.setState({ suggestions: data.completions })); // probably needs changed?\n  }\n\n  renderBox() {\n    const {id, value, options, autocomplete, preview, update} = this.props;\n    const {suggestions} = this.state;\n\n    if (preview) {\n      return <div className={style.element('preview')}>{value}</div>;\n    }\n\n    if (autocomplete) {\n      return <div className={style.element('autocomplete')}>\n        <input onChange={(e) => this.updateSuggestions(update, e.currentTarget.value)} type=\"text\" value={value || ''} ref={ref => this.input = ref}/>\n        {suggestions ?\n          <ul className={style.element('suggestions').modifiers({ 'is-empty': !!value })}>\n            { suggestions.map(suggestion => <li className={style.element('suggestion-item')} key={suggestion.uri} onClick={() => this.selectSuggestion(suggestion)}>{suggestion.label}</li>) }\n          </ul>\n          : null }\n      </div>;\n    }\n\n    return (\n      <select\n        className={style.element('input')}\n        id={id}\n        value={value || ''}\n        onChange={e => update(e.currentTarget.value)}>\n        { value ? null : (<option value=\"\">Please select...</option>) }\n        { options.map((value, n) => <option key={n} value={value}>{value}</option>) }\n      </select>\n    );\n  }\n\n  render() {\n    const { id, metaData } = this.props;\n    return (\n      <div className={style}>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n            : null }\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        { this.renderBox() }\n      </div>\n    );\n  }\n\n}\n\nexport default DropDown;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/DropDown.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./DropDown.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./DropDown.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./DropDown.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/DropDown.scss\n// module id = 673\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".input-drop-down {\\n  padding: 10px; }\\n  .input-drop-down__input {\\n    background: #FFF;\\n    height: 40px;\\n    width: 200px;\\n    border: 2px solid #000;\\n    font-weight: bold;\\n    font-size: 14px;\\n    margin-bottom: 10px; }\\n    .input-drop-down__input:focus {\\n      border-color: blueviolet;\\n      outline: none; }\\n  .input-drop-down__label {\\n    display: block;\\n    font-weight: bold; }\\n  .input-drop-down__description {\\n    color: #888;\\n    font-size: .75em; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/DropDown.scss\n// module id = 674\n// module chunks = 0","import BEM from 'digirati-bem-js';\nimport React, {Component} from 'react';\nimport Geosuggest from 'react-geosuggest';\nimport {GoogleMap, Marker, withGoogleMap} from 'react-google-maps';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport './GoogleMapSearch.scss';\n\nconst style = BEM.block('google-map-search');\n\nconst GoogleMapDraggablePin = withGoogleMap(props => {\n  return (\n    <GoogleMap\n      ref={props.onMapLoad}\n      defaultZoom={11}\n      center={ props.location }>\n      <Marker draggable={true} onDragEnd={ props.dragEnd } position={ props.location }/>\n    </GoogleMap>\n  );\n});\n\nclass GoogleMapSearch extends Component {\n\n  state = {\n    currentLocation: null,\n    selected: false,\n  };\n\n  handleSuggestSelect = (e) => {\n    this.setState({ selected: e.location })\n    this.props.update(`${e.location.lat},${e.location.lng}`);\n  }\n\n  render() {\n    const key = 'AIzaSyD2X9UAJcuDi_8mXF0ESXtZ9B9KbYcgFKs';\n    const {value: valueAsString, metaData, preview, update} = this.props;\n    const {selected} = this.state;\n    const [lat, lng] = valueAsString ? valueAsString.split(',') : [];\n    const value = (lat && lng) ? {lat: parseFloat(lat), lng: parseFloat(lng)} : null;\n\n    if (selected || preview) {\n      return (\n        <div style={{background: '#FFF'}}>\n          <h4 className={style.element('label')}>{metaData.title}</h4>\n          { (value || (selected.lat && selected.lng)) ? (\n            <div className={style.element('click-to-edit')}>\n              <img width=\"300\"\n                   onClick={() => this.setState({selected: null})}\n                   src={`http://maps.googleapis.com/maps/api/staticmap?key=${key}&size=300x200&scale=2&center=${selected.lat},${selected.lng}&markers=${selected.lat},${selected.lng}&zoom=11`}/>\n            </div>\n          ) : <div>\n            You did not choose a location\n          </div>}\n        </div>\n      );\n    }\n    return (\n      <div className={style}>\n        <div className={style.element('label')}>\n          {metaData.title}\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </div>\n        <div className={style.element('container')}>\n          <Geosuggest onSuggestSelect={this.handleSuggestSelect}/>\n          {\n            value ? (\n              <div>\n                <GoogleMapDraggablePin\n                  onMapLoad={(map) => this.map = map}\n                  dragEnd={({latLng}) => update(`${latLng.lat()},${latLng.lng()}`)}\n                  containerElement={(\n                    <div className={style.element('map-object')}/>\n                  )}\n                  mapElement={(\n                    <div className={style.element('map-object').modifier('inner')}/>\n                  )}\n                  location={value}/>\n                <button\n                  className={style.element('button')}\n                  onClick={() => this.setState({selected: value})}>\n                  save\n                </button>\n              </div>\n            ) : null\n          }\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default GoogleMapSearch;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/GoogleMapSearch.js","export const VIEWER_MUTATION = 'VIEWER_MUTATION';\nexport const VIEWER_ACCESS = 'VIEWER_ACCESS';\n\nexport function setViewer(viewer) {\n  return { type: VIEWER_MUTATION, payload: { viewer } };\n}\n\nexport function withViewer(func) {\n  return { type: VIEWER_ACCESS, payload: { func } };\n}\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/viewer.js","// DUBLIN CORE CONSTANTS\nexport const ID = '@id';\nexport const CONTEXT = '@context';\nexport const TYPE = '@type';\nexport const VALUE = '@value';\nexport const DESCRIPTION = 'dcterms:description';\nexport const TITLE = 'dcterms:title';\nexport const CONFORMS_TO = 'dcterms:conformsTo';\nexport const FORM_FIELDS = 'dcterms:hasPart';\nexport const HAS_PART = 'dcterms:hasPart';\nexport const RDFS_LABEL = 'rdfs:label';\n\n// OMEKA CONSTANTS\nexport const OMEKA_LABEL = 'o:label';\n\n// CROWD CONSTANTS\nexport const COMBINE = 'crowds:derivedAnnoCombine';\nexport const FIELD_GROUP = 'crowds:uiFormGroup';\nexport const LABEL_PARTS = 'crowds:derivedAnnoBodyLabelParts';\nexport const UI_GROUP = 'crowds:uiGroup';\nexport const EXTERNALISE = 'crowds:derivedAnnoExternalize';\nexport const HUMAN_READABLE = 'crowds:derivedAnnoHumanReadable';\nexport const MOTIVATED_BY = 'crowds:derivedAnnoMotivatedBy';\nexport const SERIALIZE = 'crowds:derivedAnnoSerialize';\nexport const MULTIPLE = 'crowds:uiMultiple';\nexport const UI_CHOICE = 'crowds:uiChoice';\nexport const SELECTOR = 'crowds:uiSelectorType';\nexport const SELECTOR_VALUE = 'crowds:uiSelectorValue';\n\nexport const BODY_TYPE = 'crowds:derivedAnnoBodyType';\nexport const PURPOSE = 'crowds:derivedAnnoBodyPurpose';\n\nexport const INPUT_TYPE = 'crowds:uiInputType';\nexport const INPUT_OPTIONS = 'crowds:uiInputOptions';\nexport const INPUT_DEFAULT_VALUE = 'crowds:uiInputDefaultValue';\n\nexport const BOX_SELECTOR = 'madoc:boxdraw';\nexport const WHOLE_CANVAS_SELECTOR = 'WholeCanvasSelector'; // @todo change to madoc: ns\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/vocab.js","export const ANNOTATIONS_ADD = 'ANNOTATIONS_ADD';\n\nexport function addAnnotation(annotation) {\n  return { type: ANNOTATIONS_ADD, payload: { id: annotation.id, annotation } };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/annotations.js","import {\n  addSelectorToDraft,\n  addSelectorToDraftFieldFromViewer,\n  addSelectorToDraftFromViewer,\n  discardCurrentDraft,\n  removeSelectorFromDraft,\n  removeSelectorFromDraftField,\n} from './drafts';\nimport { getCurrentDraft, getDraftById } from '../query/draftQuery';\nimport { selectorCompat } from '../utility';\nimport { withViewer } from './viewer';\nimport { getCurrentSelector } from '../query/selectorQuery';\n\nexport const SELECTOR_SET_AVAILABLE = 'SELECTOR_SET_AVAILABLE';\nexport const SELECTOR_CHOOSE = 'SELECTOR_CHOOSE';\nexport const SELECTOR_UPDATE = 'SELECTOR_UPDATE';\nexport const SELECTOR_COMMIT_TO_DRAFT = 'SELECTOR_COMMIT_TO_DRAFT';\nexport const SELECTOR_COMMIT_TO_DRAFT_FIELD = 'SELECTOR_COMMIT_TO_DRAFT_FIELD';\nexport const SELECTOR_CANCEL = 'SELECTOR_CANCEL';\n\nexport function setAvailableSelectors(selectors) {\n  return { type: SELECTOR_SET_AVAILABLE, payload: { selectors } };\n}\n\nexport function chooseSelector(type, source, defaults, done, immediate = false) {\n  // @todo find better way of Canvas relative vs Viewport relative inspections\n  if (!defaults || type.toLowerCase() !== 'madoc:boxdraw') {\n    return (dispatch) => {\n      dispatch({\n        type: SELECTOR_CHOOSE,\n        payload: { type, source, defaults: selectorCompat(defaults) },\n      });\n      if (type.toLowerCase() === 'wholecanvasselector' || immediate) {\n        dispatch(commitToCurrentDraft(false));\n      }\n      if (done) {\n        done();\n      }\n    };\n  }\n  return withViewer((Canvas, dispatch) => {\n    const { x, y } = Canvas.createViewportPoint(defaults.x, defaults.y);\n    const { x: maxX, y: maxY } = Canvas.createViewportPoint(defaults.x + defaults.width, defaults.y + defaults.height);\n    dispatch({\n      type: SELECTOR_CHOOSE,\n      meta: { fromViewer: true },\n      payload: { type, source, defaults: selectorCompat({ ...defaults, x, y, width: maxX - x, height: maxY - y }) },\n    });\n    if (done) {\n      done();\n    }\n  });\n}\n\nexport function cancelSelector() {\n  return { type: SELECTOR_CANCEL };\n}\n\nexport function chooseSecondarySelector(id, source, type, defaults, done) {\n  return chooseSelector(type, source, { ...selectorCompat(defaults), id, secondary: true }, done);\n}\n\nexport function updateSelector(data) {\n  return { type: SELECTOR_UPDATE, payload: { data: selectorCompat(data) } };\n}\n\nexport function commitToCurrentDraftField(fieldId) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const selector = getCurrentSelector(state);\n    dispatch(\n      addSelectorToDraftFieldFromViewer(\n        selector.source.draft,\n        selectorCompat(selector),\n        fieldId,\n        () => dispatch({ type: SELECTOR_COMMIT_TO_DRAFT_FIELD }),\n      ),\n    );\n  };\n}\n\nexport function editCurrentDraftSecondarySelector(scope, fieldId) {\n  return (dispatch, getState) => {\n    const { id, selectors, template } = getCurrentDraft(getState(), scope);\n    if (id && selectors && selectors[fieldId]) {\n      dispatch(\n        chooseSecondarySelector(\n          fieldId,\n          { template: template, draft: id, scope},\n          selectors[fieldId].type,\n          selectorCompat(selectors[fieldId]),\n          // Remove only after choosing.\n          () => dispatch(removeSelectorFromDraftField(id, fieldId)),\n        ),\n      );\n    }\n  };\n}\n\nexport function editCurrentDraftSelector(scope) {\n  return (dispatch, getState) => {\n    const { id, selector, template } = getCurrentDraft(getState(), scope);\n    if (id && selector) {\n      // @todo remove this, seems like a bug.\n      if (selector.type === 'WholeCanvasSelector') {\n        return dispatch(discardCurrentDraft(scope));\n      }\n      dispatch(\n        chooseSelector(\n          selector.type,\n          { template: template, draft: id, scope },\n          selectorCompat(selector),\n          () => dispatch(removeSelectorFromDraft(id)),\n        ),\n      );\n    }\n  };\n}\n\nexport function commitToCurrentDraft(isViewer = true) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const selector = getCurrentSelector(state);\n    if (!selector || !selector.source) {\n      return null;\n    }\n    if (!selector.source.draft) {\n      console.warn('commitToCurrentDraft', 'Selector with malformed source found.');\n    }\n    const currentDraft = getDraftById(state, selector.source.draft);\n    if (!currentDraft) {\n      console.warn('commitToCurrentDraft', `Draft (${selector.source.draft}) was not found in state.`);\n    }\n    if (selector.id) {\n      return dispatch(commitToCurrentDraftField(selector.id));\n    }\n    if (isViewer) {\n      dispatch(\n        addSelectorToDraftFromViewer(\n          currentDraft.id,\n          selectorCompat(selector),\n          () => dispatch({ type: SELECTOR_COMMIT_TO_DRAFT }),\n        ),\n      );\n    } else {\n      dispatch(addSelectorToDraft(currentDraft.id, selector));\n      dispatch({ type: SELECTOR_COMMIT_TO_DRAFT });\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/selectors.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./GoogleMapSearch.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./GoogleMapSearch.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./GoogleMapSearch.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/GoogleMapSearch.scss\n// module id = 865\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".google-map-search__label {\\n  display: block;\\n  font-weight: bold; }\\n\\n.google-map-search__description {\\n  color: #888;\\n  font-size: .75em; }\\n\\n.google-map-search__container {\\n  border: 2px solid #000;\\n  background: #FFF; }\\n\\n.google-map-search__map-object {\\n  height: 200px; }\\n\\n.google-map-search__button {\\n  width: 100%;\\n  padding: 10px;\\n  background: skyblue;\\n  font-size: 13px;\\n  border: none; }\\n\\n.google-map-search__click-to-edit {\\n  position: relative;\\n  box-sizing: border-box; }\\n  .google-map-search__click-to-edit img {\\n    width: 100%; }\\n  .google-map-search__click-to-edit:after {\\n    content: '';\\n    transition: background .2s;\\n    background: transparent;\\n    pointer-events: none;\\n    position: absolute;\\n    top: 0;\\n    bottom: 0;\\n    right: 0;\\n    left: 0; }\\n  .google-map-search__click-to-edit:hover:after {\\n    font-weight: bold;\\n    background: rgba(0, 0, 0, 0.3);\\n    color: #fff;\\n    text-align: center;\\n    line-height: 100%;\\n    padding-top: 50px;\\n    text-shadow: 0 1px 0 #000;\\n    content: 'click to edit'; }\\n\\n.geosuggest {\\n  font-size: 18px;\\n  position: relative;\\n  text-align: left; }\\n  .geosuggest__input {\\n    width: 300px;\\n    padding: 12px;\\n    border: none;\\n    border-bottom: 2px solid #000;\\n    font-weight: bold;\\n    font-size: 14px;\\n    background-color: #FFF; }\\n    .geosuggest__input:focus {\\n      border-color: blueviolet;\\n      outline: none; }\\n  .geosuggest__suggests {\\n    position: absolute;\\n    top: 100%;\\n    left: 0;\\n    right: 0;\\n    max-height: 25em;\\n    padding: 0;\\n    margin-top: -4px;\\n    background: #FFF;\\n    border-bottom: 2px solid rgba(0, 0, 0, 0.2);\\n    border-top-width: 0;\\n    overflow-x: hidden;\\n    overflow-y: auto;\\n    list-style: none;\\n    z-index: 5;\\n    -webkit-transition: max-height 0.2s, border 0.2s;\\n    transition: max-height 0.2s, border 0.2s; }\\n  .geosuggest__suggests--hidden {\\n    max-height: 0;\\n    overflow: hidden;\\n    border-top-width: 0;\\n    border-bottom-width: 0; }\\n  .geosuggest__item {\\n    font-size: 18px;\\n    padding: .5em .65em;\\n    cursor: pointer; }\\n    .geosuggest__item:hover, .geosuggest__item:focus {\\n      background: #267dc0;\\n      color: #fff; }\\n    .geosuggest__item--active:nth-of-type(odd), .geosuggest__item--active {\\n      background: #267dc0;\\n      color: #fff; }\\n      .geosuggest__item--active:nth-of-type(odd):hover, .geosuggest__item--active:nth-of-type(odd):focus, .geosuggest__item--active:hover, .geosuggest__item--active:focus {\\n        background: #267dc0; }\\n    .geosuggest__item__matched-text {\\n      font-weight: bold; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/GoogleMapSearch.scss\n// module id = 866\n// module chunks = 0","import React, { PureComponent, PropTypes } from 'react';\nimport BEM from 'digirati-bem-js';\nimport './TextBox.scss';\nimport HelpTooltip from '../ui/HelpTooltip';\n\nconst style = BEM.block('input-text-box');\n\nclass TextArea extends PureComponent {\n\n  // propTypes = {\n  //   id: PropTypes.string.isRequired,\n  //   value: PropTypes.string.isRequired,\n  //   update: PropTypes.func.isRequired,\n  //   metaData: PropTypes.shape({\n  //     title: PropTypes.string.isRequired,\n  //     description: PropTypes.string\n  //   }).isRequired,\n  //   preview: PropTypes.bool,\n  // };\n\n  render() {\n    const { id, value, metaData, preview, displayFieldSelector } = this.props;\n    return (\n      <div className={style}>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n            : null }\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        { preview ? (\n          <div className={style.element('preview')}>{value}</div>\n        ) : (\n          <textarea className={style.element('input').modifier('textarea')}\n                    id={id}\n                    value={value || ''}\n                    onChange={e => this.props.update(e.currentTarget.value)}/>\n        ) }\n      </div>\n    );\n  }\n\n}\n\nexport default TextArea;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/TextArea.js","import React, { Component } from 'react';\nimport BEM from 'digirati-bem-js';\nimport './TextBox.scss';\nimport HelpTooltip from '../ui/HelpTooltip';\n\nconst style = BEM.block('input-text-box');\n\nclass TextBox extends Component {\n\n  shouldComponentUpdate(newProps) {\n    return newProps.value !== this.props.value || newProps.preview !== this.props.preview;\n  }\n\n  render() {\n    const { id, value, metaData, preview, update, displayFieldSelector, elementEvents } = this.props;\n\n    const events = {\n      ...elementEvents,\n      onFocus: e => elementEvents.onFocus ? elementEvents.onFocus(id, e) : null,\n      onBlur: e => elementEvents.onBlur ? elementEvents.onBlur(id, e) : null,\n    };\n\n\n    return (\n      <div className={style}>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n          : null }\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        { preview ? (\n          <div className={style.element('preview')}>{value}</div>\n        ) : (\n          <input className={style.element('input')}\n                 id={id}\n                 type=\"text\"\n                 value={value || \"\"}\n                 onChange={e => update(e.currentTarget.value)}\n                 {...events}/>\n        ) }\n      </div>\n    );\n  }\n\n}\n\nexport default TextBox;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/TextBox.js","import React, { PureComponent } from 'react';\nimport BEM from 'digirati-bem-js';\nimport EmbeddedResourceEditor from './EmbeddedResourceEditor';\nimport Autocomplete from './Autocomplete';\nimport HelpTooltip from '../ui/HelpTooltip';\nimport Portal from 'react-portal';\nimport './Fallback.scss';\n\nconst style = BEM.block('fallback-input-box');\nclass Fallback extends PureComponent {\n  state = {\n    previousValue: null,\n    creatingNew: false,\n    fallbackValue: null,\n  };\n\n  handleNotFound = () => {\n    this.setState({\n      previousValue: this.props.value,\n      creatingNew: true,\n    });\n    this.props.update(null);\n    this.portal.openPortal();\n  };\n\n  handleBack = (state) => {\n    if (this.state.previousValue) {\n      this.props.update(this.state.previousValue);\n    }\n    this.setState({ creatingNew: false, previousValue: null });\n  };\n\n  postSave = (prom, annotation) => {\n    prom.then(val => {\n      this.setState({ creatingNew: false, previousValue: null, fallbackValue: { url: val.payload.id, label: annotation.label } });\n      this.props.update({ url: val.payload.id, label: annotation.label });\n    });\n  };\n\n  setPortal = ref => this.portal = ref;\n\n  render() {\n    const { creatingNew, fallbackValue } = this.state;\n    const { autocomplete, captureModel, value, preview, metaData, currentDraft, ...props } = this.props;\n\n    if (preview || this.state.fallbackValue) {\n      return (\n        <div>\n          {metaData ? (\n            <div>{metaData.title}</div>\n          ) : null }\n          { value && value.url ? (\n          <a href={value.url} target=\"_blank\" className={style.element('entity')}>\n            <div className={style.element('preview-label')}>{value.label}</div>\n            <div className={style.element('preview-url')}>{value.url}</div>\n          </a>\n          ) : (\n            <span className={style.element('empty')}>\n              Nothing selected\n            </span>\n          )}\n        </div>\n      );\n      return <div>{value.label} ({value.url})</div>;\n    }\n\n    return (\n      <div className={style}>\n        {metaData ? (\n          <label className={style.element('label')} htmlFor={props.id}>\n            {metaData.title} {' '}\n            { (metaData.selector && metaData.selectorValue) ?\n              (<a onClick={(e) => {\n                e.preventDefault();\n                displayFieldSelector(id);\n              }} href=\"#\">edit</a>)\n              : null }\n            {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n          </label>\n        ) : null }\n\n        <Autocomplete {...props} value={value} suggestionProvider={(value) => {\n          const url = autocomplete['@id'] + '&q=' + encodeURIComponent(value);\n\n          return fetch(url)\n          .then(result => result.json())\n          .then(response => response.completions);\n        }}/>\n        { currentDraft.selector ? (\n          <a className={style.element('fallback-button')} onClick={e => this.handleNotFound()}>{ metaData.description || 'Can\\'t find what you\\'re looking for?' }</a>\n        ) : null}\n        <Portal ref={this.setPortal} isOpened={this.state.creatingNew}>\n          <div className={style.element('portal')}>\n            <div className={style.element('portal-inner')}>\n              <EmbeddedResourceEditor {...props} currentDraft={currentDraft} captureModel={captureModel['@id']} postSave={this.postSave} onBack={this.handleBack}/>\n            </div>\n          </div>\n        </Portal>\n      </div>\n    );\n  }\n}\n\nexport default Fallback;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/Fallback.js","import { withViewer } from './viewer';\nimport update from 'immutability-helper';\n\nexport const IMPORT_RESOURCE_TREE = 'IMPORT_RESOURCE_TREE';\nexport const IMPORT_RESOURCE_CHOICE = 'IMPORT_RESOURCE_CHOICE';\nexport const IMPORT_RESOURCE_FIELD = 'IMPORT_RESOURCE_FIELD';\nexport const IMPORT_UNKNOWN_RESOURCE = 'IMPORT_UNKNOWN_RESOURCE';\nexport const IMPORT_CAPTURE_MODEL = 'IMPORT_CAPTURE_MODEL';\nexport const RESOURCE_NAV_FORWARD = 'RESOURCE_NAV_FORWARD';\nexport const RESOURCE_NAV_BACK = 'RESOURCE_NAV_BACK';\nexport const RESOURCE_NAV_RESET = 'RESOURCE_NAV_RESET';\n\nexport function importResource(resource) {\n  if (\n    resource.metaData &&\n    resource.metaData.selectorValue &&\n    resource.metaData.selectorValue.unit &&\n    resource.metaData.selectorValue.unit === 'percent'\n  ) {\n    return importResourceWithPercentage(resource);\n  }\n  if (resource.type === 'choice') {\n    return importChoice(resource);\n  }\n  if (resource.type === 'captureModel') {\n    return importCaptureModel(resource);\n  }\n  if (resource.type === 'field') {\n    return importField(resource);\n  }\n  console.warn('NOT FOUND', resource);\n  return {\n    type: IMPORT_UNKNOWN_RESOURCE,\n    error: true,\n    payload: new Error(`Unknown resource (${resource.type}) imported`),\n  };\n}\n\nexport function importChoice(resource) {\n  return { type: IMPORT_RESOURCE_CHOICE, payload: { resource } };\n}\n\nexport function importCaptureModel(resource) {\n  return { type: IMPORT_CAPTURE_MODEL, payload: { id: resource.id, resource } };\n}\n\nexport function importField({ parentId, ...resource }) {\n  if (!(parentId)) {\n    return {\n      type: IMPORT_RESOURCE_FIELD,\n      error: true,\n      payload: new Error('Cannot import dereferenced field (expected resource.parentId)'),\n    }\n  }\n  return { type: IMPORT_RESOURCE_FIELD, payload: { id: parentId, resource } };\n}\n\n/**\n * Moves user forward in path.\n */\nexport function moveForward(tree, path) {\n  return { type: RESOURCE_NAV_FORWARD, payload: { tree, path } };\n}\n\n/**\n * Moves user back in path.\n */\nexport function moveBack(tree) {\n  return { type: RESOURCE_NAV_BACK, payload: { tree } };\n}\n\n/**\n * Reset user to root.\n */\nexport function reset(tree) {\n  return { type: RESOURCE_NAV_RESET, payload: { tree } };\n}\n\nexport function importResourceTree(tree) {\n  if (!(\n      tree.id &&\n      (tree.type === 'choice' || tree.type === 'captureModel') /*&&\n       (tree.type === 'choice' ? (tree.choice && Object.keys(tree.choice).length > 1) : true)*/\n    )) {\n    return { type: IMPORT_RESOURCE_TREE, error: true, payload: new Error('Not a valid tree') };\n  }\n\n  return { type: IMPORT_RESOURCE_TREE, payload: { id: tree.id, tree } };\n}\n\nfunction importResourceWithPercentage(resource) {\n  return withViewer((Canvas, dispatch) => {\n      const { width, height } = Canvas.getImageSize();\n\n      if (!(\n          resource.metaData &&\n          resource.metaData.selectorValue &&\n          resource.metaData.selectorValue.x &&\n          resource.metaData.selectorValue.y &&\n          width &&\n          height\n        )) {\n        return dispatch({\n          type: IMPORT_UNKNOWN_RESOURCE,\n          error: true,\n          payload: new Error('Unknown resource, unable to convert from percentage to pixel format'),\n        });\n      }\n\n      const fixedResource = update(resource, {\n        metaData: {\n          selectorValue: {\n            $merge: {\n              ...resource.metaData.selectorValue,\n              x: (resource.metaData.selectorValue.x / 100) * width,\n              y: (resource.metaData.selectorValue.y / 100) * height,\n              width: (resource.metaData.selectorValue.width / 100) * width,\n              height: (resource.metaData.selectorValue.height / 100) * height,\n              immutable: true,\n              scale: 1,\n              unit: 'pixel',\n            },\n          },\n        },\n      });\n\n      dispatch(importResource(fixedResource));\n    },\n  );\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/actions/resources.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./EmbeddedResourceEditor.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./EmbeddedResourceEditor.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./EmbeddedResourceEditor.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.scss\n// module id = 870\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".embedded-resource-editor {\\n  border: 1px solid #DDD;\\n  padding: 15px; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/EmbeddedResourceEditor.scss\n// module id = 871\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Fallback.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Fallback.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Fallback.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/Fallback.scss\n// module id = 873\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".fallback-input-box__portal {\\n  position: fixed;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  background: #fff;\\n  overflow: auto;\\n  padding: 30px;\\n  z-index: 10000; }\\n\\n.fallback-input-box__portal-inner {\\n  margin: 0 auto;\\n  padding: 15px;\\n  max-width: 500px; }\\n\\n.fallback-input-box__entity {\\n  transition: all .2s;\\n  display: block;\\n  margin-top: 3px;\\n  padding: 5px 10px;\\n  border-radius: 3px;\\n  border: 1px solid #EEE;\\n  border-bottom-color: #CCC; }\\n  .fallback-input-box__entity:hover {\\n    border-color: royalblue; }\\n    .fallback-input-box__entity:hover .fallback-input-box__preview-url {\\n      color: royalblue; }\\n\\n.fallback-input-box__preview-label {\\n  color: #000; }\\n\\n.fallback-input-box__preview-url {\\n  transition: all .2s;\\n  color: #999;\\n  font-size: 11px;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  display: block; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/Fallback.scss\n// module id = 874\n// module chunks = 0","import React, { PureComponent } from 'react';\nimport BEM from 'digirati-bem-js';\nimport './Hidden.scss';\n\n\nconst style = BEM.block('hidden-input');\n\nexport default class Hidden extends PureComponent {\n\n  componentDidMount() {\n    const {metaData, update} = this.props;\n    if (metaData.defaultValue) {\n      update(metaData.defaultValue);\n    }\n  }\n\n  render() {\n    const { id, value, metaData, preview, update, displayFieldSelector, elementEvents } = this.props;\n\n    return (\n      <div className={style.modifier({ 'labeled-selector': (metaData.selector && metaData.title) })}>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n          : null }\n        </label>\n        <input id={id} type=\"hidden\" value={value || ''}/>\n      </div>\n    );\n    \n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/Hidden.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Hidden.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Hidden.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Hidden.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/Hidden.scss\n// module id = 876\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".hidden-input {\\n  display: none; }\\n  .hidden-input--labeled-selector {\\n    display: block; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/Hidden.scss\n// module id = 877\n// module chunks = 0","import React, { Component } from 'react';\nimport EmbeddedResourceEditor from './EmbeddedResourceEditor';\nimport BEM from 'digirati-bem-js';\nimport HelpTooltip from '../ui/HelpTooltip';\n\nconst style = BEM.block('nullable-capture-model');\nexport default class NullableCaptureModel extends Component {\n\n  state = { isChecked: false, isSaved: false, annotation: null };\n\n  onReceiveEmbeddedItem = item => item.then(item => {\n    const id = item.payload.annotation.id;\n    this.props.update(id);\n    this.setState({ isSaved: true, annotation: item.payload.annotation });\n  });\n\n  handleChange = () => {\n    const captureModel = this.getCaptureModel();\n    const isChecked = !this.state.isChecked;\n    if (!this.props.value) {\n      this.props.update(isChecked ? (captureModel['@id']) : null);\n    }\n    this.setState({ isChecked });\n  };\n\n  getCaptureModel() {\n    return this.props.annotationMetaData.options.find(e => e['o:label'] === 'madoc:capturemodel');\n  }\n\n  render() {\n    const { isChecked, isSaved, annotation } = this.state;\n    const {id, metaData, annotationMetaData, displayFieldSelector, value, ...props} = this.props;\n    const checkbox = annotationMetaData.options.find(e => e['o:label'] === 'madoc:checkbox');\n    const captureModel = annotationMetaData.options.find(e => e['o:label'] === 'madoc:capturemodel');\n    if (!checkbox || !captureModel) {\n      console.warn('NullableCaptureModel component failed to mount.', this.props);\n      return;\n    }\n    return (\n      <div className={style}>\n        <div className={style.element('checkbox-container').modifiers({ 'is-checked': this.state.isChecked })}>\n          <input className={style.element('checkbox')} id={id} type=\"checkbox\" value={this.state.isChecked} onChange={this.handleChange}/>\n        </div>\n        <label className={style.element('label')} htmlFor={id}>\n          {metaData.title} {' '}\n          { (metaData.selector && metaData.selectorValue) ?\n            (<a onClick={(e) => {\n              e.preventDefault();\n              displayFieldSelector(id);\n            }} href=\"#\">edit</a>)\n            : null }\n          {metaData.description ? (<HelpTooltip>{metaData.description}</HelpTooltip>) : null}\n        </label>\n        {isChecked ? (\n          <div>\n            { isSaved ? (\n              <div>\n                { annotation.label } ({ annotation.id })\n              </div>\n              ) : (\n              <EmbeddedResourceEditor captureModel={captureModel['@id']} postSave={this.onReceiveEmbeddedItem} {...props}/>\n            ) }\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/inputs/NullableCaptureModel.js","import moment from 'moment';\n\nexport default {\n  'http://xmlns.com/foaf/name': (item) => {\n    return {\n      isValid: typeof item === 'string' && item.length >= 1,\n      message: 'Name must not be blank',\n    };\n  },\n  'https://schema.org/birthDate': (item) => {\n    return {\n      isValid: moment(item).isValid(),\n      message: 'You must provide a valid date of birth',\n    }\n  },\n  'https://schema.org/jobTitle': (item) => {\n    return {\n      isValid: typeof item === 'string' && item.length >= 1,\n      message: 'Job title must not be blank',\n    }\n  },\n  'http://dublincore.org/documents/dcmi-terms/#terms-description': (item) => {\n    return {\n      isValid: typeof item === 'string' && item.length >= 1,\n      message: 'Description must not be blank',\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/domain/validation.js","import 'whatwg-fetch';\n\nconst JSON_LD_HEADERS = {\n  'Content-Type': 'application/ld+json',\n  Accept: 'application/ld+json',\n};\n\nimport type Annotation from '../annotation/Annotation';\n\nexport { AnnotationSelector } from './AnnotationSelector';\n\nconst CONTEXT = 'http://www.w3.org/ns/anno.jsonld';\n\nexport function makeRequest(method, uri, body, headers = []) {\n  return fetch(uri, {\n    method,\n    headers: { ...JSON_LD_HEADERS, ...headers },\n    body: JSON.stringify(body),\n    credentials: 'same-origin',\n    redirect: 'follow'\n  })\n    .then(response => {\n      if (response.status >= 200 && response.status < 300) {\n        return response.json();\n      }\n      return {\n        error: response.statusText,\n        status: response.status,\n      };\n    });\n}\n\nexport function get(uri, body) {\n  return makeRequest('GET', uri, body);\n}\n\nexport function post(uri, body, headers = []) {\n  return makeRequest('POST', uri, body, headers);\n}\n\nexport function putAnnotation(uri, body, headers = []) {\n  return makeRequest('PUT', uri, body, headers);\n}\n\nexport function getAnnotation(server, id) {\n  return get(`${server}${id}/`);\n}\n\nexport async function* getAllAnnotationsFromCollection(collectionResource) {\n  const firstPage = collectionResource.first;\n  if (!firstPage.items) {\n    return;\n  }\n  // First page of results.\n  for (let item of firstPage.items) {\n    yield item;\n  }\n  // Further pages of results.\n  if (firstPage.next) {\n    const collection = fetchPageCollection(firstPage.next);\n    do {\n      const item = await collection.next();\n      if (item.done) {\n        return;\n      }\n      yield item.value;\n    } while (true);\n  }\n}\n\nasync function* fetchPageCollection(resource) {\n  const currentPage = await get(resource);\n  if (currentPage.items) {\n    for (let item of currentPage.items) {\n      yield item;\n    }\n  }\n  if (currentPage.next) {\n    return fetchPageCollection(currentPage.next);\n  }\n}\n\nexport function createElucidateCollection(server, label, id) {\n  return getAnnotation(server, id).then(response => {\n    if (response.status === 404) {\n      return post(server, {\n        '@context': CONTEXT,\n        type: 'AnnotationCollection',\n        label,\n      }, {\n        Slug: id,\n      });\n    }\n    // Digest collection\n    return response;\n  });\n}\n\nexport function postAnnotation(collection : string, annotation: Annotation) {\n  return post(collection, annotation);\n}\n\n/**\n * @deprecated\n */\nexport function sendAnnotationToServer(server, body, target, motivation, label) {\n  return post(server, {\n    '@context': CONTEXT,\n    type: 'Annotation',\n    label: label ? label : 'unknown',\n    body,\n    target,\n    motivation,\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/elucidate/index.js","import BEM from 'digirati-bem-js';\nimport React, { Component } from 'react';\nimport Toggle from '../ui/Toggle';\nimport Viewer from '../viewers/Viewer';\nimport './Canvas.scss';\nimport Region from '../viewers/Region';\n\nconst $canvas = BEM.block('canvas');\n\nexport default class Canvas extends Component {\n\n  static VIEWPORT_RELATIVE = 'VIEWPORT_RELATIVE';\n  static CANVAS_RELATIVE = 'CANVAS_RELATIVE';\n\n  // propTypes = {\n  //   onUpdateSelector: PropTypes.func,\n  //   onSaveSelector: PropTypes.func,\n  //   selector: PropTypes.shape({\n  //     type: PropTypes.string.isRequired,\n  //     left: PropTypes.number,\n  //     top: PropTypes.number,\n  //     height: PropTypes.number,\n  //     width: PropTypes.number,\n  //   }),\n  //   image: PropTypes.shape({\n  //     src: PropTypes.string.isRequired,\n  //     height: PropTypes.number.isRequired,\n  //     width: PropTypes.number.isRequired,\n  //   }).isRequired,\n  //   displayWidth: PropTypes.number.isRequired,\n  // };\n\n  constructor() {\n    super();\n    this.resolveViewer = null;\n    this.viewerReady = new Promise((resolve, err) => {\n      this.resolveViewer = resolve;\n    });\n    this.state = {\n      showAnnotations: true,\n      position: {\n        x: -1,\n        y: -1,\n        scale: 0,\n        rotation: 0,\n      }\n    };\n  }\n\n  renderCurrentSelector(selector, defaultPosition, relativeTo) {\n\n    // Nope.\n    if (!selector) {\n      return null;\n    }\n\n    // Nothing is relative to the canvas yet.\n    if (relativeTo === Canvas.CANVAS_RELATIVE && selector.type !== 'madoc:pin') {\n      return null;\n    }\n    if (relativeTo !== Canvas.CANVAS_RELATIVE && selector.type === 'madoc:pin') {\n      return null;\n    }\n\n    const {\n      onUpdateSelector,\n      onSaveSelector,\n      image: {\n        width,\n      },\n      displayWidth,\n      onEditRegion,\n    } = this.props;\n\n    const { type, ...position } = selector;\n    const scale = displayWidth / width;\n\n    const isInitial = type === 'madoc:boxdraw' ? (!position.x && !position.y) : false;\n\n    return <Region\n      id={position.id}\n      type={type}\n      x={position.x}\n      y={position.y}\n      defaultX={defaultPosition.x}\n      defaultY={defaultPosition.y}\n      width={position.width || null}\n      height={position.height || null}\n\n      isInitial={isInitial}\n      isChanging={true}\n      canChange={true} // Change change if its being changed? maybe change.\n      pointerEvents={true} // To change\n\n      pixelScale={scale}\n\n      onChange={ onEditRegion } // Combined with canChange\n      onUpdate={ onUpdateSelector } // To change\n      onCommit={ onSaveSelector } // To change\n      onClick={ () => null } // To change\n\n      meta={{\n        isSecondary: position.isSecondary || false,\n        isSelected: position.isSelected || false,\n        focused: position.focused || false,\n      }}\n    />;\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const props = this.props;\n\n    return (\n      nextState.showAnnotations !== this.state.showAnnotations ||\n      props.displayWidth !== nextProps.displayWidth ||\n      props.selector !== nextProps.selector ||\n      props.regions !== nextProps.regions ||\n      props.regions.length !== nextProps.regions.length\n    );\n  }\n\n  createRelativePoint(x, y) {\n    return this.viewer.createRelativePoint(x, y);\n  }\n\n  createViewportPoint(x, y) {\n    return this.viewer.createViewportPoint(x, y);\n  }\n\n  getSelectedRegion() {\n    return this.viewer.getSelectedRegion();\n  }\n\n  getImageSize() {\n    const { image: { width, height } } = this.props;\n\n    return {\n      width,\n      height,\n    };\n  }\n\n  getScale() {\n    const {\n      image: {\n        width,\n      },\n      displayWidth,\n    } = this.props;\n    return displayWidth / width;\n  }\n\n  setViewer(viewer) {\n    this.resolveViewer(viewer);\n    this.viewer = viewer;\n  }\n\n  mapRegion = ({ type: regionType, x, y, height, width: regionWidth, ...region }, index) => {\n    const { onEditRegion, displayWidth, width, onUpdateSelector, onSaveSelector} = this.props;\n    const scale = displayWidth / width;\n\n    const type = regionType ? regionType : (\n      x && y && height && regionWidth ? 'madoc:boxdraw' : (\n        x && y ? 'madoc:pin' : (\n          'WholeCanvasSelector'\n        )\n      )\n    );\n\n    return <Region\n      key={index}\n      id={region.id}\n      type={type}\n      x={x}\n      y={y}\n      width={regionWidth}\n      height={height}\n\n      isInitial={false} // To change\n      isChanging={false} // To change\n      canChange={region.immutable === false}\n      pointerEvents={true} // To change\n\n      pixelScale={scale}\n\n      onChange={ onEditRegion } // Combined with canChange\n      onUpdate={ onUpdateSelector } // To change\n      onCommit={ onSaveSelector } // To change\n      onClick={ () => null } // To change\n\n      meta={{\n        isSecondary: region.isSecondary || false,\n        isSelected: region.selected || false,\n        focused: region.focused || false,\n        ...region\n      }}\n    />;\n  };\n\n  render() {\n    const {\n      image: {\n        src,\n        height,\n        width,\n      },\n      maxHeight,\n      showAnnotationToggle,\n      displayWidth,\n      selector,\n      selectedViewer,\n      regions,\n      onEditRegion,\n      onUpdateSelector,\n      onSaveSelector,\n      ...props,\n    } = this.props;\n\n    const scale = displayWidth / width;\n\n    const regionRender = this.state.showAnnotations ? Object.keys(regions).reverse().map(r => regions[r]).map(this.mapRegion) : null;\n\n    const currentSelectorPropsViewport = {\n      width: 100,\n      height: 100,\n      x: (displayWidth / 2) - 50,\n      y: ((( height * scale ) < maxHeight ? height * scale : maxHeight) / 2 ) - 50,\n    };\n\n    const currentSelectorPropsCanvas = {\n      width: 100,\n      height: 100,\n      x: (width / 2) - 50,\n      y: (height / 2 ) - 50,\n    };\n\n    return (\n      <div className={$canvas}>\n        { showAnnotationToggle ? (\n          <div className={$canvas.element('info-bar')}>\n            <Toggle\n              label=\"toggle annotations\"\n              className={$canvas.element('toggle')}\n              onChange={(value) => this.toggleAnnotations(value)}\n              isActive={this.state.showAnnotations}/>\n          </div>\n        ) : null }\n        <div className={$canvas.element('viewport')} style={{ maxHeight: height * scale, width: width * scale }}>\n          { this.renderCurrentSelector(selector, currentSelectorPropsViewport, Canvas.VIEWPORT_RELATIVE) }\n          <Viewer\n            getRef={ref => this.setViewer(ref)}\n            type={selectedViewer === 'OpenSeadragonViewer' ? 'OpenSeadragonViewer' : 'ScaledImageViewer'}\n            resource={src}\n            scale={scale}\n            width={width}\n            height={height}\n            maxHeight={maxHeight}\n            { ...props }>\n            {/* Children of the viewer component get scaled automatically (x, y, width, height and save functions) */}\n            { regionRender }\n            { this.renderCurrentSelector(selector, currentSelectorPropsCanvas, Canvas.CANVAS_RELATIVE) }\n          </Viewer>\n        </div>\n      </div>\n    );\n  }\n\n  toggleAnnotations() {\n    this.setState(() => ({\n      showAnnotations: !this.state.showAnnotations,\n    }));\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/composites/Canvas.js","import BEM from 'digirati-bem-js';\nimport React, {PureComponent} from 'react';\nimport './Toggle.scss';\n\nconst style = BEM.block('toggle');\n\nclass Toggle extends PureComponent {\n\n  render() {\n    const {label, isActive, className, onChange} = this.props;\n    return (\n      <div className={`${style} ${className}`}>\n        <span className={style.element('label')}>{ label }</span>\n        <div\n          onKeyDown={(e) => {\n            if (e.keyCode === 32 || e.keyCode === 13) {\n              e.nativeEvent.preventDefault();\n              onChange(!isActive);\n            }\n          }}\n          tabIndex=\"0\"\n          className={style.element('hitbox').modifier('active', isActive)}\n          onClick={() => onChange(!isActive)}>\n          <div className={style.element('ball').modifier('active', isActive)}/>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default Toggle;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/ui/Toggle.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Toggle.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Toggle.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Toggle.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/ui/Toggle.scss\n// module id = 882\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".toggle {\\n  display: inline-block;\\n  box-sizing: border-box;\\n  cursor: pointer; }\\n  .toggle * {\\n    box-sizing: border-box; }\\n  .toggle__label {\\n    pointer-events: none;\\n    opacity: 0;\\n    transition: opacity .2s; }\\n  .toggle:hover .toggle__label {\\n    opacity: 1; }\\n  .toggle__label {\\n    color: #fff;\\n    margin: 5px;\\n    background: rgba(0, 0, 0, 0.8);\\n    border: 1px solid rgba(255, 255, 255, 0.8);\\n    font-size: 14px;\\n    padding: 5px 10px;\\n    border-radius: 1px;\\n    height: 32px;\\n    position: absolute;\\n    top: 35px; }\\n  .toggle__hitbox {\\n    display: inline-block;\\n    border-radius: 20px;\\n    z-index: 100;\\n    pointer-events: auto;\\n    width: 44px;\\n    height: 24px;\\n    padding: 2px;\\n    background: #FFF;\\n    border: 1px solid #DDD;\\n    transition: background .2s; }\\n    .toggle__hitbox:focus {\\n      outline: none;\\n      background: #EEE;\\n      border: 1px solid #919191; }\\n    .toggle__hitbox--active:focus {\\n      background: #ecf3fe;\\n      border: 1px solid #1266f1; }\\n  .toggle__ball {\\n    width: 18px;\\n    border-radius: 18px;\\n    border: 1px solid #888;\\n    transition: all .2s;\\n    height: 18px;\\n    display: block;\\n    margin-left: 20px;\\n    background: #AAA; }\\n    .toggle__ball--active {\\n      margin-left: 0;\\n      background: #4285F4;\\n      border: 1px solid #1266f1; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/ui/Toggle.scss\n// module id = 883\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Canvas.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Canvas.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Canvas.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/composites/Canvas.scss\n// module id = 884\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".canvas {\\n  position: relative; }\\n  .canvas__info-bar {\\n    user-select: none;\\n    pointer-events: none;\\n    position: absolute;\\n    top: 20px;\\n    left: 20px;\\n    right: 20px;\\n    padding: 5px;\\n    height: 30px;\\n    z-index: 99999; }\\n    .canvas__info-bar * {\\n      pointer-events: initial; }\\n  .canvas__viewport {\\n    overflow: hidden;\\n    position: relative; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/composites/Canvas.scss\n// module id = 885\n// module chunks = 0","import React, { Component } from 'react';\nimport BEM from 'digirati-bem-js';\nimport Selector from '../selectors/Selector';\nimport './Region.scss';\nconst style = BEM.block('region');\n\nexport default class Region extends Component {\n\n  renderRegionBox() {\n    if (!(\n        this.props.x &&\n        this.props.y &&\n        this.props.width &&\n        this.props.height\n      )) {\n      return <div/>;\n    }\n    const { id, type, x, y, width, height, editing, canChange, onChange, meta } = this.props;\n    const { isSelected, isSecondary, focused } = meta;\n    return (\n      <div\n        key={id}\n        className={style}\n        onClick={() => {\n          let el = document.getElementById(id);\n          if (el) {\n            el.focus();\n          }\n        }}\n        style={{\n          top: y,\n          left: x,\n          width: width,\n          height: height,\n        }}>\n        <div className={style.element('item').modifiers({\n          focused,\n          editing,\n          selected: isSelected,\n          [type.replace(/:/, '-')]: true,\n        }, true)}/>\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      // Variables\n      id,\n      type,\n      x,\n      y,\n      width,\n      height,\n\n      // Flags\n      isInitial,\n      isChanging,\n      canChange,\n      pointerEvents,\n      editing,\n\n      // Scales\n      pixelScale,\n      canvasScale,\n\n      // Event handlers\n      onChange, // no needed?\n      onEdit,\n      onUpdate,\n      onCommit,\n      onClick,\n\n      defaultX,\n      defaultY,\n\n      // Misc\n      meta,\n    } = this.props;\n\n    // We never render whole canvas.\n    if (type === 'WholeCanvasSelector') {\n      return null;\n    }\n\n    const posX = isChanging ? (x ? x : defaultX) : x;\n    const posY =  isChanging ? (y ? y : defaultY) : y;\n\n    // TECH DEBT.\n    if (type === 'madoc:boxdraw' && isChanging === false) {\n      return this.renderRegionBox();\n    }\n\n    return (\n      type &&\n      <Selector\n        id={id}\n        type={type}\n        drag={isChanging}\n        x={posX}\n        y={posY}\n        width={width}\n        height={height}\n        editing={editing} // false\n        onEdit={onEdit}\n        onUpdate={onUpdate}\n        onSave={onCommit}\n        canvasScale={canvasScale}\n        isSecondary={meta ? meta.isSecondary : false}\n      />\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/viewers/Region.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Region.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Region.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./Region.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/viewers/Region.scss\n// module id = 887\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".region {\\n  position: absolute;\\n  pointer-events: auto; }\\n  .region__item {\\n    height: 100%;\\n    width: 100%;\\n    outline: 8px solid #FFF;\\n    background-color: rgba(255, 255, 255, 0.3); }\\n    .region__item--selected {\\n      outline-width: 16px; }\\n    .region__item--focused {\\n      outline-color: indigo; }\\n    .region__item--editing {\\n      outline: 16px solid #4285F4; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/viewers/Region.scss\n// module id = 888\n// module chunks = 0","import React, { Component, PropTypes } from 'react';\nimport Form from '../inputs/Form';\nimport BEM from 'digirati-bem-js';\nimport isEqual from 'lodash.isequal';\nimport ComboButton from '../inputs/ComboButton';\n\nconst baseStyle = BEM.block('full-form');\n\nclass ConfirmationForm extends Component {\n\n  // propTypes = {\n  //   draft: PropTypes.shape({\n  //     id: PropTypes.string.isRequired,\n  //     isPreviewing: PropTypes.bool.isRequired,\n  //     input: PropTypes.object.isRequired,\n  //   }),\n  //   bem: PropTypes.object,\n  //   nextLabel: PropTypes.string,\n  //   editLabel: PropTypes.string,\n  //   saveLabel: PropTypes.string,\n  //   updateField: PropTypes.func.isRequired,\n  //   onEdit: PropTypes.func,\n  //   onSave: PropTypes.func,\n  //   previewDraft: PropTypes.func.isRequired,\n  // };\n\n  static ONLINE = 0;\n  static OFFLINE = 1;\n\n  state = {\n    onlineStatus: ConfirmationForm.ONLINE,\n  };\n\n  setOnline = () => {\n    this.setState({ onlineStatus: ConfirmationForm.ONLINE });\n  };\n\n  setOffline = () => {\n    this.setState({ onlineStatus: ConfirmationForm.OFFLINE });\n  };\n\n  componentDidMount() {\n    this.setState({ onlineStatus: navigator.onLine ? ConfirmationForm.ONLINE : ConfirmationForm.OFFLINE });\n    window.addEventListener('online', this.setOnline);\n    window.addEventListener('offline', this.setOffline);\n  }\n\n  renderPublishButton(draft) {\n    const {\n      onSave,\n      onSaveAsInProgress,\n      onSaveAsIncomplete,\n      enableLocalStorageSaving = false,\n      enablePublishing = true\n    } = this.props;\n    if (!onSave) return null;\n\n    if (this.state.onlineStatus === ConfirmationForm.OFFLINE) {\n      if (!onSaveAsInProgress || enablePublishing === false) {\n        return (\n          <ComboButton disabled>\n            Save\n          </ComboButton>\n        );\n      }\n      return (\n        <ComboButton onClick={() => onSaveAsInProgress(draft)}>\n          Save work as in progress\n        </ComboButton>\n      );\n    }\n\n    if (enablePublishing === false) {\n      return (\n        <ComboButton onClick={() => onSaveAsIncomplete(draft)}>\n          Save\n          { enableLocalStorageSaving && (\n            draft.fingerprint.source === 'localStorage' ? (\n              draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED' ||\n              draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_NEW'\n            ) : true\n          ) && onSaveAsInProgress ? (\n            <ComboButton.Option onClick={() => onSaveAsInProgress(draft)}>\n              Save on this computer\n            </ComboButton.Option>) : null}\n        </ComboButton>\n      );\n    }\n\n    return (\n      <ComboButton onClick={() => onSave(draft)}>\n        Publish\n        { enableLocalStorageSaving && (\n          draft.fingerprint.source === 'localStorage' ? (\n            draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED' ||\n            draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_NEW'\n          ) : true\n        ) && onSaveAsInProgress ? (\n          <ComboButton.Option onClick={() => onSaveAsInProgress(draft)}>\n            Save on this computer\n          </ComboButton.Option>) : null}\n        {(\n          draft.fingerprint.source === 'elucidate' ? (\n            draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_CHANGED' ||\n            draft.fingerprint.lifecycle === 'DRAFT_LIFECYCLE_NEW'\n          ) : true\n        ) && onSaveAsIncomplete ? (\n          <ComboButton.Option onClick={() => onSaveAsIncomplete(draft)}>\n            Save work as in progress\n          </ComboButton.Option>) : null}\n      </ComboButton>\n    );\n  }\n\n  render() {\n    const {\n      // Variables.\n      draft,\n      fields,\n      bem,\n      nextLabel,\n      editLabel,\n      saveLabel,\n      saveAsInProgressLabel,\n      children,\n      // Actions.\n      updateField,\n      onEdit,\n      onSave,\n      onSaveAsInProgress,\n      onSaveAsIncomplete,\n      previewDraft,\n      ...props,\n    } = this.props;\n\n    const style = bem ? bem : baseStyle;\n    const draftIsEmpty = draft ? (Object.values(draft.input).filter(e => e).length === 0) : true;\n    const nextButtonProps = {};\n    if (draftIsEmpty) {\n      nextButtonProps.disabled = 'disabled';\n    }\n\n    return (\n      <div className={style}>\n        {children ? children : (\n          <Form\n            draft={draft}\n            fields={fields}\n            updateField={(input, value) => updateField(draft.id, { [input.id]: value })}\n            {...props}\n          />\n        )}\n        <div className={style.element('actions')}>\n          {draft.isPreviewing ? (\n            <div>\n              {onEdit ? (\n                <button className={style.element('back-btn').modifiers({ first: true, last: !!onSave, })}\n                        onClick={() => onEdit(draft)}>\n                  {editLabel ? editLabel : 'Edit'}\n                </button>\n              ) : null}\n              {this.renderPublishButton(draft)}\n            </div>\n          ) : (\n            <button className={style.element('action-btn').modifiers({ first: true, last: true })}\n                    onClick={() => previewDraft(draft.id, draft)} {...nextButtonProps}>\n              {nextLabel ? nextLabel : 'Next'}\n            </button>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ConfirmationForm;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/composites/ConfirmationForm.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./ComboButton.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./ComboButton.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../../node_modules/sass-loader/lib/loader.js!./ComboButton.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-components/src/components/inputs/ComboButton.scss\n// module id = 890\n// module chunks = 0","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".combo-button {\\n  color: #fff;\\n  position: relative;\\n  float: right;\\n  width: 200px;\\n  font-size: 16px; }\\n  .combo-button * {\\n    box-sizing: border-box; }\\n  .combo-button--disabled {\\n    pointer-events: none;\\n    opacity: 0.5; }\\n  .combo-button__button {\\n    background: #ED1C2E;\\n    position: relative;\\n    height: 35px;\\n    display: block;\\n    width: 100%; }\\n  .combo-button__cta {\\n    padding: 0 10px;\\n    cursor: pointer;\\n    height: 35px;\\n    width: 100%;\\n    display: block;\\n    margin-right: 60px;\\n    line-height: 35px; }\\n    .combo-button__cta--single {\\n      text-align: center; }\\n    .combo-button__cta:hover {\\n      background: #af0e1c; }\\n  .combo-button__toggle {\\n    background: #ED1C2E;\\n    position: absolute;\\n    display: block;\\n    right: 0;\\n    top: 0;\\n    height: 35px;\\n    width: 35px;\\n    margin-left: 20px;\\n    border-left: 1px solid #af0e1c;\\n    font-size: 25px;\\n    line-height: 35px;\\n    text-align: center;\\n    cursor: pointer; }\\n    .combo-button__toggle--open, .combo-button__toggle:hover {\\n      background: #af0e1c; }\\n  .combo-button__list {\\n    margin: 0;\\n    padding: 0;\\n    background: #af0e1c;\\n    position: absolute;\\n    left: 0;\\n    right: 0;\\n    list-style: none; }\\n    .combo-button__list-item {\\n      height: 35px;\\n      line-height: 35px;\\n      font-size: 14px;\\n      padding: 0 10px;\\n      cursor: pointer;\\n      border-top: 1px solid #970c18; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-components/src/components/inputs/ComboButton.scss\n// module id = 891\n// module chunks = 0","import React, {Component} from 'react';\n\n\nclass Router extends Component {\n  // propTypes = {\n  //   routes: PropTypes.arrayOf(\n  //     PropTypes.shape({\n  //       matches: PropTypes.func.isRequired,\n  //       render: PropTypes.func.isRequired,\n  //     }).isRequired\n  //   ),\n  //   state: PropTypes.any,\n  //   renderNotFound: PropTypes.func,\n  // };\n\n  state = {\n    selected: null\n  };\n\n  // shouldComponentUpdate(_, newState) {\n  //   return newState.selected !== this.state.selected;\n  // }\n\n  render() {\n    const {routes, state, renderNotFound} = this.props;\n    for (let route of routes) {\n      if (route.matches(state)) {\n        return route.render();\n      }\n    }\n    return (\n      renderNotFound ? renderNotFound() : (\n        <div style={{color: 'darkred', fontWeight: 'bold'}}>\n          Route not found.\n        </div>\n      )\n    );\n\n  }\n}\n\nexport default Router;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/composites/Router.js","import React, {PureComponent} from 'react';\nimport BEM from 'digirati-bem-js';\nimport moment from 'moment';\n\n\nconst $style = BEM.block('action-time-ago');\nexport default class ActionTimeAgo extends PureComponent {\n\n  render() {\n    const {prefix, className, subject, verb, time, showComma = true} = this.props;\n\n    return (\n      <span className={className ? className : $style}>\n        { [prefix, verb, 'by', subject+(showComma ? ',' : null), moment(time).fromNow()].filter(e => e).join(' ') }\n      </span>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/components/ui/ActionTimeAgo.js","import React from 'react';\nimport { render } from 'react-dom';\nimport { utils } from 'digirati-annotation-plugin-core';\nimport ResourceEditorProvider from './resourceEditor.provider';\nimport { importResourceTemplate } from 'digirati-annotation-bridge';\nimport { getResourceById } from 'digirati-annotation-redux/es/query/resourceQuery';\nimport store from 'store';\n\nexport default function ResourceEditorPlugin($el, {\n  canvas,\n  manifest,\n  serializationStrategy,\n  resourceTemplates,\n  enablePublishing = 'true',\n  target = 'canvas',\n  ...unknownProps\n}, store) {\n  utils.unknownPropertyWarning(unknownProps);\n\n  if (resourceTemplates) {\n    const { dispatch } = store;\n\n    const enablePublishingBoolean = enablePublishing ? ( enablePublishing === 'true' ) : false;\n\n    const importCaptureModel = (resourceTemplates) => {\n      let resourceTemplate = getResourceById(store.getState(), resourceTemplates);\n      if (resourceTemplate) {\n        return resourceTemplate;\n      }\n\n      return fetch(`${resourceTemplates}`)\n      .then(r => r.json())\n      .then(resourceTemplate => {\n        dispatch(importResourceTemplate(resourceTemplate, target));\n        return resourceTemplate;\n      });\n    };\n\n    return importCaptureModel(resourceTemplates)\n    .then(resourceTemplate => {\n      render((\n        <ResourceEditorProvider\n          store={store}\n          target={target}\n          tree={resourceTemplate['@id']}\n          serializationStrategy={serializationStrategy}\n          manifest={manifest}\n          enablePublishing={enablePublishingBoolean}\n          importCaptureModel={importCaptureModel}\n          canvas={canvas}/>\n      ), $el);\n      return store;\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/resourceEditor.plugin.js","import { BOX_SELECTOR, WHOLE_CANVAS_SELECTOR } from './vocab';\nimport AnnotationBody from './annotationBody';\nimport { AnnotationSelector } from 'digirati-annotation-redux/es/lib/elucidate/index';\n\n/**\n * @deprecated\n */\nexport function parseTarget(target, scale = 1) {\n  return AnnotationSelector.parse(target, scale);\n}\n\nexport function mapTarget(target, scale = 1) {\n  const boxSelector = parseTarget(target, scale);\n  if (!boxSelector || typeof boxSelector.target === 'string') {\n    return { type: WHOLE_CANVAS_SELECTOR, target: (boxSelector && boxSelector.target) || '' };\n  }\n  boxSelector.type = BOX_SELECTOR;\n  return boxSelector;\n}\n\nexport function resourceTemplateReverseTypeLookup(fields, key) {\n  for (let template of Object.values(fields)) {\n    if (template.metaData.conformsTo.label === key) {\n      return template;\n    }\n  }\n  return null;\n}\n\nexport function mapAnnotationBody(resourceTemplate, bodyFields) {\n  const fields = Object.keys(bodyFields);\n  const fieldMap = {};\n\n  fields.forEach(field => {\n    const template = resourceTemplateReverseTypeLookup(resourceTemplate, field);\n    if (template) {\n      fieldMap[template.id] = bodyFields[field];\n    }\n  });\n\n  return fieldMap;\n}\n\nexport function createDraftListFromAnnotations(annotations, resourceTemplate, scale) {\n  return annotations.map(anno => createDraftFromAnnotation(resourceTemplate, anno, scale)).filter(e => e);\n}\n\nexport function immutableRegionsFromDraftList(drafts) {\n  return Object.keys(drafts)\n    .filter(k => drafts[k] && drafts[k].selector)\n    .map(k => drafts[k])\n    .filter(anno => anno && anno.selector)\n    .map(anno => {\n      const r = anno.selector.target;\n      return {\n        id: anno.id,\n        onClick: () => {\n        },\n        left: r.x, // should be r.left\n        top: r.y, // should be r.top\n        height: r.height,\n        width: r.width,\n        scale: r.scale,\n        selected: false,\n        editing: false,\n        immutable: true,\n      }\n    });\n}\n\nexport function immutableRegionsFromAnnotations(annotations, resourceTemplate, scale) {\n  return immutableRegionsFromDraftList(\n    createDraftListFromAnnotations(annotations, resourceTemplate, scale),\n  );\n}\n\nexport function editableRegionsFromDraftList(drafts,\n  currentDraftKey = null,\n  onClickRegion = () => null,\n  currentSelectorExists = true,) {\n  return Object.keys(drafts)\n    .filter(k => drafts[k] && drafts[k].selector)\n    .map(k => {\n      const r = drafts[k].selector;\n      return {\n        id: drafts[k].id,\n        onClick: () => onClickRegion(k),\n        selected: `${k}` === `${currentDraftKey}`,\n        editing: `${k}` === `${currentDraftKey}` && currentSelectorExists,\n        immutable: false,\n        ...r\n      }\n    });\n}\n\nexport function detectTypeOfAnnotation(annotation) {\n  if (!annotation || !annotation.body) {\n    return 'UNKNOWN';\n  }\n\n  if (annotation.body && annotation.body.type === 'SpecificResource') {\n    return 'SPECIFIC_RESOURCE';\n  }\n  if (annotation.body && annotation.body.value && typeof annotation.body.value === 'string') {\n    // @todo temporary type.\n    return 'ANNOTATION_STUDIO';\n  }\n  if (Object.prototype.toString.call(annotation.body) === '[object Array]') {\n    return 'ANNOTATION_ARRAY';\n  }\n  return 'UNKNOWN';\n}\n\nexport function getAnnotationBody(annotation) {\n  const type = detectTypeOfAnnotation(annotation);\n\n  switch (type) {\n    case 'ANNOTATION_STUDIO':\n      try {\n        return JSON.parse(annotation.body.value);\n      } catch (err) {\n        return annotation.body.value;\n      }\n    case 'SPECIFIC_RESOURCE':\n    default:\n      return AnnotationBody.fromBody(annotation.body);\n  }\n}\n\nexport function mapTargetToSelector(target) {\n  return { ...target.target, ...target };\n}\n\nexport function createDraftFromAnnotation(resourceTemplate, annotation, scale = 1) {\n  if (!(\n      resourceTemplate &&\n      resourceTemplate.fields\n    )) {\n    return null;\n  }\n  // Filter out empty bodied annotations.\n  const body = getAnnotationBody(annotation);\n  if (body === null) {\n    return null;\n  }\n\n  return {\n    id: annotation.id,\n    input: mapAnnotationBody(\n      resourceTemplate.fields,\n      getAnnotationBody(annotation),\n    ),\n    selector: mapTargetToSelector(mapTarget(annotation.target, scale)),\n    isPublishing: true,\n    isPreviewing: true,\n    published: true,\n    template: resourceTemplate.id,\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/annotations.js","import flatten from 'lodash.flatten';\n\nimport {\n  COMBINE,\n  DESCRIPTION,\n  EXTERNALISE,\n  HAS_PART,\n  HUMAN_READABLE,\n  ID,\n  LABEL_PARTS,\n  MOTIVATED_BY,\n  MULTIPLE,\n  SERIALIZE,\n  TITLE,\n  UI_CHOICE\n} from '../vocab';\nimport { castBool, get, labelId, motivationFromForm, warning } from '../helpers';\nimport { constructUnknownTemplate } from '../index';\n\nexport default class Choice {\n\n  type = 'choice';\n\n  static is(choice) {\n    const $ = get(choice);\n\n    if ($(UI_CHOICE) === undefined) {\n      warning('Choice', $(ID), `There is not a choice field on this Choice/Form. Working under the assumtion that it is a FORM and not a choice.`);\n    }\n\n    const firstChild = Array.isArray($(HAS_PART)) ? $(HAS_PART)[0] : $(HAS_PART);\n    const firstChildIsField = !!firstChild['crowds:uiInputType'];\n    if (castBool($(UI_CHOICE), false) === true && Array.isArray($(HAS_PART))) {\n\n    }\n\n    return $(UI_CHOICE) === 'True' && Array.isArray($(HAS_PART))\n  }\n\n  isValidTarget(target) {\n    return !!this.choice.reduce((s, choice) => {\n      if (choice.isValidTarget(target)) {\n        s.push(choice);\n      }\n      return s;\n    }, []).length;\n  }\n\n  getTree(target) {\n    return {\n      id: this.id,\n      type: this.type,\n      title: this.title,\n      description: this.description,\n      metaData: this.metaData,\n      choice: this.choice\n        .filter(choice => choice.isValidTarget(target))\n        .map(choice => choice.type === 'choice' ? choice.getTree(target) : {\n          id: choice.id,\n          title: choice.title,\n          description: choice.description,\n          type: choice.type,\n        })\n        .reduce((s, a) => {\n          s[a.id] = a;\n          return s;\n        }, {}),\n    }\n  }\n\n  flatten() {\n    const { choice, ...item } = this;\n    return flatten([item, ...choice.map(c => c.flatten())])\n  }\n\n  static fromJsonLD(jsonLd) {\n    const $ = get(jsonLd);\n    return new Choice(\n      $(ID),\n      $(TITLE),\n      $(DESCRIPTION),\n      {\n        combine: castBool($(COMBINE, true)),\n        externalise: castBool($(EXTERNALISE, true)),\n        humanReadable: castBool($(HUMAN_READABLE, true)),\n        serialize: castBool($(SERIALIZE)),\n        multiple: castBool($(MULTIPLE)),\n        motivatedBy: motivationFromForm(labelId($(MOTIVATED_BY))),\n        labelParts: labelId($(LABEL_PARTS)),\n      },\n      $(HAS_PART).map(\n        template => constructUnknownTemplate(template),\n      ),\n    );\n  }\n\n  static fromData({ id, title, description, metaData = {}, choices }) {\n    return new Choice(id, title, description, metaData, choices);\n  }\n\n  constructor(id, title, description, metaData = {}, choices) {\n    this.id = id;\n    this.title = title;\n    this.description = description;\n    this.metaData = metaData;\n    this.choice = choices;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/model/Choice.js","import { castBool, castId, get, labelId, motivationFromForm, warning } from '../helpers';\nimport {\n  TYPE,\n  COMBINE,\n  DESCRIPTION,\n  EXTERNALISE,\n  HAS_PART,\n  HUMAN_READABLE,\n  ID,\n  LABEL_PARTS,\n  MOTIVATED_BY,\n  MULTIPLE, OMEKA_LABEL,\n  SELECTOR,\n  SERIALIZE,\n  TITLE,\n  UI_GROUP,\n  UI_CHOICE,\n} from '../vocab';\nimport Field from './Field';\n\nexport default class CaptureModel {\n\n  type = 'captureModel';\n\n  static fromJsonLD(jsonLd) {\n    const asArray = (a) => Array.isArray(a) ? a : [a];\n    const $ = get(jsonLd);\n\n    if ($(HAS_PART) === undefined) {\n      warning('CaptureModel', $(ID), `No fields found in this form, expected in field ${HAS_PART}`);\n    }\n    if ($(TITLE) === undefined) {\n      warning('CaptureModel', $(ID), `No title found in this form, expected in field ${TITLE}`);\n    }\n\n    return new CaptureModel(\n      $('@context'),\n      $(ID),\n      $(TITLE),\n      $(DESCRIPTION),\n      {\n        combine: castBool($(COMBINE, true)),\n        externalise: castBool($(EXTERNALISE, true)),\n        humanReadable: castBool($(HUMAN_READABLE, true)),\n        serialize: castBool($(SERIALIZE)),\n        multiple: castBool($(MULTIPLE)),\n        // selectorValue: $(),\n        selector: $(SELECTOR) ? castId($(SELECTOR), '', $('@context')).toLowerCase() : null,\n        motivatedBy: motivationFromForm(\n          labelId($(MOTIVATED_BY)),\n        ),\n        labelParts: labelId($(LABEL_PARTS)),\n      },\n      asArray($(HAS_PART)).map(\n        field => Field.fromJsonLD(field, $('@context')),\n      )\n    );\n  }\n\n  isValidTarget(target) {\n    if (target === 'canvas') {\n      return true;\n    }\n    return (\n      (!this.metaData.selector ||\n      this.metaData.selector.toLowerCase() === 'wholecanvasselector') && (\n        this.fields.reduce((s, field) => {\n          if (field.isValidTarget(target)) {\n            return s;\n          }\n          return false;\n        }, true)\n      )\n    );\n  }\n\n  flatten() {\n    const { fields, ...item } = this;\n    return [item, ...this.dereferenceFields(fields)];\n  }\n\n  dereferenceFields(fields) {\n    return fields.map(field => field.getReference(this));\n  }\n\n  constructor(context, id, title, description, metaData, fields) {\n    this.context = context;\n    this.id = id;\n    this.title = title;\n    this.description = description;\n    this.metaData = metaData || {};\n    this.fields = fields;\n  }\n\n  static is(jsonLd) {\n    const $ = get(jsonLd);\n\n\n    if (castId($(UI_GROUP), false, $('@context')) === 'madoc:form') {\n      if (castBool($(UI_CHOICE), false)) {\n        const firstChild = Array.isArray($(HAS_PART)) ? $(HAS_PART)[0] : $(HAS_PART);\n        const firstChildIsField = !!firstChild['crowds:uiInputType'];\n        warning('CaptureModel', $(ID), `we found the following conflicts:\n  - This model is marked as a madoc:form\n  - First child ${firstChildIsField ? 'IS' : 'IS NOT'} detected as a form field\n  - The model is marked as a choice (crowds:uiChoice), which is incompatible with forms\n  \nWe've continued under the assumtion that this is a form. \nPlease update the model to get rid of this warning.\n`);\n\n      }\n      return true;\n    }\n\n    // @todo remove temporary fix.\n    console.warn('CaptureModel:', 'please use JSON-LD fields so that @id is equal to the QName.');\n    return $(UI_GROUP) ? $(UI_GROUP)[OMEKA_LABEL] === 'madoc:form' : false;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/model/CaptureModel.js","import { get, labelId, parseSelectorTarget } from '../helpers';\nimport {\n  BODY_TYPE,\n  CONFORMS_TO,\n  DESCRIPTION,\n  ID,\n  INPUT_OPTIONS,\n  INPUT_TYPE,\n  INPUT_DEFAULT_VALUE,\n  PURPOSE,\n  RDFS_LABEL,\n  SELECTOR,\n  SELECTOR_VALUE,\n  TITLE,\n  TYPE,\n  FIELD_GROUP,\n} from '../vocab';\n\nexport default class Field {\n\n  type = 'field';\n\n  getReference(parent) {\n    return { parentId: parent.id, ...this };\n  }\n\n  static getAutocompleteEndpoint(options) {\n    if (!options) {\n      return null;\n    }\n    return (\n      options[0] ?\n        options[0] :\n        (\n          options['@id'] ?\n            options['@id'] :\n            null\n        )\n    );\n  }\n\n  constructor(context, id, inputType, annotationMetaData, omekaMetaData, metaData) {\n    this.context = context;\n    this.id = id;\n    this.inputType = inputType;\n    this.annotationMetaData = annotationMetaData;\n    this.omekaMetaData = omekaMetaData;\n    this.metaData = metaData;\n  }\n\n  isValidTarget(target) {\n    if (target === 'canvas') {\n      return true;\n    }\n    return !(\n      this.metaData.selector &&\n      this.metaData.selector.toLowerCase() !== 'wholecanvasselector'\n    );\n  }\n\n  static fromJsonLD(jsonLd, inheritedContext) {\n    const $ = get(jsonLd, inheritedContext);\n    const context = $('@context', inheritedContext);\n\n    return new Field(\n      context,\n      $(ID),\n      $(INPUT_TYPE, { [ID]: null })[ID],\n      {\n        options: $(INPUT_OPTIONS),\n        autocomplete: Field.getAutocompleteEndpoint($(INPUT_OPTIONS)),\n      },\n      {\n        type: $(TYPE),\n        group: labelId(\n          $(FIELD_GROUP),\n        ),\n        bodyType: labelId(\n          $(BODY_TYPE),\n        ),\n        purpose: labelId(\n          $(PURPOSE),\n        ),\n      },\n      {\n        title: $(RDFS_LABEL) || $(TITLE),\n        description: $(DESCRIPTION),\n        conformsTo: labelId(\n          $(CONFORMS_TO),\n        ),\n        selector: $(SELECTOR) ? $(SELECTOR)[ID] : null,\n        selectorValue: parseSelectorTarget($(SELECTOR_VALUE)),\n        defaultValue: $(INPUT_DEFAULT_VALUE),\n      },\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-bridge/src/model/Field.js","import type Motivation from './Annotation';\nimport Annotation from './Annotation';\nimport AnnotationBodyList from './AnnotationBodyList';\nimport AnnotationSelector from './AnnotationSelector';\nimport AnnotationBody from './AnnotationBody';\nimport { getForm } from '../../query/resourceQuery';\n\n// Draft value is {id: 'http://..'}\nexport const FIELD_TYPES_THAT_ARE_ENTITIES = ['madoc:nullableCaptureModel', 'madoc:fallbackOptions'];\n// Draft value is {label: 'human readable'}\nexport const FIELD_TYPES_THAT_ARE_HUMAN_READABLE = ['madoc:nullableCaptureModel', 'madoc:fallbackOptions'];\n\nexport function createCombinedAnnotationBody(captureModel, draft): Array<AnnotationBody> {\n  return []; // @todo\n}\n\nexport function createInProgressAnnotation(label, target, json, generator, id = null) {\n  return new Annotation(\n    id,\n    label,\n    new AnnotationBodyList(\n      new AnnotationBody(\n        null,\n        JSON.stringify(json),\n        'text/json',\n        'TextualBody',\n        'editing',\n      )\n    ),\n    target,\n    'http://www.digirati.com/ns/crowds#drafting',\n    generator,\n  );\n}\n\n/**\n * @deprecated for reference only\n */\nexport function dataSetToSingleAnnotation(template, dataset) {\n  const { metaData: { title, description } } = template;\n\n  dataset.context = dataset.context ? dataset.context : {};\n  if (title) {\n    dataset.context.Title = 'http://dublincore.org/documents/dcmi-terms/#terms-title';\n    dataset.Title = title;\n  }\n  if (description) {\n    dataset.context.Description = 'http://dublincore.org/documents/dcmi-terms/#terms-description';\n    dataset.Description = description;\n  }\n\n  const body = {\n    type: ['TextualBody', 'Dataset'],\n    value: JSON.stringify(dataset),\n    format: 'text/plain',\n  };\n\n  return { body, label: title };\n}\n\n/**\n * @deprecated for reference only\n */\nexport function getIndividualW3CAnnotationBodies(captureModel, draft) {\n  const fields = Object.values(getForm(captureModel).fields);\n\n  const selectors = Object.keys(draft.selectors || {})\n  .map(key => ({ id: key, value: draft.selectors[key] }))\n  .map(selector => {\n    const capModel = fields.find(model => model.id === selector.id);\n    return dataSetToSingleAnnotation(\n      capModel,\n      mapDraftToDataSet(fields, { [selector.id]: draft.input[selector.id] }),\n    );\n  });\n  const keyedSelectors = {};\n  for (let selector of selectors) {\n    keyedSelectors[selector.id] = selector.annotation;\n  }\n\n  return keyedSelectors;\n}\n\nexport function mapFieldsToDataSet(fields, data) {\n  const contexts = {};\n  const body = {};\n\n  fields.filter(e => e).forEach(model => {\n    if (model.metaData.conformsTo && data[model.id]) {\n      if (model.metaData.conformsTo.label !== model.metaData.conformsTo.id) {\n        contexts[model.metaData.conformsTo.label] = model.metaData.conformsTo.id;\n      }\n      body[model.metaData.conformsTo.label] = data[model.id];\n    }\n  });\n\n  return {\n    '@context': contexts,\n    ...body\n  };\n}\n\nfunction getModelFields(ids, fields) {\n  if (Array.isArray(fields)) {\n    return ids.map(fieldId => fields.find(field => field.id === fieldId));\n  }\n  return ids.map(fieldId => fields[fieldId]);\n}\n\nexport function mapDraftToDataSet(captureModel, draft) {\n  const fieldIds = Object.keys(draft.input);\n  const fields = getModelFields(fieldIds, captureModel.fields);\n  return mapFieldsToDataSet(fields, draft.input);\n}\n\n\nexport function createExternalResourceAnnotationBody(captureModel, draft): Array<AnnotationBody> {\n\n  const fieldIds = Object.keys(draft.input);\n  const fields = getModelFields(fieldIds, captureModel.fields);\n  // const fields = fieldIds.map(fieldId => captureModel.fields.find(field => field.id === fieldId));\n  return fields.filter(e => e).reduce((state, field) => {\n    if (FIELD_TYPES_THAT_ARE_ENTITIES.indexOf(field.inputType) !== -1) {\n      const draftInput = draft.input[field.id];\n      if (!draftInput) {\n        return state;\n      }\n      if (draftInput.url) {\n        state.push(\n          new AnnotationBody(\n            null,\n            null,\n            'application/json',\n            'SpecificResource',\n            null,\n            draftInput.url,\n          ),\n        );\n      }\n    }\n    return state;\n  }, []);\n}\n\nexport function createHumanReadableAnnotationBody(captureModel, draft): Array<AnnotationBody> {\n  const fieldIds = Object.keys(draft.input);\n  const fields = getModelFields(fieldIds, captureModel.fields);\n  // const fields = fieldIds.map(fieldId => captureModel.fields.find(field => field.id === fieldId));\n\n  return fields.filter(e => e).reduce((state, field) => {\n\n    if (\n      field &&\n      field.omekaMetaData &&\n      field.omekaMetaData &&\n      field.omekaMetaData.bodyType.id &&\n      field.omekaMetaData.bodyType.id === 'oa:TextualBody' &&\n      field.inputType === 'madoc:textarea'\n    ) {\n      const body = new AnnotationBody(\n        null,\n        draft.input[field.id],\n        'text/plain',\n        'TextualBody'\n      );\n      body.purpose = field.omekaMetaData.purpose ? field.omekaMetaData.purpose.label : null;\n      state.push(body);\n\n    }\n\n    if (FIELD_TYPES_THAT_ARE_HUMAN_READABLE.indexOf(field.inputType) !== -1) {\n      const draftInput = draft.input[field.id];\n      if (!draftInput) {\n        return state;\n      }\n      if (draftInput.label) {\n        state.push(\n          new AnnotationBody(\n            null,\n            draftInput.label,\n            'text/plain',\n            'Text',\n          ),\n        );\n      }\n    }\n    return state;\n  }, []);\n}\n\nexport function createSerializedAnnotationBody(captureModel, draft): ?AnnotationBody {\n  const dataSet = mapDraftToDataSet(captureModel, draft);\n\n  if (dataSet) {\n    return new AnnotationBody(\n      null,\n      JSON.stringify(dataSet),\n      'text/plain',\n      'Dataset',\n    )\n  }\n  return null;\n}\n\nexport function createMultipleAnnotations(target, captureModel, draft): ?Annotation {\n  const fieldKeys = Object.keys(draft.input);\n\n  const fields = fieldKeys.map(key => draft.input[key] ? ({\n    id: key,\n    input: draft.input[key],\n    selector: draft.selectors[key]\n  }) : null).filter(e => e);\n\n  return fields.map(field => {\n    const captureModelField = captureModel.fields[field.id];\n    if (!(\n        captureModelField &&\n        (captureModelField.metaData || captureModelField.omekaMeta)\n      )) {\n      console.warn('createMultipleAnnotations', 'Looks like you have set derivedAnnoCombine to \"False\" without selectors on the fields, are you sure this is correct?', captureModelField);\n    }\n\n    const { metaData = {}, omekaMetaData } = captureModelField;\n    const  { title, description } = metaData;\n    const {purpose} = omekaMetaData;\n\n    const dataSet = mapFieldsToDataSet([captureModel.fields[field.id]], {\n      [field.id]: field.input\n    });\n\n    dataSet['@context'] = dataSet['@context'] ? dataSet['@context'] : {};\n    if (title) {\n      dataSet['@context'].Title = 'http://dublincore.org/documents/dcmi-terms/#terms-title';\n      dataSet.Title = title;\n    }\n    if (description && description !== title) {\n      dataSet['@context'].Description = 'http://dublincore.org/documents/dcmi-terms/#terms-description';\n      dataSet.Description = description;\n    }\n\n    return new Annotation(\n      null,\n      field.input,\n      new AnnotationBodyList(\n        new AnnotationBody(\n          null,\n          JSON.stringify(dataSet),\n          'text/plain',\n          'Dataset',\n          purpose ? purpose.id : null,\n        )\n      ),\n      AnnotationSelector.fromTarget(target, field.selector)\n    );\n  });\n}\n\nexport function getGenerator(captureModel) {\n  return captureModel.id;\n}\n\nexport function getLabelFromDraft(labelParts, captureModel, draft): string {\n  if (!(\n      labelParts &&\n      labelParts.label\n    )) {\n    return null;\n  }\n  const fieldIds = Object.keys(draft.input);\n  const fields = getModelFields(fieldIds, captureModel.fields);\n  const labelField = labelParts.label;\n\n  return fields.filter(e => e).reduce((label, model) => {\n    if (label) return label;\n    if (model.metaData.conformsTo && draft.input[model.id] && model.metaData.conformsTo.label === labelField) {\n      return draft.input[model.id];\n    }\n    return label;\n  }, '');\n}\n\nexport function getSuitableLabelFromBody(bodies) {\n  let label = 'unknown';\n  const found = bodies.find(body => {\n    if (\n      body.type.indexOf('Text') !== -1 &&\n      body.value\n    ) {\n      return true;\n    }\n  });\n  return (found && found.value) ? found.value : label;\n}\n\nexport function getMotivation(motivatedBy, captureModel, draft): Motivation {\n  if (motivatedBy.id) {\n    return {\n      id: motivatedBy.id,\n      label: motivatedBy.instance,\n    };\n  }\n  return {\n    id: 'oa:tagging',\n    label: 'Tagging',\n  };\n}\n\nexport function convertPercentToPixel(props, height, width) {\n  return {\n    ...props,\n    left: (props.x / 100) * width,\n    top: (props.y / 100) * height,\n    width: (props.width / 100) * width,\n    height: (props.height / 100) * height,\n    immutable: true,\n    scale: 1,\n    unit: 'pixel',\n  };\n}\n\nexport function createAnnotationFromCaptureModelAndDraft(target, captureModel, draft, customDraftSelector) {\n  const bodies = [];\n  let label = 'unknown';\n  const draftSelector = customDraftSelector || draft.selector;\n\n  let motivation = {\n    id: 'oa:tagging',\n    label: 'Tagging',\n  };\n\n  const {\n    combine = false,\n    externalise = true,\n    humanReadable = false,\n    serialize = true,\n    labelParts,\n    motivatedBy,\n  } = captureModel.metaData;\n\n  if (combine === false) {\n    return createMultipleAnnotations(target, captureModel, draft);\n  }\n\n  if (combine) {\n    createCombinedAnnotationBody(captureModel, draft).forEach(body => bodies.push(body));\n  }\n\n  if (externalise) {\n    createExternalResourceAnnotationBody(captureModel, draft).forEach(body => bodies.push(body));\n  }\n\n  if (humanReadable) {\n    createHumanReadableAnnotationBody(captureModel, draft).forEach(body => bodies.push(body));\n  }\n\n  if (serialize) {\n    const serializedBody = createSerializedAnnotationBody(captureModel, draft);\n    if (serializedBody) {\n      bodies.push(serializedBody);\n    }\n  }\n\n  if (labelParts) {\n    label = getLabelFromDraft(labelParts, captureModel, draft) || getSuitableLabelFromBody(bodies);\n  }\n\n  if (motivatedBy) {\n    motivation = getMotivation(motivatedBy, captureModel, draft);\n  }\n\n  const generator = getGenerator(captureModel);\n\n  return new Annotation(\n    null,\n    label,\n    AnnotationBodyList.fromJsonLD(bodies),\n    AnnotationSelector.fromTarget(target, draftSelector),\n    motivation,\n    generator\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-redux/src/lib/annotation/mapping.js","import React from 'react';\nimport { ConfirmationForm } from 'digirati-annotation-components';\nimport BEM from 'digirati-bem-js';\nimport './FullForm.scss';\n\nconst baseStyle = BEM.block('full-form');\n\nexport default function renderForm({\n  currentResourceTemplate,\n  resourceForm,\n  currentDraft,\n  previewDraft,\n  updateDraft,\n  editSelector,\n  onSave,\n  unpreviewDraft,\n  currentSelector,\n  isSelecting,\n  isSelectingSecondary,\n  renderResourceEditor,\n  importCaptureModel,\n  onSaveAsInProgress,\n  goBack,\n  editFieldSelector,\n  immutableSelector,\n  currentTree,\n  elementEvents,\n  hideTitle,\n  enablePublishing,\n  bem,\n  ...props\n}) {\n  const style = bem ? bem : baseStyle;\n  const isWholeCanvas = currentDraft && currentDraft.selector && currentDraft.selector.type && currentDraft.selector.type.toLowerCase() === 'wholecanvasselector';\n\n  return (\n    <div className={style}>\n      {!hideTitle ? (\n        <div>\n          <h3 className={style.element('title')}>{currentResourceTemplate.title}</h3>\n          {currentResourceTemplate.description ? (\n            <p className={style.element('description')}>{currentResourceTemplate.description}</p>\n          ) : null}\n        </div>\n      ) : null}\n      { !isWholeCanvas && !immutableSelector && currentDraft.isPreviewing === false && currentSelector && currentSelector.source && currentSelector.source.template === currentResourceTemplate.id ? (\n        <div className={style.element('selector-info')}>\n          Please select a region on the page\n        </div>\n      ): null}\n      { !isWholeCanvas && !immutableSelector && currentDraft.isPreviewing === false && currentDraft.selector && editSelector ? (\n        <div className={style.element('selector-info').modifier('confirmed')}>\n          You have selected a region, do  you want to <a onClick={editSelector}>change its position</a>\n        </div>\n      ): null }\n      {currentDraft.template === currentTree ? (\n        <div className={style.element('container')}>\n          {goBack ? (\n            <button onClick={e => { e.preventDefault(); goBack(); }} className={style.element('close-icon')}>\n              &times;\n            </button>\n          ) : null}\n          <ConfirmationForm\n            draft={currentDraft}\n            fields={Object.values(resourceForm.fields)}\n            isSelecting={isSelectingSecondary || isSelecting}\n            displayFieldSelector={editFieldSelector}\n            elementEvents={elementEvents}\n            onSaveAsInProgress={onSaveAsInProgress}\n            onEdit={draft => unpreviewDraft(draft.id)}\n            onSave={draft => onSave(draft)}\n            previewDraft={previewDraft}\n            importCaptureModel={importCaptureModel}\n            renderResourceEditor={renderResourceEditor}\n            updateField={updateDraft}\n            enablePublishing={enablePublishing}\n            {...props}\n          />\n        </div>\n      ) : (\n        <div>Form disabled, please complete other annotation</div>\n      )}\n    </div>\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/views/renderForm.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./FullForm.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./FullForm.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./FullForm.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-plugin-resource-editor/src/views/FullForm.scss\n// module id = 906\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".full-form {\\n  left: 0 !important;\\n  position: relative; }\\n  .full-form:after {\\n    display: table;\\n    content: '';\\n    clear: both; }\\n  .full-form__offline-message {\\n    color: #E36049;\\n    font-weight: bold;\\n    text-align: right; }\\n  .full-form__close-icon {\\n    position: absolute;\\n    top: 10px;\\n    right: 10px;\\n    font-size: 30px;\\n    line-height: 20px;\\n    background: transparent;\\n    border: none;\\n    color: #000;\\n    cursor: pointer;\\n    padding: 4px; }\\n  .full-form__action-btn:disabled {\\n    opacity: 0.6; }\\n    .full-form__action-btn:disabled:hover {\\n      background: #fff; }\\n  .full-form__back-btn {\\n    border: none;\\n    background: transparent; }\\n  .full-form__selector-info {\\n    color: rgba(255, 255, 255, 0.9);\\n    border: 1px solid #3f505d;\\n    background: #546A7B;\\n    padding: 5px;\\n    margin: 10px 3px;\\n    font-size: 12px;\\n    border-radius: 3px; }\\n    .full-form__selector-info a {\\n      cursor: pointer;\\n      font-weight: bold;\\n      color: #fff; }\\n    .full-form__selector-info--confirmed {\\n      background: #1FAC78;\\n      border-color: #17815a; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-plugin-resource-editor/src/views/FullForm.scss\n// module id = 907\n// module chunks = 0","import React, {Component} from 'react';\nimport store from 'store';\n\n\nexport function mutateLocalStorage(fn) {\n  const url = window.location.href;\n  const currentList = fn(store.get(`annotation-studio/${url}`) || {});\n  store.set(`annotation-studio/${url}`, currentList);\n  return currentList;\n}\n\n/**\n * @deprecated\n */\nexport function convertPercentToPixel(props, height, width) {\n  return {\n    ...props,\n    left: (props.x / 100) * width,\n    top: (props.y / 100) * height,\n    width: (props.width / 100) * width,\n    height: (props.height / 100) * height,\n    immutable: true,\n    scale: 1,\n    unit: 'pixel',\n  };\n}\n\nexport function immediate(loading, fn) {\n  return class extends Component {\n    componentDidMount() {\n      fn();\n    }\n\n    render() {\n      return <div>{loading}</div>\n    }\n  };\n}\n\n/**\n * @deprecated\n */\nexport function getTargetFromRegion(canvas, region, height, width) {\n  if (region.type === 'WholeCanvasSelector') {\n    return canvas;\n  }\n  if (region.unit === 'percent') {\n    return getTargetFromRegion(canvas, convertPercentToPixel(region, height, width), height, width);\n  }\n  if (\n    region.width === null || isNaN(region.width) ||\n    region.height === null || isNaN(region.height)\n  ) {\n    return `${canvas}#xywh=${Math.floor(region.left)},${Math.floor(region.top)},0,0`;\n  }\n\n  return `${canvas}#xywh=${Math.floor(region.left)},${Math.floor(region.top)},${Math.floor(region.width)},${Math.floor(region.height)}`;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/resourceEditor.utility.js","import React from 'react';\nimport BEM from 'digirati-bem-js';\nimport './button.scss';\n\nconst $confirmationPage = BEM.block('confirmation-page');\nconst $button = BEM.block('button');\n\nexport default function confirmationPage({onConfirm}) {\n  return (\n    <div className={$confirmationPage}>\n      <h3 className={$confirmationPage.element('title')}>Your annotation has been added to the photo.</h3>\n      <p className={$confirmationPage.element('copy')}>Do you want to add another?</p>\n      <button className={$button.modifier('confirmation')} onClick={onConfirm}>\n        Start again\n      </button>\n    </div>\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/views/confirmationPage.js","import React from 'react';\n\nexport { default as Viewer } from './components/viewers/Viewer';\nexport { default as Selector } from './components/selectors/Selector';\nexport { default as Form } from './components/inputs/Form';\nexport { default as Canvas } from './components/composites/Canvas';\nexport { default as ConfirmationForm } from './components/composites/ConfirmationForm';\nexport { default as Router } from './components/composites/Router';\nexport { default as ActionTimeAgo  } from './components/ui/ActionTimeAgo';\nexport { default as ComboButotn  } from './components/inputs/ComboButton';\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-components/src/index.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./button.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./button.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./button.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-plugin-resource-editor/src/views/button.scss\n// module id = 910\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".editor-button {\\n  width: 200px;\\n  padding: 12px;\\n  border: 3px solid #000;\\n  font-weight: bold;\\n  font-size: 14px;\\n  margin-bottom: 10px;\\n  background-color: #FFF;\\n  cursor: pointer; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-plugin-resource-editor/src/views/button.scss\n// module id = 911\n// module chunks = 0","import React from 'react';\nimport BEM from 'digirati-bem-js';\nimport './resourceNavigation.scss';\n\nconst $resourceNavigation = BEM.block('resource-navigation');\n\n/**\n * Loops through the available capture models and displays information about them.\n * Using the passed in createDraft the UI should attach a click handler.\n */\nexport default function resourceNavigation({currentResource, resourceTemplates, createDraft, moveForward, moveBack, showBackButton}) {\n\n  const handleItemClick = (item) => () => {\n    moveForward(item.id);\n    if (item.type === 'captureModel') {\n      createDraft(item);\n    }\n  };\n\n  return (\n    <div className={$resourceNavigation}>\n      <h2 className={$resourceNavigation.element('heading')}>{ currentResource.title ? currentResource.title: 'What do you want to tag' }</h2>\n      { currentResource.description ? (<p className={$resourceNavigation.element('description')}>{ currentResource.description }</p>) : null }\n      {\n        Object.values(resourceTemplates).map(item => (\n          <div key={item.id}\n               className={$resourceNavigation.element('metadata')}\n               onClick={handleItemClick(item)}>\n            <div className={$resourceNavigation.element('title')}>{item.title}</div>\n            <div className={$resourceNavigation.element('description')}>{item.description}</div>\n          </div>\n        ))\n      }\n      {showBackButton ? (\n        <div onClick={moveBack} className={$resourceNavigation.element('back')}>\n          back\n        </div>\n      ) : null}\n    </div>\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./resourceNavigation.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./resourceNavigation.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js?importLoaders=1!../../../../node_modules/sass-loader/lib/loader.js!./resourceNavigation.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.scss\n// module id = 913\n// module chunks = 0","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".resource-navigation__metadata {\\n  padding: 20px;\\n  cursor: pointer;\\n  border: 3px solid #000;\\n  margin-top: 20px; }\\n\\n.resource-navigation__title {\\n  font-weight: bold; }\\n\\n.resource-navigation__back {\\n  padding: 5px;\\n  width: 50%;\\n  cursor: pointer;\\n  border: 3px solid #000;\\n  margin-top: 20px; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-plugin-resource-editor/src/views/resourceNavigation.scss\n// module id = 914\n// module chunks = 0","import plugin from './transcriber.plugin';\nimport provider from './transcriber.provider';\nimport Component from './transcriber';\n\nexport {\n  Component,\n  provider,\n  plugin,\n};\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-transcriber/src/index.js","import React from 'react';\nimport {render} from 'react-dom';\nimport {utils} from 'digirati-annotation-plugin-core';\nimport TranscriberProvider from './transcriber.provider';\nimport {importResourceTemplate} from 'digirati-annotation-bridge';\n\nexport default function TranscriberPlugin($el, {\n  canvas,\n  manifest,\n  transcriptionVocab,\n  serializationStrategy,\n  resourceTemplates,\n  label,\n  target = 'canvas',\n  ...unknownProps\n}, store) {\n  const transcription = `${$el.innerText}`;\n  utils.unknownPropertyWarning(unknownProps);\n\n  if (resourceTemplates) {\n    const {dispatch} = store;\n\n    return fetch(`${resourceTemplates}`)\n    .then(r => r.json())\n    .then(resourceTemplate => {\n\n      dispatch(importResourceTemplate(resourceTemplate, target));\n\n      return resourceTemplate;\n    })\n    .then(resourceTemplate => {\n      render((\n        <TranscriberProvider\n          transcriptionLabel={label}\n          store={store}\n          target={target}\n          transcription={transcription}\n          transcriptionVocab={transcriptionVocab || 'dcterms:description'}\n          tree={resourceTemplate['@id']}\n          serializationStrategy={serializationStrategy}\n          manifest={manifest}\n          canvas={canvas}/>\n      ), $el);\n      return store;\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-transcriber/src/transcriber.plugin.js","import plugin from './drafts.plugin';\nimport provider from './drafts.provider';\nimport Component from './drafts';\n\nexport {\n  Component,\n  provider,\n  plugin,\n};\n\nexport default plugin;\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-drafts/src/index.js","import DraftsProvider from './drafts.provider';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { utils } from 'digirati-annotation-plugin-core';\n\nexport default function DraftsPlugin(root, attributes, store) {\n  const {\n    label,\n    filterBy,\n    emptyState,\n    hideIfEmpty,\n    thumbnailSize,\n    showThumbnail,\n    description,\n    ...unknownProps\n  } = attributes;\n  utils.unknownPropertyWarning(unknownProps);\n\n\n  return ReactDOM.render((\n    <DraftsProvider\n      label={label || \"Your annotations\"}\n      filterBy={filterBy}\n      emptyState={emptyState}\n      hideIfEmpty={hideIfEmpty}\n      description={description}\n      showThumbnail={showThumbnail === 'true'}\n      thumbnailSize={thumbnailSize ? parseInt(thumbnailSize, 10) : null}\n      store={store}\n    />\n  ), root);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-drafts/src/drafts.plugin.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?importLoaders=1!../../../node_modules/sass-loader/lib/loader.js!./drafts.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js?importLoaders=1!../../../node_modules/sass-loader/lib/loader.js!./drafts.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js?importLoaders=1!../../../node_modules/sass-loader/lib/loader.js!./drafts.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./packages/annotation-plugin-drafts/src/drafts.scss\n// module id = 919\n// module chunks = 0","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".drafts-list {\\n  background: #fff;\\n  margin: 20px 0; }\\n  .drafts-list:after {\\n    clear: both;\\n    display: table;\\n    content: ''; }\\n  .drafts-list * {\\n    box-sizing: border-box; }\\n  .drafts-list__empty-state {\\n    padding: 10px 0 20px 0;\\n    font-size: 12px;\\n    color: #888;\\n    border-bottom: 1px solid #ddd; }\\n  .drafts-list__description {\\n    font-size: 12px;\\n    color: #888; }\\n  .drafts-list__unsaved {\\n    float: right;\\n    color: darkred; }\\n  .drafts-list__thumbnail {\\n    text-align: center;\\n    margin-bottom: 10px; }\\n  .drafts-list__list {\\n    list-style: none;\\n    margin: 0;\\n    padding: 0; }\\n    .drafts-list__list--hasThumbnail .drafts-list__list-item {\\n      float: left;\\n      margin: 10px;\\n      margin-left: 0;\\n      padding: 15px; }\\n      .drafts-list__list--hasThumbnail .drafts-list__list-item--selected {\\n        outline: 2px solid #ED1C2E;\\n        border-color: #ED1C2E;\\n        background: #fef1f2; }\\n    .drafts-list__list--hasThumbnail .drafts-list__list-item ~ .drafts-list__list-item {\\n      border-top: 1px solid #ddd;\\n      margin: 10px; }\\n      .drafts-list__list--hasThumbnail .drafts-list__list-item ~ .drafts-list__list-item--selected {\\n        border-top: 1px solid #ED1C2E; }\\n    .drafts-list__list--thumbnail-150 .drafts-list__list-item {\\n      width: 190px; }\\n    .drafts-list__list--thumbnail-150 .drafts-list__thumbnail {\\n      height: 150px; }\\n    .drafts-list__list--thumbnail-150 img {\\n      max-height: 150px;\\n      margin: 0 auto; }\\n    .drafts-list__list-item {\\n      cursor: pointer;\\n      border: 1px solid #ddd;\\n      padding: 10px 20px; }\\n      .drafts-list__list-item ~ .drafts-list__list-item {\\n        border-top: none; }\\n      .drafts-list__list-item--selected {\\n        background: #EEE; }\\n\\n.offline-notice,\\n.online-notice {\\n  opacity: 0.9;\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  left: 0;\\n  padding: 20px 40px;\\n  color: #fff;\\n  z-index: 10000; }\\n  .offline-notice button,\\n  .online-notice button {\\n    background: rgba(0, 0, 0, 0.3);\\n    color: #fff;\\n    border: none;\\n    margin-left: 20px; }\\n\\n.offline-notice {\\n  background-color: darkred; }\\n\\n.online-notice {\\n  background-color: forestgreen; }\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?importLoaders=1!./node_modules/sass-loader/lib/loader.js!./packages/annotation-plugin-drafts/src/drafts.scss\n// module id = 920\n// module chunks = 0","import TaggingAnnotationsComponent from './tagging-annotations.component';\nimport TaggingAnnotationsPlugin from './tagging-annotations.plugin';\nimport TaggingAnnotationsProvider from './tagging-annotations.provider';\nimport TaggingComponent from './tagging';\nimport TaggingPlugin from './tagging.plugin';\nimport TaggingProvider from './tagging.provider';\n\nexport {\n    TaggingAnnotationsComponent,\n    TaggingAnnotationsPlugin,\n    TaggingAnnotationsProvider,\n    TaggingComponent,\n    TaggingPlugin,\n    TaggingProvider,\n}\n\nexport default {};\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/index.js","import React from 'react';\n\n/**\n * Generate a DOM for displaying an annotation as a tag block.\n *\n * @param annotation\n * @returns {XML}\n */\nexport function annotationToTag(annotation) {\n    let bodyDetails = tagDetails(annotation);\n\n    return (\n        <div key={bodyDetails.uri} className=\"c-tag\"><a href={bodyDetails.uri}>{bodyDetails.label}</a></div>\n    );\n}\n\n/**\n * Extract and return the tag details from an Annotation body using the `TextualBody` and `SpecificResource`\n * items.\n *\n * @param annotation\n */\nexport function tagDetails(annotation) {\n    return annotation.body.reduce((details, fragment) => {\n        switch (fragment.type) {\n            case 'TextualBody':\n            case 'Text':\n                details['label'] = fragment['value'];\n                break;\n            case 'SpecificResource':\n                details['uri'] = fragment['source'];\n                break;\n        }\n\n        return details;\n    }, {});\n}\n\n/**\n * Parse and return the entity class for a given source URI.\n *\n * @param uri\n */\nexport function tagClassForUri(uri: string): ?string {\n    if (!uri) {\n        return null;\n    }\n    const regex = /\\/topics\\/(?:virtual:)?([A-Za-z_+-].+)\\//;\n    const matches = regex.exec(uri);\n\n    if (!matches) {\n        return null;\n    }\n\n    if (matches.length > 1) {\n        return matches[1];\n    } else {\n        return null;\n    }\n}\n\n/**\n * Currying function that returns a predicate checking if the given Annotation is a tag associated with certain\n * {@code types} of entities.\n *\n * @param types A collection of entity types this tag must be related to.\n * @returns {function(*)}\n */\nexport function isTaggedAs(types) {\n    return (annotation) => {\n        let body = Array.isArray(annotation.body) ? annotation.body : [];\n\n        return body.some(fragment => {\n            if (!fragment || !fragment.type || fragment.type.toLowerCase() !== 'specificresource') {\n                return false;\n            }\n\n            let source = fragment.source || fragment.id;\n            let entityType = tagClassForUri(source);\n            if (!entityType) {\n                return [];\n            }\n            return types.some(type => type.toLowerCase() === entityType.toLowerCase());\n        });\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging.utils.js","import TaggingAnnotationsProvider from './tagging-annotations.provider';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { utils } from 'digirati-annotation-plugin-core';\n\nexport default function TaggingAnnotationsPlugin(root, attributes, store) {\n  const {\n    entityTypes,\n  } = attributes;\n\n  const types = entityTypes.split(',').map(type => type.substring(7).toLowerCase());\n\n  return utils.renderWhen(store, state => Object.keys(state.elucidate.annotations).length > 0, (\n    <TaggingAnnotationsProvider\n      store={store}\n      entityTypes={types}\n    />\n  ), root);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging-annotations.plugin.js","import TaggingProvider from './tagging.provider';\nimport React from 'react';\nimport { render } from 'react-dom';\n\nimport { importResourceTemplate } from 'digirati-annotation-bridge';\n\n\nexport default function TaggingPlugin($el, attributes, store) {\n  const {\n    canvas,\n    manifest,\n    resourceTemplates,\n    target = 'canvas',\n    entityTypes,\n  } = attributes;\n\n  const { dispatch } = store;\n\n  const importCaptureModel = (resourceTemplates) => {\n    return fetch(`${resourceTemplates}`)\n    .then(r => r.json())\n    .then(resourceTemplate => {\n      dispatch(importResourceTemplate(resourceTemplate, target));\n      return resourceTemplate;\n    });\n  };\n\n  if (resourceTemplates) {\n    return fetch(`${resourceTemplates}`)\n    .then(r => r.json())\n    .then(resourceTemplate => {\n      dispatch(importResourceTemplate(resourceTemplate, target));\n      return resourceTemplate;\n    })\n    .then(resourceTemplate => {\n      render((\n        <TaggingProvider\n          store={store}\n          target={target}\n          manifest={manifest}\n          canvas={canvas}\n          tree={resourceTemplate['@id']}\n          importCaptureModel={importCaptureModel}\n          content={$el.innerText}\n        />\n      ), $el);\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-plugin-tagging/src/tagging.plugin.js","import React from 'react';\nimport {connector} from 'digirati-annotation-redux';\nimport {currentImageService} from 'digirati-annotation-redux/es/query/manifestQuery';\nimport { getAnnotationBody } from 'digirati-annotation-bridge/es/annotations';\n\nfunction getImageFromTarget(state, annotation, target, size) {\n  const imageService = currentImageService(state);\n  if (imageService) {\n    const prefix = imageService.split('info.json')[0];\n    const src = `${prefix}${target.x},${target.y},${target.width},${target.height}/${size},/0/default.jpg`;\n    const body = getAnnotationBody(annotation);\n\n    return (\n      <div className=\"c-image c-image--sm-sq\" key={annotation.id}>\n        <div className=\"c-image__src\">\n          <img src={src}/>\n        </div>\n        <div className=\"c-image__info\">\n          <p>{body['foaf:name'] ? body['foaf:name'] : body.textualBody ? body.textualBody : <em>No content found</em>}</p>\n          <div className=\"c-image__actions\">\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction RegionAnnotations(props) {\n  return (<div className=\"c-dig-image-grid c-dig-image-grid--sm\">\n    { props.regionAnnotations ? props.regionAnnotations.map(annotation =>\n      getImageFromTarget(props.state, annotation, annotation.selector.target, 150)) :\n      'loading...' }\n  </div>);\n}\n\nexport default connector(RegionAnnotations);\n\n\n\n// WEBPACK FOOTER //\n// ./packages/annotation-application/src/js/region-annotations.js"],"sourceRoot":""}